import{r,j as e,c as E,R as S}from"./client-BJVKzfAi.js";import{H as k}from"./Header-BJKWma2V.js";import{F as C}from"./Footer-Bzf1rLKh.js";import{s as L}from"./supabase-BoCLEw6R.js";import{F as B}from"./file-text-Bqp_Hw0X.js";import{E as F}from"./external-link-CaRKhh-A.js";import{E as T}from"./ErrorBoundary-9_HbXv1y.js";/* empty css             */import"./config-QPKPRtag.js";import"./auth-QZ4BJadW.js";import"./constants-CPVJY5eo.js";import"./Toast-BQk6Nzgd.js";import"./proposalDataFetcher-CipdyWU2.js";import"./proposalStatuses-1Bj0NYR4.js";import"./createLucideIcon-CgZZH2OU.js";function _({policy:i}){return e.jsxs("div",{className:"policies-mobile-card",id:i.slug,children:[e.jsx("div",{className:"policies-mobile-card-icon",children:e.jsx(B,{size:28,strokeWidth:1.5})}),e.jsx("h2",{className:"policies-mobile-card-title",children:i.name}),i.pdfUrl&&e.jsxs("a",{href:i.pdfUrl,className:"policies-mobile-card-button",target:"_blank",rel:"noopener noreferrer",children:["Open Document",e.jsx(F,{size:14})]})]})}function P(i){return{id:i._id,name:i.Name,slug:i.Slug||U(i.Name),type:i.Type||"policy",pdfUrl:i["PDF Version"],visible_on_policies_page:i.Active,visible_on_logged_out:i["visible on logged out?"],createdDate:i["Created Date"],modifiedDate:i["Modified Date"],createdBy:i["Created By"]}}function U(i){return i.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")}function $(){const[i,h]=r.useState([]),[o,l]=r.useState(null),[f,d]=r.useState(!0),[m,u]=r.useState(null),[g,w]=r.useState(!1),[x,j]=r.useState(!1);r.useEffect(()=>{const s=()=>j(window.innerWidth<=900);return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),r.useEffect(()=>{async function s(){try{d(!0),console.log("ðŸ“¡ Fetching policies from Supabase...");const{data:t,error:n}=await L.schema("reference_table").from("zat_policiesdocuments").select("*").eq("Active",!0).order("Name",{ascending:!0});if(n)throw console.error("âŒ Supabase error:",n),n;console.log("âœ… Fetched policies:",t);const a=t.map(P);h(a);const c=window.location.hash.substring(1);if(c){const p=a.find(b=>b.slug===c);if(p){l(p);return}}!c&&a.length>0&&(l(a[0]),window.location.hash=a[0].slug)}catch(t){console.error("Error fetching policies:",t),u("Failed to load policies. Please refresh the page.")}finally{d(!1)}}s()},[]),r.useEffect(()=>{function s(){const t=window.location.hash.substring(1);if(t&&i.length>0){const n=i.find(a=>a.slug===t);n&&l(n)}}return window.addEventListener("hashchange",s),()=>window.removeEventListener("hashchange",s)},[i]),r.useEffect(()=>{function s(){w(window.pageYOffset>300)}return window.addEventListener("scroll",s,{passive:!0}),()=>window.removeEventListener("scroll",s)},[]),r.useEffect(()=>{o&&(document.title=`${o.name} | Split Lease`)},[o]);const v=s=>{l(s),window.location.hash=s.slug;const t=document.querySelector(".policies-content-header");if(t){const n=t.getBoundingClientRect();n.top>=0&&n.top<window.innerHeight||t.scrollIntoView({behavior:"smooth",block:"start"})}},N=()=>{window.scrollTo({top:0,behavior:"smooth"})};return f?e.jsx("div",{className:"policies-page-container",children:e.jsx("div",{className:"policies-content-wrapper",children:e.jsx("div",{className:"policies-loading",children:"Loading policies..."})})}):m?e.jsx("div",{className:"policies-page-container",children:e.jsx("div",{className:"policies-content-wrapper",children:e.jsx("div",{className:"policies-error",children:m})})}):e.jsxs(e.Fragment,{children:[e.jsx(k,{}),e.jsxs("div",{className:"policies-page-container",children:[x?e.jsxs("div",{className:"policies-mobile-wrapper",children:[e.jsx("h1",{className:"policies-mobile-page-title",children:"Policies & Documents"}),i.map(s=>e.jsx(_,{policy:s},s.id))]}):e.jsxs("div",{className:"policies-content-wrapper",children:[e.jsxs("aside",{className:"policies-sidebar",children:[e.jsx("h2",{className:"policies-sidebar-title",children:"Contents"}),e.jsx("nav",{className:"policies-sidebar-nav",children:i.map(s=>e.jsx("a",{href:`#${s.slug}`,className:`policies-nav-item ${(o==null?void 0:o.slug)===s.slug?"active":""}`,onClick:t=>{t.preventDefault(),v(s)},children:s.name},s.id))})]}),e.jsxs("section",{className:"policies-main-content",children:[e.jsxs("div",{className:"policies-content-header",children:[e.jsx("h1",{className:"policies-page-title",children:(o==null?void 0:o.name)||"Policy Document"}),(o==null?void 0:o.pdfUrl)&&e.jsx("a",{href:o.pdfUrl,className:"policies-download-link",download:`${o.slug}.pdf`,title:"Download PDF",children:e.jsx("i",{className:"fa fa-download"})})]}),e.jsx("div",{className:"policies-pdf-container",children:o!=null&&o.pdfUrl?e.jsx("iframe",{src:o.pdfUrl,width:"100%",height:"700px",frameBorder:"0",title:`${o.name} - Policy Document Viewer`}):e.jsx("div",{className:"policies-loading",children:"No policy selected"})})]})]}),e.jsxs("button",{className:`policies-back-to-top ${g?"visible":""}`,onClick:N,"aria-label":"Back to top",children:[e.jsx("i",{className:"fa fa-chevron-up"}),e.jsx("span",{children:"Back to Top"})]})]}),e.jsx(C,{})]})}E(document.getElementById("root")).render(e.jsx(S.StrictMode,{children:e.jsx(T,{children:e.jsx($,{})})}));
