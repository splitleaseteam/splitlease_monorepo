import{j as e,r as l,c as Ht,R as _t}from"./client-BJVKzfAi.js";import{H as ue}from"./Header-BJKWma2V.js";import{F as fe}from"./Footer-Bzf1rLKh.js";import{a as Ot,P as Gt,C as $t,c as Xt}from"./ProposalSuccessModal-buYBZjpQ.js";import{L as ye}from"./ListingScheduleSelector-B9O1H-bT.js";import{G as Yt,F as mt}from"./GoogleMap-ICEUXkNW.js";import{I as be}from"./InformationalText-C-nhvRBy.js";import{S as qt}from"./proposalDataFetcher-CipdyWU2.js";import{i as Kt}from"./dataLookups-zG18yzis.js";import{c as gt,v as xt,l as R,h as Ut}from"./auth-QZ4BJadW.js";import{f as Qt,g as Jt,a as Zt}from"./listingDataFetcher-DGGxiGnp.js";import{v as Vt,c as eo,a as to,g as oo,f as le,i as ro}from"./availabilityValidation-CSGrEd4b.js";import{C as n,D as so}from"./constants-CPVJY5eo.js";import{a as ft}from"./nightCalculations-BvAtd4RD.js";import{s as ve}from"./supabase-BoCLEw6R.js";import{f as io}from"./informationalTextsFetcher-BGizEeKX.js";import"./Toast-BQk6Nzgd.js";import{E as no}from"./ErrorBoundary-9_HbXv1y.js";/* empty css             */import"./config-QPKPRtag.js";import"./proposalStatuses-1Bj0NYR4.js";import"./createLucideIcon-CgZZH2OU.js";import"./x-CrJVeoCh.js";import"./calendar-CDI4qHEX.js";import"./clock-BT0kKcUb.js";import"./send-C4mziT0-.js";import"./dayUtils-C3_GW2W5.js";import"./chevron-right-DMpFmStq.js";import"./map-pin-Be7EkBk1.js";import"./square-BGeZC4Cm.js";import"./supabaseUtils-B40jh603.js";function lo(){return e.jsx("div",{className:"vsl-loading",children:e.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"60vh",padding:"2rem"},children:[e.jsx("div",{style:{width:"60px",height:"60px",border:`4px solid ${n.BG_LIGHT}`,borderTop:`4px solid ${n.PRIMARY}`,borderRadius:"50%",animation:"spin 1s linear infinite"}}),e.jsx("style",{children:`
          @keyframes spin {
            to { transform: rotate(360deg); }
          }
        `})]})})}function ut({error:p,onRetry:h=void 0}){const d=typeof p=="string"?p:p==null?void 0:p.message;return e.jsx("div",{className:"vsl-error",children:e.jsxs("div",{style:{textAlign:"center",padding:"4rem 2rem",maxWidth:"600px",margin:"0 auto"},children:[e.jsx("div",{style:{fontSize:"4rem",marginBottom:"1rem"},children:"âš ï¸"}),e.jsx("h2",{style:{fontSize:"2rem",fontWeight:"700",marginBottom:"1rem",color:n.TEXT_DARK},children:"Property Not Found"}),e.jsx("p",{style:{fontSize:"1.125rem",color:n.TEXT_LIGHT,marginBottom:"2rem"},children:d||"The property you are looking for does not exist or has been removed."}),e.jsxs("div",{style:{display:"flex",gap:"1rem",justifyContent:"center"},children:[h&&e.jsx("button",{onClick:h,style:{display:"inline-block",padding:"1rem 2rem",background:n.PRIMARY,color:"white",border:"none",borderRadius:"8px",fontWeight:"600",cursor:"pointer",transition:"background 0.2s"},children:"Retry"}),e.jsx("a",{href:"/search.html",style:{display:"inline-block",padding:"1rem 2rem",background:h?n.BG_LIGHT:n.PRIMARY,color:h?n.TEXT_DARK:"white",textDecoration:"none",borderRadius:"8px",fontWeight:"600",transition:"background 0.2s"},children:"Browse All Listings"})]})]})})}function ao({photos:p,listingName:h,onPhotoClick:d,isMobile:b}){const o=p.length;if(b)return e.jsxs("div",{className:"vsl-gallery",style:{position:"relative"},children:[e.jsx("div",{onClick:()=>d(0),style:{cursor:"pointer",borderRadius:"12px",overflow:"hidden",height:"280px"},children:e.jsx("img",{src:p[0].Photo,alt:`${h} - main`,className:"vsl-gallery-image"})}),o>1&&e.jsxs("button",{onClick:()=>d(0),className:"vsl-gallery-show-all",children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("rect",{x:"3",y:"3",width:"7",height:"7",rx:"1"}),e.jsx("rect",{x:"14",y:"3",width:"7",height:"7",rx:"1"}),e.jsx("rect",{x:"3",y:"14",width:"7",height:"7",rx:"1"}),e.jsx("rect",{x:"14",y:"14",width:"7",height:"7",rx:"1"})]}),"Show all ",o]})]});const M=()=>o===1?{display:"grid",gridTemplateColumns:"1fr",gridTemplateRows:"400px",gap:"10px"}:o===2?{display:"grid",gridTemplateColumns:"1fr 1fr",gridTemplateRows:"400px",gap:"10px"}:o===3?{display:"grid",gridTemplateColumns:"2fr 1fr",gridTemplateRows:"200px 200px",gap:"10px"}:o===4?{display:"grid",gridTemplateColumns:"2fr 1fr",gridTemplateRows:"133px 133px 133px",gap:"10px"}:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr",gridTemplateRows:"200px 200px",gap:"10px"},w={cursor:"pointer",borderRadius:"12px",overflow:"hidden",position:"relative"},P={width:"100%",height:"100%",objectFit:"cover",display:"block"};if(o===1)return e.jsx("div",{className:"vsl-gallery",style:M(),children:e.jsx("div",{onClick:()=>d(0),style:w,children:e.jsx("img",{src:p[0].Photo,alt:`${h} - main`,style:P})})});if(o===2)return e.jsx("div",{className:"vsl-gallery",style:M(),children:p.map((j,g)=>e.jsx("div",{onClick:()=>d(g),style:w,children:e.jsx("img",{src:j.Photo,alt:`${h} - ${g+1}`,style:P})},j._id||g))});if(o===3)return e.jsxs("div",{className:"vsl-gallery",style:M(),children:[e.jsx("div",{onClick:()=>d(0),style:{...w,gridRow:"1 / 3"},children:e.jsx("img",{src:p[0].Photo,alt:`${h} - main`,style:P})}),p.slice(1,3).map((j,g)=>e.jsx("div",{onClick:()=>d(g+1),style:w,children:e.jsx("img",{src:j["Photo (thumbnail)"]||j.Photo,alt:`${h} - ${g+2}`,style:P})},j._id||g))]});if(o===4)return e.jsxs("div",{className:"vsl-gallery",style:M(),children:[e.jsx("div",{onClick:()=>d(0),style:{...w,gridRow:"1 / 4"},children:e.jsx("img",{src:p[0].Photo,alt:`${h} - main`,style:P})}),p.slice(1,4).map((j,g)=>e.jsx("div",{onClick:()=>d(g+1),style:w,children:e.jsx("img",{src:j["Photo (thumbnail)"]||j.Photo,alt:`${h} - ${g+2}`,style:P})},j._id||g))]});const f=p.slice(1,5);return e.jsxs("div",{className:"vsl-gallery",style:M(),children:[e.jsx("div",{onClick:()=>d(0),style:{...w,gridRow:"1 / 3"},children:e.jsx("img",{src:p[0].Photo,alt:`${h} - main`,style:P})}),f.map((j,g)=>e.jsxs("div",{onClick:()=>d(g+1),style:w,children:[e.jsx("img",{src:j["Photo (thumbnail)"]||j.Photo,alt:`${h} - ${g+2}`,style:P}),g===3&&o>5&&e.jsxs("button",{onClick:A=>{A.stopPropagation(),d(0)},className:"vsl-gallery-show-all",children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),e.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),e.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),e.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),e.jsx("span",{children:"Show All Photos"})]})]},j._id||g))]})}function co(p,h){const d=(h||"Every week").toLowerCase().trim();if(d==="every week"||d==="")return{actualWeeks:p,cycleDescription:null,showHighlight:!1};if(d.includes("1 on 1 off")||d.includes("1on1off")||d.includes("one week on")&&d.includes("one week off")){const b=p/2;return{actualWeeks:Math.floor(b),cycleDescription:"1 week on, 1 week off",showHighlight:!0,weeksOn:1,weeksOff:1}}if(d.includes("2 on 2 off")||d.includes("2on2off")||d.includes("two weeks on")&&d.includes("two weeks off")){const b=p/4;return{actualWeeks:Math.floor(b*2),cycleDescription:"2 weeks on, 2 weeks off",showHighlight:!0,weeksOn:2,weeksOff:2}}if(d.includes("1 on 3 off")||d.includes("1on3off")||d.includes("one week on")&&d.includes("three weeks off")){const b=p/4;return{actualWeeks:Math.floor(b),cycleDescription:"1 week on, 3 weeks off",showHighlight:!0,weeksOn:1,weeksOff:3}}return{actualWeeks:p,cycleDescription:null,showHighlight:!1}}function ho({pattern:p,reservationSpan:h,weeksOffered:d}){const b=p||co(h,d||"");return b.showHighlight?e.jsxs("div",{className:"schedule-highlight",children:[e.jsxs("div",{className:"schedule-highlight-header",children:[e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#7C3AED",strokeWidth:"2",children:e.jsx("path",{d:"M8 2v4M16 2v4M3 10h18M5 4h14a2 2 0 012 2v14a2 2 0 01-2 2H5a2 2 0 01-2-2V6a2 2 0 012-2z"})}),e.jsx("span",{className:"schedule-highlight-title",children:b.cycleDescription})]}),e.jsxs("div",{className:"schedule-highlight-content",children:[e.jsxs("span",{className:"schedule-highlight-actual",children:[b.actualWeeks," actual weeks"]}),e.jsxs("span",{className:"schedule-highlight-span",children:[" of stay within ",h,"-week span"]})]})]}):null}typeof window<"u"&&(window.__VSL_v9=Date.now(),console.log("ðŸ”„ðŸ”„ðŸ”„ ViewSplitLeasePage v9 LOADED - NUCLEAR CACHE BUST - "+window.__VSL_v9),console.log("ðŸ”„ðŸ”„ðŸ”„ DEBUG: Module successfully re-evaluated at:",new Date().toISOString()));function po(){const h=new URLSearchParams(window.location.search).get("days-selected");if(!h)return[];try{const b=h.split(",").map(o=>parseInt(o.trim(),10)).filter(o=>o>=0&&o<=6);if(b.length>0){const o=b.map(M=>ft(M,!0));return R.debug("ViewSplitLeasePage: Loaded schedule from URL:",{urlParam:h,dayIndices:b}),o}}catch(d){console.warn("âš ï¸ ViewSplitLeasePage: Failed to parse days-selected URL parameter:",d)}return[]}function mo(){const h=new URLSearchParams(window.location.search).get("reservation-span");if(!h)return null;const d=parseInt(h,10);return!isNaN(d)&&d>0?d:null}function go(){const h=new URLSearchParams(window.location.search).get("move-in");return h&&/^\d{4}-\d{2}-\d{2}$/.test(h)?h:null}function xo(){var Qe,Je,Ze,Ve,et,tt,ot,rt,st,it,nt,lt,at,dt,ct,ht;const[p,h]=l.useState(!0),[d,b]=l.useState(null),[o,M]=l.useState(null),[w,P]=l.useState(null),[f,j]=l.useState({}),[g,A]=l.useState(()=>go()),[Q,je]=l.useState(!1),[L,Se]=l.useState(()=>po()),[D,we]=l.useState(()=>mo()||13),[Te,J]=l.useState(!1),[ke,yt]=l.useState(null),[Re,H]=l.useState(!1),[Ie,Z]=l.useState(null),[a,Ce]=l.useState(null),[bt,Ee]=l.useState(!1),[vt,Pe]=l.useState(null),[Me,Le]=l.useState(!1),[v,_]=l.useState(null),[ae,We]=l.useState(""),[O,ze]=l.useState(!1),[q,De]=l.useState({show:!1,message:"",type:"success"}),[Ae,G]=l.useState(!1),jt=(t,i="success")=>{De({show:!0,message:t,type:i}),setTimeout(()=>{De({show:!1,message:"",type:"success"})},4e3)},N=l.useMemo(()=>{const t=new Date,i=new Date(t);return i.setDate(t.getDate()+14),i.toISOString().split("T")[0]},[]),K=L.map(t=>t.dayOfWeek),de=l.useCallback(t=>{if(!t||t.length===0)return N;const m=[...t].sort((x,F)=>x-F)[0],y=new Date(N),T=y.getDay(),C=(m-T+7)%7;if(C===0)return N;const z=new Date(y);return z.setDate(y.getDate()+C),z.toISOString().split("T")[0]},[N]);l.useEffect(()=>{if(L.length>0)if(g){const t=new Date(g),i=new Date(N);if(t<i){const m=L.map(T=>T.dayOfWeek),y=de(m);A(y)}}else{const t=L.map(m=>m.dayOfWeek),i=de(t);A(i)}},[]);const[St,V]=l.useState(!1),[Ne,ee]=l.useState(!1),[ce,he]=l.useState(0),[Be,pe]=l.useState(!1),[$,wt]=l.useState({description:!1,neighborhood:!1,blockedDates:!1}),[I,W]=l.useState(null),Fe=l.useRef(null),He=l.useRef(null),_e=l.useRef(null),[r,Oe]=l.useState(!1),[te,Ge]=l.useState(!1),[B,me]=l.useState(!1),X=l.useRef(null),oe=l.useRef(null),Tt=l.useRef(null),kt=l.useRef(null),Rt=l.useRef(null),$e=l.useRef(!1);l.useEffect(()=>{console.log("ðŸ”¥ðŸ”¥ðŸ”¥ ViewSplitLeasePage v9 COMPONENT RENDERING - useEffect running"),console.log("ðŸ”¥ isMobile state:",r),console.log("ðŸ”¥ listing state:",o);async function t(){try{if(await Kt(),await gt()){const F=await xt();F&&(Ce(F),R.debug("ViewSplitLeasePage: User data loaded:",F.firstName))}const T=await Qt();P(T);const C=await io();j(C);const z=Jt();if(!z)throw new Error("No listing ID provided in URL");const x=await Zt(z);R.debug("ViewSplitLeasePage: Listing data fetched:",{id:x._id,name:x.Name}),M(x),h(!1)}catch(y){console.error("Error initializing page:",y),b(y.message),h(!1)}}t();const i=window.matchMedia("(max-width: 900px)");Oe(i.matches);const m=y=>Oe(y.matches);return i.addEventListener("change",m),()=>i.removeEventListener("change",m)},[]),l.useEffect(()=>{if(!oe.current)return;const t=new IntersectionObserver(i=>{i.forEach(m=>{(m.isIntersecting||m.intersectionRatio>0)&&(Ge(!0),t.disconnect())})},{rootMargin:"200px",threshold:0});return t.observe(oe.current),()=>t.disconnect()},[o]),l.useEffect(()=>{te&&X.current&&o&&!$e.current&&setTimeout(()=>{X.current&&o&&(X.current.zoomToListing(o._id),$e.current=!0)},600)},[te,o]),l.useEffect(()=>{o!=null&&o.Name&&(document.title=`${o.Name} | Split Lease`)},[o]),l.useEffect(()=>{async function t(){if(!(a!=null&&a.userId)||!(o!=null&&o._id)){_(null);return}try{R.debug("ViewSplitLeasePage: Checking for existing proposals for listing:",o._id);const{data:i,error:m}=await ve.from("proposal").select('_id, "Status", "Created Date"').eq('"Guest"',a.userId).eq('"Listing"',o._id).neq('"Status"',"Proposal Cancelled by Guest").or('"Deleted".is.null,"Deleted".eq.false').order('"Created Date"',{ascending:!1}).limit(1);if(m){console.error("Error checking for existing proposals:",m),_(null);return}i&&i.length>0?(R.debug("ViewSplitLeasePage: User already has a proposal for this listing:",i[0]),_(i[0])):(R.debug("ViewSplitLeasePage: No existing proposal found for this listing"),_(null))}catch(i){console.error("Error checking for existing proposals:",i),_(null)}}t()},[a==null?void 0:a.userId,o==null?void 0:o._id]),l.useEffect(()=>{async function t(){if(!(a!=null&&a.userId)||!(o!=null&&o._id)){G(!1);return}try{const{data:i,error:m}=await ve.from("user").select('"Favorited Listings"').eq("_id",a.userId).single();if(m){R.debug("ViewSplitLeasePage: Error fetching user favorites:",m),G(!1);return}const T=((i==null?void 0:i["Favorited Listings"])||[]).includes(o._id);R.debug("ViewSplitLeasePage: Listing favorited status:",T),G(T)}catch{G(!1)}}t()},[a==null?void 0:a.userId,o==null?void 0:o._id]);const It=t=>{if(!t||!Array.isArray(t))return[0,1,2,3,4,5,6];const i={Sunday:0,Monday:1,Tuesday:2,Wednesday:3,Thursday:4,Friday:5,Saturday:6},m=t.map(y=>i[y]).filter(y=>y!==void 0);return m.length>0?m:[0,1,2,3,4,5,6]},Y=l.useMemo(()=>o?{id:o._id,firstAvailable:new Date(o[" First Available"]),lastAvailable:new Date(o["Last Available"]),numberOfNightsAvailable:o["# of nights available"]||7,active:o.Active,approved:o.Approved,datesBlocked:o["Dates - Blocked"]||[],complete:o.Complete,confirmedAvailability:o.confirmedAvailability,checkInTime:o["NEW Date Check-in Time"]||"3:00 pm",checkOutTime:o["NEW Date Check-out Time"]||"11:00 am",nightsAvailableList:[],nightsAvailableNumbers:o["Nights Available (numbers)"]||[0,1,2,3,4,5,6],nightsNotAvailable:[],minimumNights:o["Minimum Nights"]||2,maximumNights:o["Maximum Nights"]||7,daysAvailable:It(o["Days Available (List of Days)"]),daysNotAvailable:[],"rental type":o["rental type"]||"Nightly","Weeks offered":o["Weeks offered"]||"Every week","ðŸ’°Unit Markup":o["ðŸ’°Unit Markup"]||0,"ðŸ’°Nightly Host Rate for 2 nights":o["ðŸ’°Nightly Host Rate for 2 nights"],"ðŸ’°Nightly Host Rate for 3 nights":o["ðŸ’°Nightly Host Rate for 3 nights"],"ðŸ’°Nightly Host Rate for 4 nights":o["ðŸ’°Nightly Host Rate for 4 nights"],"ðŸ’°Nightly Host Rate for 5 nights":o["ðŸ’°Nightly Host Rate for 5 nights"],"ðŸ’°Nightly Host Rate for 7 nights":o["ðŸ’°Nightly Host Rate for 7 nights"],"ðŸ’°Weekly Host Rate":o["ðŸ’°Weekly Host Rate"],"ðŸ’°Monthly Host Rate":o["ðŸ’°Monthly Host Rate"],"ðŸ’°Price Override":o["ðŸ’°Price Override"],"ðŸ’°Cleaning Cost / Maintenance Fee":o["ðŸ’°Cleaning Cost / Maintenance Fee"],"ðŸ’°Damage Deposit":o["ðŸ’°Damage Deposit"]}:null,[o]);l.useEffect(()=>{if(L.length===0){const t=so.DEFAULT_SELECTED_DAYS.map(i=>ft(i,!0));Se(t)}},[]);const c=o?Vt(K,o):null,Ct=eo(K),{checkInName:uo,checkOutName:fo}=to(K),s=ke,Xe=!(c!=null&&c.valid)||!(s!=null&&s.valid)?oo(K.length):null,Ye=l.useMemo(()=>{var t;return!o||!o.coordinates?[]:[{id:o._id,title:o.Name,coordinates:o.coordinates,price:{starting:o["Standarized Minimum Nightly Price (Filter)"]||0},location:o.resolvedBorough,type:o.resolvedTypeOfSpace,bedrooms:o["Features - Qty Bedrooms"]||0,bathrooms:o["Features - Qty Bathrooms"]||0,images:((t=o.photos)==null?void 0:t.map(i=>i.Photo))||[],borough:o.resolvedBorough}]},[o]),ge=t=>{Se(t);const i=t.map(m=>m.dayOfWeek);if(i.length>0&&!ro(i)&&V(!0),i.length>0){const m=de(i);A(m)}},xe=l.useCallback(t=>{console.log("=== PRICE CHANGE CALLBACK ==="),console.log("Received price breakdown:",t),yt(i=>!i||i.fourWeekRent!==t.fourWeekRent||i.reservationTotal!==t.reservationTotal||i.nightlyRate!==t.nightlyRate?t:i)},[]),Et=t=>{he(t),ee(!0)},qe=t=>{wt(i=>({...i,[t]:!i[t]}))},Ke=()=>{if(!(c!=null&&c.valid)){alert("Please select a valid contiguous schedule");return}if(!g){alert("Please select a move-in date");return}J(!0)},Ue=async t=>{var i,m,y,T;if(!Me){Le(!0);try{const C=(a==null?void 0:a.userId)||Ut();if(!C)throw new Error("User ID not found. Please log in again.");R.debug("Submitting proposal to Edge Function",{guestId:C,listingId:t.listingId});const z=((i=t.daysSelectedObjects)==null?void 0:i.map(S=>S.dayOfWeek))||K,x=[...z].sort((S,u)=>S-u),F=x.includes(6),zt=x.includes(0),Dt=F&&zt&&z.length<7;let re,se,ie;if(Dt){let S=-1;for(let u=0;u<x.length-1;u++)if(x[u+1]-x[u]>1){S=u+1;break}S!==-1?(re=x[S],se=x[S-1],ie=[...x.slice(S),...x.slice(0,S)].slice(0,-1)):(re=x[0],se=x[x.length-1],ie=x.slice(0,-1))}else re=x[0],se=x[x.length-1],ie=x.slice(0,-1);const At=re,Nt=se,Bt=ie,ne=t.reservationSpan||D,Ft=ne===13?"13 weeks (3 months)":ne===20?"20 weeks (approx. 5 months)":`${ne} weeks`,U={guestId:C,listingId:t.listingId,moveInStartRange:t.moveInDate,moveInEndRange:t.moveInDate,daysSelected:z,nightsSelected:Bt,reservationSpan:Ft,reservationSpanWeeks:ne,checkIn:At,checkOut:Nt,proposalPrice:t.pricePerNight,fourWeekRent:t.pricePerFourWeeks,hostCompensation:t.pricePerFourWeeks,needForSpace:t.needForSpace||"",aboutMe:t.aboutYourself||"",estimatedBookingTotal:t.totalPrice,specialNeeds:t.hasUniqueRequirements?t.uniqueRequirements:"",moveInRangeText:t.moveInRange||"",flexibleMoveIn:!!t.moveInRange,fourWeekCompensation:t.pricePerFourWeeks,customScheduleDescription:ae||""};R.debug("Edge Function payload:",{guestId:U.guestId,listingId:U.listingId,daysSelected:U.daysSelected,nightsSelected:U.nightsSelected});const{data:E,error:k}=await ve.functions.invoke("proposal",{body:{action:"create",payload:U}});if(k){console.error("âŒ Edge Function error:",k),console.error("âŒ Error properties:",Object.keys(k)),console.error("âŒ Error context:",k.context);let S=k.message||"Failed to submit proposal";try{if(k.context&&typeof k.context.json=="function"){const u=await k.context.json();console.error("âŒ Edge Function error body (from json()):",u),u!=null&&u.error&&(S=u.error)}else if((m=k.context)!=null&&m.body){const u=typeof k.context.body=="string"?JSON.parse(k.context.body):k.context.body;console.error("âŒ Edge Function error body (from body):",u),u!=null&&u.error&&(S=u.error)}}catch(u){console.error("âŒ Could not parse error body:",u)}throw new Error(S)}if(!(E!=null&&E.success))throw console.error("âŒ Proposal submission failed:",E==null?void 0:E.error),new Error((E==null?void 0:E.error)||"Failed to submit proposal");R.debug("Proposal submitted successfully",{proposalId:(y=E.data)==null?void 0:y.proposalId}),Xt(t.listingId),J(!1),Z(null);const pt=(T=E.data)==null?void 0:T.proposalId;Pe(pt),Ee(!0),_({_id:pt,Status:"Pending Host Review","Created Date":new Date().toISOString()})}catch(C){console.error("âŒ Error submitting proposal:",C),jt(C.message||"Failed to submit proposal. Please try again.","error")}finally{Le(!1)}}},Pt=async t=>{if(!await gt()){Z(t),J(!1),H(!0);return}await Ue(t)},Mt=async t=>{H(!1);try{const i=await xt();i&&(Ce(i),R.debug("User data updated after auth:",i.firstName))}catch(i){console.error("âŒ Error fetching user data after auth:",i)}if(Ie){const i=Ie;Z(null),setTimeout(async()=>{await Ue(i)},500)}},Lt=(t,i=!1)=>{if(t.current){i&&!te&&Ge(!0);const T=t.current.getBoundingClientRect().top+window.pageYOffset+-100;window.scrollTo({top:T,behavior:"smooth"}),i&&setTimeout(()=>{X.current&&o&&X.current.zoomToListing(o._id)},600)}},Wt=()=>Lt(oe,!0);return p?e.jsxs(e.Fragment,{children:[e.jsx(ue,{}),e.jsx("main",{style:{minHeight:"70vh",paddingTop:"calc(80px + 2rem)"},children:e.jsx(lo,{})}),e.jsx(fe,{})]}):d||!o?e.jsxs(e.Fragment,{children:[e.jsx(ue,{}),e.jsxs("main",{style:{minHeight:"70vh",paddingTop:"calc(80px + 2rem)"},children:[e.jsx(ut,{error:d}),e.jsx(ut,{error:d,onRetry:null})]}),e.jsx(fe,{})]}):e.jsxs(e.Fragment,{children:[e.jsx(ue,{}),q.show&&e.jsxs("div",{className:`toast toast-${q.type} show`,children:[e.jsxs("span",{className:"toast-icon",children:[q.type==="success"&&e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})}),q.type==="error"&&e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})})]}),e.jsx("span",{className:"toast-message",children:q.message})]}),e.jsxs("main",{style:{maxWidth:r?"100%":"1400px",margin:"0 auto",padding:r?"1rem":"2rem",paddingTop:r?"calc(80px + 1rem)":"calc(100px + 2rem)",display:"grid",gridTemplateColumns:r?"1fr":"1fr 440px",gap:r?"1.5rem":"2rem",boxSizing:"border-box",width:"100%"},children:[e.jsxs("div",{className:"left-column",style:{minWidth:0,width:"100%",boxSizing:"border-box",overflowX:"hidden",overflowY:"visible"},children:[e.jsx("section",{style:{marginBottom:r?"1.5rem":"2rem"},children:o.photos&&o.photos.length>0?e.jsx(ao,{photos:o.photos,listingName:o.Name,onPhotoClick:Et,isMobile:r}):e.jsx("div",{style:{width:"100%",height:r?"250px":"400px",background:n.BG_LIGHT,borderRadius:r?"8px":"12px",display:"flex",alignItems:"center",justifyContent:"center",color:n.TEXT_LIGHT},children:"No images available"})}),e.jsxs("section",{style:{marginBottom:r?"1.5rem":"2rem"},children:[e.jsx("h1",{style:{fontSize:r?"1.5rem":"2rem",fontWeight:"700",marginBottom:r?"0.75rem":"1rem",color:n.TEXT_DARK},children:o.Name}),e.jsxs("div",{style:{display:"flex",gap:r?"0.5rem":"1rem",flexWrap:"wrap",color:n.TEXT_LIGHT,fontSize:r?"0.875rem":"1rem"},children:[o.resolvedNeighborhood&&o.resolvedBorough&&e.jsxs("span",{onClick:Wt,style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",textDecoration:"underline",transition:"color 0.2s"},onMouseEnter:t=>t.target.style.color=n.PRIMARY,onMouseLeave:t=>t.target.style.color=n.TEXT_LIGHT,children:["Located in ",o.resolvedNeighborhood,", ",o.resolvedBorough]}),o.resolvedTypeOfSpace&&e.jsxs("span",{children:[o.resolvedTypeOfSpace," - ",o["Features - Qty Guests"]," guests max"]})]})]}),e.jsxs("section",{style:{marginBottom:r?"1.5rem":"2rem",display:"grid",gridTemplateColumns:r?"repeat(2, 1fr)":"repeat(auto-fit, minmax(150px, 1fr))",gap:r?"0.5rem":"1rem"},children:[o["Kitchen Type"]&&e.jsxs("div",{style:{textAlign:"center",padding:r?"0.75rem":"1rem",background:n.BG_LIGHT,borderRadius:r?"6px":"8px"},children:[e.jsx("div",{style:{marginBottom:"0.5rem",display:"flex",justifyContent:"center",alignItems:"center",height:r?"1.5rem":"2rem"},children:e.jsx("img",{src:"/assets/images/fridge.svg",alt:"Kitchen",style:{width:r?"1.5rem":"2rem",height:r?"1.5rem":"2rem"}})}),e.jsx("div",{style:{fontSize:r?"0.8125rem":"1rem"},children:o["Kitchen Type"]})]}),o["Features - Qty Bathrooms"]!==null&&e.jsxs("div",{style:{textAlign:"center",padding:r?"0.75rem":"1rem",background:n.BG_LIGHT,borderRadius:r?"6px":"8px"},children:[e.jsx("div",{style:{marginBottom:"0.5rem",display:"flex",justifyContent:"center",alignItems:"center",height:r?"1.5rem":"2rem"},children:e.jsx("img",{src:"/assets/images/bath.svg",alt:"Bathroom",style:{width:r?"1.5rem":"2rem",height:r?"1.5rem":"2rem"}})}),e.jsxs("div",{style:{fontSize:r?"0.8125rem":"1rem"},children:[o["Features - Qty Bathrooms"]," Bathroom(s)"]})]}),o["Features - Qty Bedrooms"]!==null&&e.jsxs("div",{style:{textAlign:"center",padding:r?"0.75rem":"1rem",background:n.BG_LIGHT,borderRadius:r?"6px":"8px"},children:[e.jsx("div",{style:{marginBottom:"0.5rem",display:"flex",justifyContent:"center",alignItems:"center",height:r?"1.5rem":"2rem"},children:e.jsx("img",{src:"/assets/images/sleeping.svg",alt:"Bedroom",style:{width:r?"1.5rem":"2rem",height:r?"1.5rem":"2rem"}})}),e.jsx("div",{style:{fontSize:r?"0.8125rem":"1rem"},children:o["Features - Qty Bedrooms"]===0?"Studio":`${o["Features - Qty Bedrooms"]} Bedroom${o["Features - Qty Bedrooms"]===1?"":"s"}`})]}),o["Features - Qty Beds"]!==null&&e.jsxs("div",{style:{textAlign:"center",padding:r?"0.75rem":"1rem",background:n.BG_LIGHT,borderRadius:r?"6px":"8px"},children:[e.jsx("div",{style:{marginBottom:"0.5rem",display:"flex",justifyContent:"center",alignItems:"center",height:r?"1.5rem":"2rem"},children:e.jsx("img",{src:"/assets/images/bed.svg",alt:"Bed",style:{width:r?"1.5rem":"2rem",height:r?"1.5rem":"2rem"}})}),e.jsxs("div",{style:{fontSize:r?"0.8125rem":"1rem"},children:[o["Features - Qty Beds"]," Bed(s)"]})]})]}),e.jsxs("section",{style:{marginBottom:r?"1.25rem":"1.5rem"},children:[e.jsx("h2",{style:{fontSize:r?"1rem":"1.125rem",fontWeight:"600",marginBottom:r?"0.5rem":"0.75rem",color:n.TEXT_DARK},children:"Description of Lodging"}),e.jsxs("p",{style:{lineHeight:"1.6",color:n.TEXT_LIGHT,whiteSpace:"pre-wrap"},children:[$.description?o.Description:(Qe=o.Description)==null?void 0:Qe.slice(0,360),((Je=o.Description)==null?void 0:Je.length)>360&&!$.description&&"..."]}),((Ze=o.Description)==null?void 0:Ze.length)>360&&e.jsx("button",{onClick:()=>qe("description"),style:{marginTop:"0.5rem",background:"none",border:"none",color:n.PRIMARY,cursor:"pointer",fontWeight:"600",textDecoration:"underline"},children:$.description?"Read Less":"Read More"})]}),o.storageOption&&e.jsxs("section",{style:{marginBottom:r?"1.25rem":"1.5rem"},children:[e.jsx("h2",{style:{fontSize:r?"1rem":"1.125rem",fontWeight:"600",marginBottom:r?"0.5rem":"0.75rem",color:n.TEXT_DARK},children:"Storage"}),e.jsx("div",{style:{padding:r?"1rem":"1.5rem",background:n.BG_LIGHT,borderRadius:r?"8px":"12px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"start",gap:"1rem"},children:[e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{minWidth:"24px",minHeight:"24px",color:n.PRIMARY},children:[e.jsx("path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"}),e.jsx("polyline",{points:"3.27 6.96 12 12.01 20.73 6.96"}),e.jsx("line",{x1:"12",y1:"22.08",x2:"12",y2:"12"})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"600",marginBottom:"0.5rem"},children:o.storageOption.title}),e.jsx("div",{style:{color:n.TEXT_LIGHT,fontSize:"0.9375rem"},children:o.storageOption.summaryGuest||"Store your things between stays, ready when you return."})]})]})})]}),o["Description - Neighborhood"]&&e.jsxs("section",{style:{marginBottom:r?"1.25rem":"1.5rem"},children:[e.jsx("h2",{style:{fontSize:r?"1rem":"1.125rem",fontWeight:"600",marginBottom:r?"0.5rem":"0.75rem",color:n.TEXT_DARK},children:"Neighborhood"}),e.jsxs("p",{style:{lineHeight:"1.6",color:n.TEXT_LIGHT,whiteSpace:"pre-wrap"},children:[$.neighborhood?o["Description - Neighborhood"]:(Ve=o["Description - Neighborhood"])==null?void 0:Ve.slice(0,500),((et=o["Description - Neighborhood"])==null?void 0:et.length)>500&&!$.neighborhood&&"..."]}),((tt=o["Description - Neighborhood"])==null?void 0:tt.length)>500&&e.jsx("button",{onClick:()=>qe("neighborhood"),style:{marginTop:"0.5rem",background:"none",border:"none",color:n.PRIMARY,cursor:"pointer",fontWeight:"600",textDecoration:"underline"},children:$.neighborhood?"Read Less":"Read More"})]}),(o.parkingOption||o["Time to Station (commute)"])&&e.jsxs("section",{ref:Tt,style:{marginBottom:r?"1.25rem":"1.5rem"},children:[e.jsx("h2",{style:{fontSize:r?"1rem":"1.125rem",fontWeight:"600",marginBottom:r?"0.5rem":"0.75rem",color:n.TEXT_DARK},children:"Commute"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[o.parkingOption&&e.jsxs("div",{style:{display:"flex",alignItems:"start",gap:"1rem"},children:[e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{minWidth:"24px",minHeight:"24px",color:n.PRIMARY},children:[e.jsx("path",{d:"M14 16H9m10 0h3v-3.15a1 1 0 0 0-.84-.99L16 11l-2.7-3.6a1 1 0 0 0-.8-.4H5.24a2 2 0 0 0-1.8 1.1l-.8 1.63A6 6 0 0 0 2 12.42V16h2"}),e.jsx("circle",{cx:"6.5",cy:"16.5",r:"2.5"}),e.jsx("circle",{cx:"16.5",cy:"16.5",r:"2.5"})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"600"},children:o.parkingOption.label}),e.jsx("div",{style:{color:n.TEXT_LIGHT,fontSize:"0.875rem"},children:"Convenient parking for your car"})]})]}),o["Time to Station (commute)"]&&e.jsxs("div",{style:{display:"flex",alignItems:"start",gap:"1rem"},children:[e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{minWidth:"24px",minHeight:"24px",color:n.PRIMARY},children:[e.jsx("rect",{x:"3",y:"6",width:"18",height:"11",rx:"2"}),e.jsx("path",{d:"M7 15h.01M17 15h.01M8 6v5M16 6v5"}),e.jsx("path",{d:"M3 12h18"})]}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:"600"},children:[o["Time to Station (commute)"]," to Metro"]}),e.jsx("div",{style:{color:n.TEXT_LIGHT,fontSize:"0.875rem"},children:"Quick walk to nearest station"})]})]})]})]}),(((ot=o.amenitiesInUnit)==null?void 0:ot.length)>0||((rt=o.safetyFeatures)==null?void 0:rt.length)>0)&&e.jsxs("section",{ref:kt,style:{marginBottom:r?"1.25rem":"1.5rem"},children:[e.jsx("h2",{style:{fontSize:r?"1rem":"1.125rem",fontWeight:"600",marginBottom:r?"0.5rem":"0.75rem",color:n.TEXT_DARK},children:"Amenities"}),((st=o.amenitiesInUnit)==null?void 0:st.length)>0&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("h3",{style:{fontSize:r?"0.75rem":"0.875rem",fontWeight:"600",marginBottom:"0.5rem",color:n.TEXT_LIGHT,textTransform:"uppercase",letterSpacing:"0.5px"},children:"In-Unit"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:r?"repeat(auto-fill, minmax(140px, 1fr))":"repeat(auto-fill, minmax(200px, 1fr))",gap:r?"0.5rem":"0.75rem"},children:o.amenitiesInUnit.map(t=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:r?"0.375rem":"0.5rem"},children:[t.icon&&e.jsx("img",{src:t.icon,alt:"",style:{width:r?"20px":"24px",height:r?"20px":"24px"}}),e.jsx("span",{style:{fontSize:r?"0.8125rem":"0.875rem"},children:t.name})]},t.id))})]}),((it=o.safetyFeatures)==null?void 0:it.length)>0&&e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:r?"0.75rem":"0.875rem",fontWeight:"600",marginBottom:"0.5rem",color:n.TEXT_LIGHT,textTransform:"uppercase",letterSpacing:"0.5px"},children:"Safety Features"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:r?"repeat(auto-fill, minmax(140px, 1fr))":"repeat(auto-fill, minmax(200px, 1fr))",gap:r?"0.5rem":"0.75rem"},children:o.safetyFeatures.map(t=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:r?"0.375rem":"0.5rem"},children:[t.icon&&e.jsx("img",{src:t.icon,alt:"",style:{width:r?"20px":"24px",height:r?"20px":"24px"}}),e.jsx("span",{style:{fontSize:r?"0.8125rem":"0.875rem"},children:t.name})]},t.id))})]})]}),((nt=o.houseRules)==null?void 0:nt.length)>0&&e.jsxs("section",{ref:Rt,style:{marginBottom:r?"1.25rem":"1.5rem"},children:[e.jsx("h2",{style:{fontSize:r?"1rem":"1.125rem",fontWeight:"600",marginBottom:r?"0.5rem":"0.75rem",color:n.TEXT_DARK},children:"House Rules"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:o.houseRules.map(t=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:r?"0.375rem":"0.5rem"},children:[t.icon&&e.jsx("img",{src:t.icon,alt:"",style:{width:r?"20px":"24px",height:r?"20px":"24px"}}),e.jsx("span",{style:{fontSize:r?"0.875rem":"1rem"},children:t.name})]},t.id))})]}),e.jsxs("section",{ref:oe,style:{marginBottom:r?"1.25rem":"1.5rem"},children:[e.jsx("h2",{style:{fontSize:r?"1rem":"1.125rem",fontWeight:"600",marginBottom:r?"0.5rem":"0.75rem",color:n.TEXT_DARK},children:"Map"}),e.jsx("div",{style:{height:r?"300px":"400px",borderRadius:r?"8px":"12px",overflow:"hidden",border:`1px solid ${n.BG_LIGHT}`,position:"relative",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:n.BG_LIGHT},children:te?e.jsx(Yt,{ref:X,listings:Ye,filteredListings:Ye,selectedBorough:o.resolvedBorough,simpleMode:!0,initialZoom:17,disableAutoZoom:!1}):e.jsx("div",{style:{color:n.TEXT_LIGHT,fontSize:"0.9rem",textAlign:"center"},children:"Loading map..."})})]}),o.host&&e.jsxs("section",{style:{marginBottom:r?"1.25rem":"1.5rem"},children:[e.jsx("h2",{style:{fontSize:r?"1rem":"1.125rem",fontWeight:"600",marginBottom:r?"0.5rem":"0.75rem",color:n.TEXT_DARK},children:"Meet Your Host"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:r?"0.75rem":"1rem",background:n.BG_LIGHT,borderRadius:r?"8px":"10px"},children:[o.host["Profile Photo"]&&e.jsx("img",{src:o.host["Profile Photo"],alt:o.host["Name - First"],style:{width:r?"40px":"48px",height:r?"40px":"48px",borderRadius:"50%",objectFit:"cover"}}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{fontSize:r?"0.875rem":"0.9375rem",fontWeight:"600",marginBottom:"0.125rem"},children:[o.host["Name - First"]," ",(lt=o.host["Name - Last"])==null?void 0:lt.charAt(0),"."]}),e.jsx("div",{style:{color:n.TEXT_LIGHT,fontSize:r?"0.75rem":"0.8125rem"},children:"Host"})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{onClick:()=>pe(!0),style:{padding:r?"0.375rem 0.75rem":"0.5rem 1rem",background:n.PRIMARY,color:"white",border:"none",borderRadius:"6px",fontSize:r?"0.8125rem":"0.875rem",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"0.375rem",boxShadow:"0 2px 6px rgba(49, 19, 93, 0.2)"},onMouseEnter:t=>{t.target.style.background=n.PRIMARY_HOVER,t.target.style.transform="translateY(-1px)",t.target.style.boxShadow="0 3px 8px rgba(49, 19, 93, 0.25)"},onMouseLeave:t=>{t.target.style.background=n.PRIMARY,t.target.style.transform="",t.target.style.boxShadow="0 2px 6px rgba(49, 19, 93, 0.2)"},children:[e.jsx("svg",{width:r?"14":"16",height:r?"14":"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),e.jsx("span",{children:"Message"})]}),((at=o.host)==null?void 0:at.userId)&&e.jsxs("button",{onClick:()=>window.location.href=`/account-profile/${o.host.userId}`,style:{padding:r?"0.375rem 0.75rem":"0.5rem 1rem",background:"transparent",color:n.PRIMARY,border:`1.5px solid ${n.PRIMARY}`,borderRadius:"6px",fontSize:r?"0.8125rem":"0.875rem",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"0.375rem"},onMouseEnter:t=>{t.currentTarget.style.background=n.PRIMARY,t.currentTarget.style.color="white",t.currentTarget.style.transform="translateY(-1px)"},onMouseLeave:t=>{t.currentTarget.style.background="transparent",t.currentTarget.style.color=n.PRIMARY,t.currentTarget.style.transform=""},children:[e.jsxs("svg",{width:r?"14":"16",height:r?"14":"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),e.jsx("span",{children:"Profile"})]})]})]})]}),o.cancellationPolicy&&e.jsxs("section",{style:{marginBottom:r?"1.25rem":"1.5rem"},children:[e.jsx("h2",{style:{fontSize:r?"1rem":"1.125rem",fontWeight:"600",marginBottom:r?"0.5rem":"0.75rem",color:n.TEXT_DARK},children:"Cancellation Policy"}),e.jsxs("div",{style:{padding:r?"1rem":"1.5rem",background:n.BG_LIGHT,borderRadius:r?"8px":"12px",border:`1px solid ${n.BG_LIGHT}`},children:[e.jsx("div",{style:{fontSize:r?"1rem":"1.125rem",fontWeight:"600",marginBottom:r?"0.75rem":"1rem",color:n.PRIMARY},children:o.cancellationPolicy.display}),o.cancellationPolicy.bestCaseText&&e.jsxs("div",{style:{marginBottom:"0.75rem"},children:[e.jsx("div",{style:{fontWeight:"600",color:"#16a34a",marginBottom:"0.25rem"},children:"âœ“ Best Case"}),e.jsx("div",{style:{color:n.TEXT_LIGHT,fontSize:"0.9375rem",lineHeight:"1.6"},children:o.cancellationPolicy.bestCaseText})]}),o.cancellationPolicy.mediumCaseText&&e.jsxs("div",{style:{marginBottom:"0.75rem"},children:[e.jsx("div",{style:{fontWeight:"600",color:"#ea580c",marginBottom:"0.25rem"},children:"âš  Medium Case"}),e.jsx("div",{style:{color:n.TEXT_LIGHT,fontSize:"0.9375rem",lineHeight:"1.6"},children:o.cancellationPolicy.mediumCaseText})]}),o.cancellationPolicy.worstCaseText&&e.jsxs("div",{style:{marginBottom:"0.75rem"},children:[e.jsx("div",{style:{fontWeight:"600",color:"#dc2626",marginBottom:"0.25rem"},children:"âœ• Worst Case"}),e.jsx("div",{style:{color:n.TEXT_LIGHT,fontSize:"0.9375rem",lineHeight:"1.6"},children:o.cancellationPolicy.worstCaseText})]}),o.cancellationPolicy.summaryTexts&&Array.isArray(o.cancellationPolicy.summaryTexts)&&o.cancellationPolicy.summaryTexts.length>0&&e.jsxs("div",{style:{marginTop:"1rem",paddingTop:"1rem",borderTop:"1px solid #e5e7eb"},children:[e.jsx("div",{style:{fontWeight:"600",marginBottom:"0.5rem",fontSize:"0.875rem"},children:"Summary:"}),e.jsx("ul",{style:{margin:0,paddingLeft:"1.25rem",color:n.TEXT_LIGHT,fontSize:"0.875rem",lineHeight:"1.6"},children:o.cancellationPolicy.summaryTexts.map((t,i)=>e.jsx("li",{style:{marginBottom:"0.25rem"},children:t},i))})]}),e.jsx("div",{style:{marginTop:"1rem",paddingTop:"1rem",borderTop:"1px solid #e5e7eb"},children:e.jsx("a",{href:"/policies#cancellation-and-refund-policy",style:{color:n.PRIMARY,textDecoration:"none",fontSize:"0.875rem",fontWeight:"600",display:"inline-flex",alignItems:"center",gap:"0.25rem"},onMouseEnter:t=>t.target.style.textDecoration="underline",onMouseLeave:t=>t.target.style.textDecoration="none",children:"View full cancellation policy â†’"})})]})]})]}),e.jsxs("div",{className:"booking-widget",style:{display:r?"none":"block",position:"sticky",top:"calc(80px + 20px)",alignSelf:"flex-start",height:"fit-content",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"16px",padding:"28px",background:"white",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3), 0 0 1px rgba(0, 0, 0, 0.05)",backdropFilter:"blur(10px)",transition:"transform 0.3s ease, box-shadow 0.3s ease"},onMouseEnter:t=>{r||(t.currentTarget.style.transform="translateY(-4px)",t.currentTarget.style.boxShadow="0 24px 70px rgba(0, 0, 0, 0.35), 0 0 1px rgba(0, 0, 0, 0.05)")},onMouseLeave:t=>{r||(t.currentTarget.style.transform="",t.currentTarget.style.boxShadow="0 20px 60px rgba(0, 0, 0, 0.3), 0 0 1px rgba(0, 0, 0, 0.05)")},children:[e.jsxs("div",{style:{background:"linear-gradient(135deg, #f8f9ff 0%, #faf5ff 100%)",padding:"12px",borderRadius:"12px",marginBottom:"16px",border:"1px solid #e9d5ff",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{fontSize:"32px",fontWeight:"800",background:"linear-gradient(135deg, #31135d 0%, #31135d 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",letterSpacing:"-1px",display:"inline-block"},children:[s!=null&&s.valid&&(s!=null&&s.pricePerNight)?`$${Number.isInteger(s.pricePerNight)?s.pricePerNight:s.pricePerNight.toFixed(2)}`:"Select Days",e.jsx("span",{style:{fontSize:"16px",color:"#6B7280",fontWeight:"500",background:"none",WebkitTextFillColor:"#6B7280"},children:"/night"})]}),e.jsx(mt,{listingId:o==null?void 0:o._id,userId:a==null?void 0:a.userId,initialFavorited:Ae,onToggle:t=>G(t),onRequireAuth:()=>H(!0),size:"large",variant:"inline"})]}),e.jsxs("div",{style:{marginBottom:"10px"},children:[e.jsxs("label",{style:{fontSize:"12px",fontWeight:"700",color:"#31135d",marginBottom:"8px",display:"flex",alignItems:"center",gap:"6px",textTransform:"uppercase",letterSpacing:"0.5px"},children:[e.jsx("span",{onClick:t=>{t.stopPropagation(),console.log("Move-in text clicked, current state:",I),W(I==="moveIn"?null:"moveIn")},style:{cursor:"pointer"},children:"Ideal Move-In"}),e.jsx("svg",{ref:Fe,onClick:t=>{t.stopPropagation(),console.log("Move-in info icon clicked, current state:",I),W(I==="moveIn"?null:"moveIn")},style:{width:"16px",height:"16px",color:"#9CA3AF",cursor:"pointer"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})]}),e.jsx("div",{style:{position:"relative",marginBottom:"8px"},children:e.jsx("input",{type:"date",value:g||"",min:N,onChange:t=>A(t.target.value),style:{width:"100%",padding:"10px 12px",border:"2px solid #E5E7EB",borderRadius:"10px",fontSize:"15px",fontWeight:"500",color:"#111827",transition:"all 0.2s ease",cursor:"pointer",background:"white",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.05)"},onMouseEnter:t=>{t.target.style.borderColor="#31135d",t.target.style.boxShadow="0 4px 6px rgba(49, 19, 93, 0.1)"},onMouseLeave:t=>{document.activeElement!==t.target&&(t.target.style.borderColor="#E5E7EB",t.target.style.boxShadow="0 1px 3px rgba(0, 0, 0, 0.05)")},onFocus:t=>{t.target.style.borderColor="#31135d",t.target.style.boxShadow="0 0 0 4px rgba(49, 19, 93, 0.15)",t.target.style.transform="translateY(-1px)"},onBlur:t=>{t.target.style.borderColor="#E5E7EB",t.target.style.boxShadow="0 1px 3px rgba(0, 0, 0, 0.05)",t.target.style.transform=""}})}),e.jsx("div",{style:{fontSize:"12px",color:"#6B7280",lineHeight:"1.4",marginBottom:"10px",fontWeight:"400",paddingLeft:"4px"},children:"Minimum 2 weeks from today. Date auto-updates based on selected days."})]}),e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"10px",marginBottom:"14px",padding:"12px",background:"linear-gradient(135deg, #f8f9ff 0%, #faf5ff 100%)",borderRadius:"10px",border:"1px solid #e9d5ff",transition:"all 0.2s ease"},onMouseEnter:t=>{t.currentTarget.style.background="linear-gradient(135deg, #f5f3ff 0%, #faf5ff 100%)",t.currentTarget.style.borderColor="#d8b4fe"},onMouseLeave:t=>{t.currentTarget.style.background="linear-gradient(135deg, #f8f9ff 0%, #faf5ff 100%)",t.currentTarget.style.borderColor="#e9d5ff"},children:[e.jsx("input",{type:"checkbox",checked:Q,onChange:()=>je(!Q),style:{width:"18px",height:"18px",cursor:"pointer",accentColor:"#31135d",marginTop:"2px",flexShrink:0}}),e.jsxs("label",{style:{fontSize:"14px",color:"#111827",userSelect:"none",lineHeight:"1.5",fontWeight:"500"},children:[e.jsx("span",{onClick:t=>{t.stopPropagation(),W(I==="flexibility"?null:"flexibility")},style:{cursor:"pointer"},children:"Strict (no negotiation on exact move in)"}),e.jsx("svg",{ref:_e,onClick:t=>{t.stopPropagation(),W(I==="flexibility"?null:"flexibility")},style:{display:"inline-block",width:"14px",height:"14px",verticalAlign:"middle",marginLeft:"2px",opacity:.6,cursor:"pointer"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})]})]}),!r&&Y&&e.jsx("div",{style:{marginBottom:"14px",padding:"12px",background:"linear-gradient(135deg, #f9fafb 0%, #f3f4f6 100%)",borderRadius:"12px",border:"1px solid #E5E7EB"},children:e.jsx(ye,{listing:Y,initialSelectedDays:L,limitToFiveNights:!1,reservationSpan:D,zatConfig:w,onSelectionChange:ge,onPriceChange:xe,showPricing:!1})}),!r&&o&&e.jsxs("div",{style:{marginBottom:"14px",padding:"12px",background:"linear-gradient(135deg, #f9fafb 0%, #f3f4f6 100%)",borderRadius:"12px",border:"1px solid #E5E7EB"},children:[e.jsxs("div",{style:{fontSize:"13px",color:"#4B5563"},children:[e.jsx("span",{children:"This listing is "}),e.jsx("strong",{style:{color:"#31135d"},children:(o==null?void 0:o["Weeks offered"])||"Every week"}),e.jsx("span",{children:". "}),e.jsx("button",{onClick:()=>ze(!O),style:{background:"none",border:"none",color:"#7C3AED",textDecoration:"underline",cursor:"pointer",padding:0,fontSize:"13px",fontWeight:"500"},children:O?"Hide custom schedule":"Click here if you want to specify another recurrent schedule"})]}),O&&e.jsxs("div",{style:{marginTop:"10px"},children:[e.jsx("textarea",{value:ae,onChange:t=>We(t.target.value),placeholder:"Describe your preferred schedule pattern in detail (e.g., 'I need the space every other week starting January 15th' or 'Weekdays only for the first month, then full weeks')",style:{width:"100%",minHeight:"80px",padding:"10px 12px",border:"2px solid #E5E7EB",borderRadius:"8px",fontSize:"14px",fontFamily:"inherit",resize:"vertical",boxSizing:"border-box"},onFocus:t=>{t.target.style.borderColor="#7C3AED",t.target.style.outline="none"},onBlur:t=>{t.target.style.borderColor="#E5E7EB"}}),e.jsx("p",{style:{marginTop:"6px",fontSize:"11px",color:"#6B7280"},children:"The host will review your custom schedule request and may adjust the proposal accordingly."})]})]}),e.jsxs("div",{style:{marginBottom:"12px"},children:[e.jsxs("label",{style:{fontSize:"12px",fontWeight:"700",color:"#31135d",marginBottom:"8px",display:"flex",alignItems:"center",gap:"6px",textTransform:"uppercase",letterSpacing:"0.5px"},children:[e.jsx("span",{onClick:t=>{t.stopPropagation(),W(I==="reservationSpan"?null:"reservationSpan")},style:{cursor:"pointer"},children:"Reservation Span"}),e.jsx("svg",{ref:He,onClick:t=>{t.stopPropagation(),W(I==="reservationSpan"?null:"reservationSpan")},style:{width:"16px",height:"16px",color:"#9CA3AF",cursor:"pointer"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})]}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("select",{value:D,onChange:t=>we(Number(t.target.value)),style:{width:"100%",padding:"10px 12px",paddingRight:"40px",border:"2px solid #E5E7EB",borderRadius:"10px",fontSize:"15px",fontWeight:"500",color:"#111827",background:"white",cursor:"pointer",transition:"all 0.2s ease",appearance:"none",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.05)"},onMouseEnter:t=>{t.target.style.borderColor="#31135d",t.target.style.boxShadow="0 4px 6px rgba(49, 19, 93, 0.1)"},onMouseLeave:t=>{document.activeElement!==t.target&&(t.target.style.borderColor="#E5E7EB",t.target.style.boxShadow="0 1px 3px rgba(0, 0, 0, 0.05)")},onFocus:t=>{t.target.style.borderColor="#31135d",t.target.style.boxShadow="0 0 0 4px rgba(49, 19, 93, 0.15)"},onBlur:t=>{t.target.style.borderColor="#E5E7EB",t.target.style.boxShadow="0 1px 3px rgba(0, 0, 0, 0.05)"},children:[6,7,8,9,10,12,13,16,17,20,22,26].map(t=>e.jsxs("option",{value:t,children:[t," weeks ",t>=12?`(${Math.floor(t/4)} months)`:""]},t))}),e.jsx("div",{style:{position:"absolute",right:"14px",top:"50%",transform:"translateY(-50%)",width:"0",height:"0",borderLeft:"5px solid transparent",borderRight:"5px solid transparent",borderTop:"5px solid #31135d",pointerEvents:"none"}})]}),e.jsx(ho,{reservationSpan:D,weeksOffered:o==null?void 0:o["Weeks offered"]})]}),e.jsx("div",{style:{marginBottom:"12px",padding:"12px",background:"linear-gradient(135deg, #f9fafb 0%, #ffffff 100%)",borderRadius:"10px",border:"1px solid #E5E7EB"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"15px"},children:[e.jsx("span",{style:{color:"#111827",fontWeight:"500"},children:"4-Week Rent"}),e.jsx("span",{style:{color:"#111827",fontWeight:"700",fontSize:"16px"},children:s!=null&&s.valid&&(s!=null&&s.fourWeekRent)?le(s.fourWeekRent):Xe||"Please Add More Days"})]})}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 0",borderTop:"2px solid #E5E7EB",marginBottom:"10px"},children:[e.jsx("span",{style:{fontSize:"16px",fontWeight:"700",color:"#111827"},children:"Reservation Estimated Total"}),e.jsx("span",{style:{fontSize:"28px",fontWeight:"800",background:"linear-gradient(135deg, #31135d 0%, #31135d 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:s!=null&&s.valid&&(s!=null&&s.reservationTotal)?le(s.reservationTotal):Xe||"Please Add More Days"})]}),e.jsx("button",{onClick:t=>{c!=null&&c.valid&&(s!=null&&s.valid)&&!v&&(t.target.style.transform="scale(0.98)",setTimeout(()=>{t.target.style.transform=""},150),Ke())},disabled:!(c!=null&&c.valid)||!(s!=null&&s.valid)||!!v,style:{width:"100%",padding:"14px",background:v?"#D1D5DB":c!=null&&c.valid&&(s!=null&&s.valid)?"linear-gradient(135deg, #31135d 0%, #31135d 100%)":"#D1D5DB",color:"white",border:"none",borderRadius:"10px",fontSize:"16px",fontWeight:"700",cursor:v||!(c!=null&&c.valid)||!(s!=null&&s.valid)?"not-allowed":"pointer",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:!v&&(c!=null&&c.valid)&&(s!=null&&s.valid)?"0 4px 14px rgba(49, 19, 93, 0.4)":"none",position:"relative",overflow:"hidden"},onMouseEnter:t=>{!v&&(c!=null&&c.valid)&&(s!=null&&s.valid)&&(t.target.style.transform="translateY(-2px)",t.target.style.boxShadow="0 8px 24px rgba(49, 19, 93, 0.5)")},onMouseLeave:t=>{!v&&(c!=null&&c.valid)&&(s!=null&&s.valid)&&(t.target.style.transform="",t.target.style.boxShadow="0 4px 14px rgba(49, 19, 93, 0.4)")},children:v?"Proposal Already Exists":s!=null&&s.valid&&(s!=null&&s.pricePerNight)?`Create Proposal at $${Number.isInteger(s.pricePerNight)?s.pricePerNight:s.pricePerNight.toFixed(2)}/night`:"Update Split Schedule Above"}),v&&(a==null?void 0:a.userId)&&e.jsx("a",{href:`/guest-proposals/${a.userId}?proposal=${v._id}`,style:{display:"block",textAlign:"center",marginTop:"12px",color:"#31135d",fontSize:"14px",fontWeight:"500",textDecoration:"none"},onMouseEnter:t=>{t.target.style.textDecoration="underline"},onMouseLeave:t=>{t.target.style.textDecoration="none"},children:"View your proposal in Dashboard"})]})]}),St&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"1rem"},onClick:()=>V(!1),children:e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"2rem",maxWidth:"500px",position:"relative"},onClick:t=>t.stopPropagation(),children:[e.jsx("button",{onClick:()=>V(!1),style:{position:"absolute",top:"1rem",right:"1rem",background:"none",border:"none",fontSize:"1.5rem",cursor:"pointer",color:n.TEXT_LIGHT},children:"Ã—"}),e.jsx("h2",{style:{fontSize:"1.5rem",fontWeight:"700",marginBottom:"1rem",color:n.TEXT_DARK},children:"How to set a split schedule"}),e.jsx("p",{style:{lineHeight:"1.6",color:n.TEXT_LIGHT,marginBottom:"1.5rem"},children:"To create a valid split schedule, you must select consecutive days (for example, Monday through Friday). Non-consecutive selections like Monday, Wednesday, Friday are not allowed."}),e.jsxs("div",{style:{padding:"1rem",background:n.BG_LIGHT,borderRadius:"8px",marginBottom:"1.5rem",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"2rem",marginBottom:"0.5rem"},children:"ðŸ¢"}),e.jsx("div",{style:{fontSize:"0.875rem",color:n.TEXT_DARK},children:"Stay 2-5 nights a week, save up to 50% off of a comparable Airbnb"})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("button",{onClick:()=>V(!1),style:{flex:1,padding:"0.75rem",background:n.PRIMARY,color:"white",border:"none",borderRadius:"8px",fontWeight:"600",cursor:"pointer"},children:"Okay"}),e.jsx("button",{onClick:()=>window.location.href="/faq.html",style:{flex:1,padding:"0.75rem",background:"white",color:n.PRIMARY,border:`2px solid ${n.PRIMARY}`,borderRadius:"8px",fontWeight:"600",cursor:"pointer"},children:"Take me to FAQ"})]})]})}),Ne&&o.photos&&o.photos.length>0&&e.jsxs("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.9)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:r?"1rem":"2rem"},onClick:()=>ee(!1),children:[e.jsx("button",{onClick:()=>ee(!1),style:{position:"absolute",top:r?"1rem":"2rem",right:r?"1rem":"2rem",background:"rgba(255,255,255,0.2)",border:"none",color:"white",fontSize:"2rem",width:"48px",height:"48px",borderRadius:"50%",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1002},children:"Ã—"}),e.jsx("img",{src:(dt=o.photos[ce])==null?void 0:dt.Photo,alt:`${o.Name} - photo ${ce+1}`,style:{maxWidth:r?"95vw":"90vw",maxHeight:r?"75vh":"80vh",objectFit:"contain",marginBottom:r?"6rem":"5rem"},onClick:t=>t.stopPropagation()}),e.jsxs("div",{style:{position:"absolute",bottom:r?"4rem":"5rem",left:"50%",transform:"translateX(-50%)",display:"flex",gap:r?"0.5rem":"1.5rem",alignItems:"center",flexWrap:"nowrap",zIndex:1001},children:[e.jsx("button",{onClick:t=>{t.stopPropagation(),he(i=>i>0?i-1:o.photos.length-1)},style:{background:"rgba(255,255,255,0.2)",border:"none",color:"white",padding:r?"0.5rem 1rem":"0.75rem 1.5rem",borderRadius:"8px",cursor:"pointer",fontWeight:"600",fontSize:r?"0.875rem":"1rem",whiteSpace:"nowrap"},children:"â† Previous"}),e.jsxs("span",{style:{color:"white",fontSize:r?"0.75rem":"0.875rem",whiteSpace:"nowrap",minWidth:r?"60px":"80px",textAlign:"center"},children:[ce+1," / ",o.photos.length]}),e.jsx("button",{onClick:t=>{t.stopPropagation(),he(i=>i<o.photos.length-1?i+1:0)},style:{background:"rgba(255,255,255,0.2)",border:"none",color:"white",padding:r?"0.5rem 1rem":"0.75rem 1.5rem",borderRadius:"8px",cursor:"pointer",fontWeight:"600",fontSize:r?"0.875rem":"1rem",whiteSpace:"nowrap"},children:"Next â†’"})]}),e.jsx("button",{onClick:()=>ee(!1),style:{position:"absolute",bottom:r?"1rem":"1.5rem",left:"50%",transform:"translateX(-50%)",background:"white",border:"none",color:n.TEXT_DARK,padding:r?"0.5rem 2rem":"0.75rem 2.5rem",borderRadius:"8px",cursor:"pointer",fontWeight:"600",fontSize:r?"0.875rem":"1rem",zIndex:1001},children:"Close"})]}),Te&&e.jsx(Ot,{listing:o,moveInDate:g,daysSelected:L,nightsSelected:Ct,reservationSpan:D,pricingBreakdown:ke,zatConfig:w,isFirstProposal:!a||a.proposalCount===0&&!a.needForSpace&&!a.aboutMe,existingUserData:a?{needForSpace:a.needForSpace||"",aboutYourself:a.aboutMe||"",hasUniqueRequirements:!!a.specialNeeds,uniqueRequirements:a.specialNeeds||""}:null,onClose:()=>J(!1),onSubmit:Pt,isSubmitting:Me}),Re&&e.jsx(qt,{isOpen:Re,onClose:()=>{H(!1),Z(null)},initialView:"signup-step1",onAuthSuccess:Mt,defaultUserType:"guest",skipReload:!0}),bt&&e.jsx(Gt,{proposalId:vt,listingName:o==null?void 0:o.Name,hasSubmittedRentalApp:(a==null?void 0:a.hasSubmittedRentalApp)??!1,onClose:()=>{Ee(!1),Pe(null)}}),Be&&o&&e.jsx($t,{isOpen:Be,onClose:()=>pe(!1),listing:{id:o._id,title:o.Name,host:{userId:(ct=o.host)==null?void 0:ct.userId,name:o.host?`${o.host["Name - First"]} ${(ht=o.host["Name - Last"])==null?void 0:ht.charAt(0)}.`:"Host"}},onLoginRequired:()=>{pe(!1),H(!0)}}),f["aligned schedule with move-in"]&&e.jsx(be,{isOpen:I==="moveIn",onClose:()=>W(null),triggerRef:Fe,title:"Ideal Move-In",content:r&&f["aligned schedule with move-in"].mobile||f["aligned schedule with move-in"].desktop,expandedContent:f["aligned schedule with move-in"].desktopPlus,showMoreAvailable:f["aligned schedule with move-in"].showMore}),f["move-in flexibility"]&&e.jsx(be,{isOpen:I==="flexibility",onClose:()=>W(null),triggerRef:_e,title:"Move-In Flexibility",content:r&&f["move-in flexibility"].mobile||f["move-in flexibility"].desktop,expandedContent:f["move-in flexibility"].desktopPlus,showMoreAvailable:f["move-in flexibility"].showMore}),f["Reservation Span"]&&e.jsx(be,{isOpen:I==="reservationSpan",onClose:()=>W(null),triggerRef:He,title:"Reservation Span",content:r&&f["Reservation Span"].mobile||f["Reservation Span"].desktop,expandedContent:f["Reservation Span"].desktopPlus,showMoreAvailable:f["Reservation Span"].showMore}),r&&!Te&&!Ne&&e.jsxs(e.Fragment,{children:[B&&e.jsx("div",{onClick:()=>me(!1),style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.5)",zIndex:9998}}),e.jsx("div",{style:{position:"fixed",bottom:0,left:0,right:0,background:"white",boxShadow:"0 -4px 20px rgba(0, 0, 0, 0.15)",zIndex:9999,borderTopLeftRadius:B?"20px":"0",borderTopRightRadius:B?"20px":"0",transition:"all 0.3s ease",maxHeight:B?"80vh":"auto",overflowY:B?"auto":"hidden"},children:B?e.jsxs("div",{style:{padding:"20px 16px",paddingBottom:"24px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"700",color:"#111827",margin:0},children:"Complete Your Booking"}),e.jsx("button",{onClick:()=>me(!1),style:{background:"none",border:"none",fontSize:"24px",cursor:"pointer",color:"#6B7280",padding:"4px"},children:"Ã—"})]}),e.jsxs("div",{style:{background:"linear-gradient(135deg, #f8f9ff 0%, #faf5ff 100%)",padding:"12px",borderRadius:"12px",marginBottom:"16px",border:"1px solid #e9d5ff",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{fontSize:"24px",fontWeight:"800",color:"#31135d"},children:[s!=null&&s.valid&&(s!=null&&s.pricePerNight)?`$${Number.isInteger(s.pricePerNight)?s.pricePerNight:s.pricePerNight.toFixed(2)}`:"Select Days",e.jsx("span",{style:{fontSize:"14px",color:"#6B7280",fontWeight:"500"},children:"/night"})]}),e.jsx(mt,{listingId:o==null?void 0:o._id,userId:a==null?void 0:a.userId,initialFavorited:Ae,onToggle:t=>G(t),onRequireAuth:()=>H(!0),size:"medium",variant:"inline"})]}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{style:{fontSize:"12px",fontWeight:"700",color:"#31135d",marginBottom:"8px",display:"block",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Ideal Move-In"}),e.jsx("input",{type:"date",value:g||"",min:N,onChange:t=>A(t.target.value),style:{width:"100%",padding:"12px",border:"2px solid #E5E7EB",borderRadius:"10px",fontSize:"16px",fontWeight:"500",color:"#111827",boxSizing:"border-box"}})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"16px",padding:"12px",background:"#f8f9ff",borderRadius:"10px",border:"1px solid #e9d5ff"},children:[e.jsx("input",{type:"checkbox",checked:Q,onChange:()=>je(!Q),style:{width:"20px",height:"20px",cursor:"pointer",accentColor:"#31135d"}}),e.jsx("label",{style:{fontSize:"14px",color:"#111827",fontWeight:"500"},children:"Strict (no negotiation on exact move in)"})]}),Y&&e.jsx("div",{style:{marginBottom:"16px",padding:"12px",background:"#f9fafb",borderRadius:"12px",border:"1px solid #E5E7EB"},children:e.jsx(ye,{listing:Y,initialSelectedDays:L,limitToFiveNights:!1,reservationSpan:D,zatConfig:w,onSelectionChange:ge,onPriceChange:xe,showPricing:!1})}),!!o&&e.jsxs("div",{style:{marginBottom:"16px",padding:"12px",background:"#f9fafb",borderRadius:"12px",border:"1px solid #E5E7EB"},children:[e.jsxs("div",{style:{fontSize:"13px",color:"#4B5563"},children:[e.jsx("span",{children:"This listing is "}),e.jsx("strong",{style:{color:"#31135d"},children:(o==null?void 0:o["Weeks offered"])||"Every week"}),e.jsx("span",{children:". "}),e.jsx("button",{onClick:()=>ze(!O),style:{background:"none",border:"none",color:"#7C3AED",textDecoration:"underline",cursor:"pointer",padding:0,fontSize:"13px",fontWeight:"500"},children:O?"Hide custom schedule":"Click here if you want to specify another recurrent schedule"})]}),O&&e.jsxs("div",{style:{marginTop:"10px"},children:[e.jsx("textarea",{value:ae,onChange:t=>We(t.target.value),placeholder:"Describe your preferred schedule pattern in detail...",style:{width:"100%",minHeight:"80px",padding:"10px 12px",border:"2px solid #E5E7EB",borderRadius:"8px",fontSize:"14px",fontFamily:"inherit",resize:"vertical",boxSizing:"border-box"},onFocus:t=>{t.target.style.borderColor="#7C3AED",t.target.style.outline="none"},onBlur:t=>{t.target.style.borderColor="#E5E7EB"}}),e.jsx("p",{style:{marginTop:"6px",fontSize:"11px",color:"#6B7280"},children:"The host will review your custom schedule request."})]})]}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{style:{fontSize:"12px",fontWeight:"700",color:"#31135d",marginBottom:"8px",display:"block",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Reservation Span"}),e.jsx("select",{value:D,onChange:t=>we(Number(t.target.value)),style:{width:"100%",padding:"12px",border:"2px solid #E5E7EB",borderRadius:"10px",fontSize:"16px",fontWeight:"500",color:"#111827",background:"white",boxSizing:"border-box"},children:[6,7,8,9,10,12,13,16,17,20,22,26].map(t=>e.jsxs("option",{value:t,children:[t," weeks ",t>=12?`(${Math.floor(t/4)} months)`:""]},t))})]}),e.jsxs("div",{style:{marginBottom:"16px",padding:"12px",background:"#f9fafb",borderRadius:"10px",border:"1px solid #E5E7EB"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px",fontSize:"15px"},children:[e.jsx("span",{style:{color:"#111827",fontWeight:"500"},children:"4-Week Rent"}),e.jsx("span",{style:{color:"#111827",fontWeight:"700"},children:s!=null&&s.valid&&(s!=null&&s.fourWeekRent)?le(s.fourWeekRent):"â€”"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingTop:"8px",borderTop:"1px solid #E5E7EB"},children:[e.jsx("span",{style:{fontSize:"16px",fontWeight:"700",color:"#111827"},children:"Reservation Total"}),e.jsx("span",{style:{fontSize:"20px",fontWeight:"800",color:"#31135d"},children:s!=null&&s.valid&&(s!=null&&s.reservationTotal)?le(s.reservationTotal):"â€”"})]})]}),e.jsx("button",{onClick:()=>{c!=null&&c.valid&&(s!=null&&s.valid)&&!v&&Ke()},disabled:!(c!=null&&c.valid)||!(s!=null&&s.valid)||!!v,style:{width:"100%",padding:"16px",background:v?"#D1D5DB":c!=null&&c.valid&&(s!=null&&s.valid)?"#31135d":"#D1D5DB",color:"white",border:"none",borderRadius:"10px",fontSize:"16px",fontWeight:"700",cursor:v||!(c!=null&&c.valid)||!(s!=null&&s.valid)?"not-allowed":"pointer"},children:v?"Proposal Already Exists":s!=null&&s.valid&&(s!=null&&s.pricePerNight)?`Create Proposal at $${Number.isInteger(s.pricePerNight)?s.pricePerNight:s.pricePerNight.toFixed(2)}/night`:"Update Split Schedule Above"}),v&&(a==null?void 0:a.userId)&&e.jsx("a",{href:`/guest-proposals/${a.userId}?proposal=${v._id}`,style:{display:"block",textAlign:"center",marginTop:"12px",color:"#31135d",fontSize:"14px",fontWeight:"500"},children:"View your proposal in Dashboard"})]}):e.jsxs("div",{style:{padding:"12px 16px"},children:[Y&&e.jsx("div",{style:{marginBottom:"12px"},children:e.jsx(ye,{listing:Y,initialSelectedDays:L,limitToFiveNights:!1,reservationSpan:D,zatConfig:w,onSelectionChange:ge,onPriceChange:xe,showPricing:!1})}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"12px"},children:[e.jsx("div",{style:{flex:1},children:e.jsxs("div",{style:{fontSize:"18px",fontWeight:"700",color:"#31135d"},children:[s!=null&&s.valid&&(s!=null&&s.pricePerNight)?`$${Number.isInteger(s.pricePerNight)?s.pricePerNight:s.pricePerNight.toFixed(2)}`:"Select Days",e.jsx("span",{style:{fontSize:"14px",color:"#6B7280",fontWeight:"500"},children:"/night"})]})}),e.jsx("button",{onClick:()=>me(!0),style:{padding:"12px 24px",background:"#31135d",color:"white",border:"none",borderRadius:"10px",fontSize:"16px",fontWeight:"600",cursor:"pointer",whiteSpace:"nowrap"},children:"Continue"})]})]})}),e.jsx("div",{style:{height:B?"0":"140px"}})]}),e.jsx(fe,{})]})}console.log("ðŸš€ view-split-lease entry v9 - NUCLEAR CACHE BUST - "+Date.now());Ht(document.getElementById("root")).render(e.jsx(_t.StrictMode,{children:e.jsx(no,{children:e.jsx(xo,{})})}));
