import{r,j as e,c as ue,R as me}from"./client-BJVKzfAi.js";import{u as he,a as fe}from"./Toast-BQk6Nzgd.js";import{s as xe}from"./supabase-BoCLEw6R.js";import{a as ge}from"./adaptLeaseFromSupabase-pMJWDmu_.js";import{A as B}from"./AdminHeader-tCInZd3n.js";import{E as pe}from"./ErrorBoundary-9_HbXv1y.js";/* empty css             */import"./config-QPKPRtag.js";import"./auth-QZ4BJadW.js";import"./star-OtPMgcH9.js";import"./createLucideIcon-CgZZH2OU.js";import"./file-text-Bqp_Hw0X.js";import"./triangle-alert-Bp6DQQmR.js";import"./users-d0RSvnp4.js";import"./pen-line-Duo49k9O.js";import"./calendar-CDI4qHEX.js";import"./mail-CRbL90NL.js";import"./user-check-CoCGzn5Y.js";import"./dollar-sign-Dn2-KjNW.js";import"./send-C4mziT0-.js";import"./x-CrJVeoCh.js";function ve(s,{searchQuery:t="",statusFilter:n="all"}){return Array.isArray(s)?s.filter(o=>{var c,p,h,m,d,f,g,x,j;if(n&&n!=="all"&&o.status!==n)return!1;if(t){const y=t.toLowerCase().trim();if(![o.id,o.agreementNumber,(c=o.guest)==null?void 0:c.email,(p=o.guest)==null?void 0:p.firstName,(h=o.guest)==null?void 0:h.lastName,(m=o.host)==null?void 0:m.email,(d=o.host)==null?void 0:d.firstName,(f=o.host)==null?void 0:f.lastName,(g=o.listing)==null?void 0:g.name,(x=o.listing)==null?void 0:x.address,(j=o.listing)==null?void 0:j.neighborhood].some(_=>_?String(_).toLowerCase().includes(y):!1))return!1}return!0}):[]}function _e(s,{field:t="createdAt",order:n="desc"}){if(!Array.isArray(s))return[];const o=[...s];return o.sort((c,p)=>{const h=F(c,t),m=F(p,t);if(h==null&&m==null)return 0;if(h==null)return 1;if(m==null)return-1;let d=0;return h instanceof Date&&m instanceof Date?d=h.getTime()-m.getTime():typeof h=="number"&&typeof m=="number"?d=h-m:d=String(h).localeCompare(String(m)),n==="desc"?-d:d}),o}function F(s,t){var n,o,c;switch(t){case"createdAt":return s.createdAt;case"startDate":return s.startDate;case"endDate":return s.endDate;case"totalRent":return s.totalRent;case"totalCompensation":return s.totalCompensation;case"agreementNumber":return s.agreementNumber;case"status":return s.status;case"guestEmail":return(n=s.guest)==null?void 0:n.email;case"hostEmail":return(o=s.host)==null?void 0:o.email;case"listingName":return(c=s.listing)==null?void 0:c.name;default:return s[t]}}function U(s){return s?!["cancelled","completed"].includes(s.status):!1}function je(s){return!s||s.status!=="cancelled"||s.stays&&s.stays.length>0&&s.stays.filter(n=>{var o;return["active","upcoming","in-progress"].includes((o=n.status)==null?void 0:o.toLowerCase())}).length>0?!1:(s.totalRent>0&&s.paidToDate>0,!0)}const P="https://qcfifybkaddcoimjroca.supabase.co",O=20;function be({showToast:s}){const[t,n]=r.useState([]),[o,c]=r.useState(!0),[p,h]=r.useState(null),[m,d]=r.useState(""),[f,g]=r.useState(""),[x,j]=r.useState("all"),[y,N]=r.useState("createdAt"),[k,_]=r.useState("desc"),[C,R]=r.useState(1),[v,S]=r.useState([]),[V,w]=r.useState(null),I=r.useMemo(()=>[{value:"all",label:"All Statuses"},{value:"active",label:"Active"},{value:"completed",label:"Completed"},{value:"cancelled",label:"Cancelled"},{value:"pending",label:"Pending"}],[]),z=r.useMemo(()=>[{value:"createdAt",label:"Created Date"},{value:"startDate",label:"Start Date"},{value:"endDate",label:"End Date"},{value:"totalRent",label:"Total Rent"},{value:"agreementNumber",label:"Agreement #"}],[]),G=r.useMemo(()=>[{value:"active",label:"Mark Active"},{value:"completed",label:"Mark Completed"},{value:"cancelled",label:"Mark Cancelled"}],[]);r.useEffect(()=>{(async()=>{try{const{data:{session:l}}=await xe.auth.getSession(),i=localStorage.getItem("sl_auth_token")||sessionStorage.getItem("sl_auth_token");d((l==null?void 0:l.access_token)||i||"")}catch(l){console.error("[LeasesOverview] Token lookup failed:",l),d("")}})()},[]);const E=r.useCallback(()=>{const a={"Content-Type":"application/json"};return m&&(a.Authorization=`Bearer ${m}`),a},[m]),A=r.useCallback(async()=>{c(!0),h(null);try{const a=await fetch(`${P}/functions/v1/leases-admin`,{method:"POST",headers:E(),body:JSON.stringify({action:"list",payload:{limit:500,offset:0}})}),l=await a.json();if(!a.ok||!l.success)throw new Error(l.error||"Failed to fetch leases");const i=(l.data||[]).map(ge);n(i)}catch(a){console.error("[LeasesOverview] Fetch error:",a),h(a.message),s({title:"Failed to load leases",content:a.message,type:"error"})}finally{c(!1)}},[E,s]);r.useEffect(()=>{A()},[A]);const M=r.useMemo(()=>{let a=ve(t,{searchQuery:f,statusFilter:x});return a=_e(a,{field:y,order:k}),a},[t,f,x,y,k]),Q=Math.ceil(M.length/O),L=r.useMemo(()=>{const a=(C-1)*O;return M.slice(a,a+O)},[M,C]);r.useEffect(()=>{R(1)},[f,x,y,k]);const q=r.useMemo(()=>({total:t.length,active:t.filter(a=>a.status==="active").length,completed:t.filter(a=>a.status==="completed").length,cancelled:t.filter(a=>a.status==="cancelled").length,pending:t.filter(a=>a.status==="pending").length}),[t]),J=r.useCallback(a=>{S(l=>l.includes(a)?l.filter(i=>i!==a):[...l,a])},[]),Y=r.useCallback(()=>{const a=L.map(l=>l.id);S(l=>a.every(u=>l.includes(u))?l.filter(u=>!a.includes(u)):[...new Set([...l,...a])])},[L]),K=r.useCallback(()=>{S([])},[]),Z=r.useMemo(()=>{const a=L.map(l=>l.id);return a.length>0&&a.every(l=>v.includes(l))},[L,v]),b=r.useCallback(async(a,l)=>{const i=await fetch(`${P}/functions/v1/leases-admin`,{method:"POST",headers:E(),body:JSON.stringify({action:a,payload:l})}),u=await i.json();if(!i.ok||!u.success)throw new Error(u.error||`Action ${a} failed`);return u.data},[E]),X=r.useCallback(async(a,l)=>{try{c(!0),await b("updateStatus",{leaseId:a,status:l}),n(i=>i.map(u=>u.id===a?{...u,status:l}:u)),s({title:"Status updated",type:"success"})}catch(i){console.error("[LeasesOverview] Status update error:",i),s({title:"Failed to update status",content:i.message,type:"error"})}finally{c(!1)}},[b,s]),ee=r.useCallback(a=>{const l=t.find(i=>i.id===a);if(l){if(!U(l)){s({title:"Cannot cancel this lease",content:"Only draft or pending leases can be cancelled",type:"warning"});return}w({isOpen:!0,title:"Cancel Lease",message:`Are you sure you want to cancel lease ${l.agreementNumber||l.id}? This will set the status to "cancelled" but the record will be preserved.`,confirmLabel:"Cancel Lease",confirmType:"warning",requiresDoubleConfirm:!1,onConfirm:async()=>{try{c(!0),await b("softDelete",{leaseId:a}),n(i=>i.map(u=>u.id===a?{...u,status:"cancelled"}:u)),s({title:"Lease cancelled",type:"success"}),w(null)}catch(i){console.error("[LeasesOverview] Soft delete error:",i),s({title:"Failed to cancel lease",content:i.message,type:"error"})}finally{c(!1)}}})}},[t,b,s]),se=r.useCallback(a=>{const l=t.find(i=>i.id===a);if(l){if(!je(l)){s({title:"Cannot permanently delete this lease",content:"Only cancelled leases with no active stays can be permanently deleted",type:"warning"});return}w({isOpen:!0,title:"Permanently Delete Lease",message:`WARNING: This will PERMANENTLY delete lease ${l.agreementNumber||l.id} and all associated data. This action cannot be undone!`,confirmLabel:"Delete Forever",confirmType:"danger",requiresDoubleConfirm:!0,onConfirm:async()=>{try{c(!0),await b("hardDelete",{leaseId:a}),n(i=>i.filter(u=>u.id!==a)),S(i=>i.filter(u=>u!==a)),s({title:"Lease permanently deleted",type:"success"}),w(null)}catch(i){console.error("[LeasesOverview] Hard delete error:",i),s({title:"Failed to delete lease",content:i.message,type:"error"})}finally{c(!1)}}})}},[t,b,s]),te=r.useCallback(async a=>{if(v.length!==0)try{c(!0),await b("bulkUpdateStatus",{leaseIds:v,status:a}),n(l=>l.map(i=>v.includes(i.id)?{...i,status:a}:i)),s({title:`${v.length} leases updated`,type:"success"}),S([])}catch(l){console.error("[LeasesOverview] Bulk status update error:",l),s({title:"Bulk update failed",content:l.message,type:"error"})}finally{c(!1)}},[v,b,s]),ae=r.useCallback(async(a="csv")=>{if(v.length!==0)try{c(!0);const l=await b("bulkExport",{leaseIds:v,format:a}),i=new Blob([l.content],{type:a==="csv"?"text/csv":"application/json"}),u=URL.createObjectURL(i),D=document.createElement("a");D.href=u,D.download=`leases-export-${new Date().toISOString().split("T")[0]}.${a}`,document.body.appendChild(D),D.click(),document.body.removeChild(D),URL.revokeObjectURL(u),s({title:"Export complete",type:"success"})}catch(l){console.error("[LeasesOverview] Export error:",l),s({title:"Export failed",content:l.message,type:"error"})}finally{c(!1)}},[v,b,s]),le=r.useCallback(()=>{if(v.length===0)return;const a=v.filter(l=>{const i=t.find(u=>u.id===l);return i&&U(i)});if(a.length===0){s({title:"No leases can be cancelled",content:"Selected leases are not eligible for cancellation",type:"warning"});return}w({isOpen:!0,title:"Cancel Multiple Leases",message:`Are you sure you want to cancel ${a.length} lease(s)? ${a.length<v.length?`(${v.length-a.length} leases are not eligible)`:""}`,confirmLabel:"Cancel Leases",confirmType:"warning",requiresDoubleConfirm:!1,onConfirm:async()=>{try{c(!0),await b("bulkSoftDelete",{leaseIds:a}),n(l=>l.map(i=>a.includes(i.id)?{...i,status:"cancelled"}:i)),s({title:`${a.length} leases cancelled`,type:"success"}),S([]),w(null)}catch(l){console.error("[LeasesOverview] Bulk soft delete error:",l),s({title:"Bulk cancel failed",content:l.message,type:"error"})}finally{c(!1)}}})},[v,t,b,s]),ne=r.useCallback(a=>{console.log("[LeasesOverview] View documents for:",a),s({title:"Document viewer coming soon",type:"info"})},[s]),re=r.useCallback(a=>{console.log("[LeasesOverview] Upload document for:",a),s({title:"Document upload coming soon",type:"info"})},[s]),oe=r.useCallback(()=>{_(a=>a==="asc"?"desc":"asc")},[]),ie=r.useCallback(()=>{g(""),j("all"),N("createdAt"),_("desc")},[]),ce=r.useCallback(()=>{A()},[A]),de=r.useCallback(()=>{w(null)},[]);return{leases:t,filteredLeases:L,stats:q,isLoading:o,error:p,searchQuery:f,setSearchQuery:g,statusFilter:x,setStatusFilter:j,sortField:y,setSortField:N,sortOrder:k,toggleSortOrder:oe,statusOptions:I,sortOptions:z,bulkStatusOptions:G,page:C,setPage:R,totalPages:Q,selectedLeases:v,handleSelectLease:J,handleSelectAll:Y,handleClearSelection:K,isAllSelected:Z,handleStatusChange:X,handleSoftDelete:ee,handleHardDelete:se,handleBulkStatusChange:te,handleBulkExport:ae,handleBulkSoftDelete:le,handleViewDocuments:ne,handleUploadDocument:re,handleClearFilters:ie,handleRetry:ce,confirmDialog:V,handleCloseConfirmDialog:de}}function ye(s){var t,n;return s?{truncatedId:ke(s.id),statusLabel:Ne(s.status),dateRange:Ce(s.startDate,s.endDate),totalRent:$(s.totalRent),totalCompensation:$(s.totalCompensation),paidToDate:$(s.paidToDate),paymentProgress:we(s.paidToDate,s.totalRent),maskedGuestEmail:W((t=s.guest)==null?void 0:t.email),maskedHostEmail:W((n=s.host)==null?void 0:n.email),createdAt:H(s.createdAt),modifiedAt:H(s.modifiedAt)}:{truncatedId:"N/A",statusLabel:"Unknown",dateRange:"No dates",totalRent:"$0.00",totalCompensation:"$0.00",paidToDate:"$0.00",paymentProgress:0,maskedGuestEmail:"Unknown",maskedHostEmail:"Unknown",createdAt:"Unknown",modifiedAt:"Unknown"}}function ke(s,t=8){return s?s.length<=t?s:`${s.slice(0,t)}...`:"N/A"}function Ne(s){return{active:"Active",completed:"Completed",cancelled:"Cancelled",pending:"Pending",draft:"Draft",unknown:"Unknown"}[s]||s||"Unknown"}function Ce(s,t){if(!s&&!t)return"No dates set";const n={month:"short",day:"numeric",year:"numeric"},o=s?s.toLocaleDateString("en-US",n):"TBD",c=t?t.toLocaleDateString("en-US",n):"TBD";return`${o} - ${c}`}function $(s){return s==null||isNaN(s)?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(s)}function we(s,t){if(!t||t===0||!s||s===0)return 0;const n=s/t*100;return Math.min(100,Math.round(n))}function W(s){if(!s||typeof s!="string")return"Unknown";const[t,n]=s.split("@");return n?t.length<=2?`${t}***@${n}`:`${t.slice(0,2)}***@${n}`:s}function H(s){if(!s||!(s instanceof Date)||isNaN(s.getTime()))return"Unknown";const n=new Date().getTime()-s.getTime(),o=Math.floor(n/(1e3*60*60*24));if(o===0){const c=Math.floor(n/36e5);if(c===0){const p=Math.floor(n/6e4);return p<1?"Just now":`${p}m ago`}return`${c}h ago`}return o===1?"Yesterday":o<7?`${o} days ago`:o<30?`${Math.floor(o/7)} weeks ago`:s.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}function Se({lease:s,isSelected:t,onSelect:n,onStatusChange:o,onSoftDelete:c,onHardDelete:p,onViewDocuments:h,onUploadDocument:m}){var y,N,k;const[d,f]=r.useState(!1),g=r.useRef(null),x=ye(s);r.useEffect(()=>{const _=C=>{g.current&&!g.current.contains(C.target)&&f(!1)};return d&&document.addEventListener("mousedown",_),()=>{document.removeEventListener("mousedown",_)}},[d]);const j=`lease-card__status--${s.status||"unknown"}`;return e.jsxs("article",{className:`lease-card ${t?"lease-card--selected":""}`,children:[e.jsx("div",{className:"lease-card__select",children:e.jsx("input",{type:"checkbox",checked:t,onChange:()=>n(s.id),"aria-label":`Select lease ${s.agreementNumber||s.id}`})}),e.jsxs("header",{className:"lease-card__header",children:[e.jsxs("div",{className:"lease-card__id-group",children:[e.jsx("span",{className:"lease-card__agreement-number",children:s.agreementNumber||"No Agreement #"}),e.jsx("span",{className:"lease-card__id",title:s.id,children:x.truncatedId})]}),e.jsx("span",{className:`lease-card__status ${j}`,children:x.statusLabel})]}),e.jsxs("div",{className:"lease-card__content",children:[e.jsxs("div",{className:"lease-card__row",children:[e.jsx("span",{className:"lease-card__label",children:"Guest"}),e.jsx("span",{className:"lease-card__value",children:(y=s.guest)!=null&&y.email?x.maskedGuestEmail:"Unknown"})]}),e.jsxs("div",{className:"lease-card__row",children:[e.jsx("span",{className:"lease-card__label",children:"Host"}),e.jsx("span",{className:"lease-card__value",children:(N=s.host)!=null&&N.email?x.maskedHostEmail:"Unknown"})]}),s.listing&&e.jsxs("div",{className:"lease-card__row",children:[e.jsx("span",{className:"lease-card__label",children:"Listing"}),e.jsx("span",{className:"lease-card__value lease-card__value--truncate",title:s.listing.name,children:s.listing.name||"Unnamed Listing"})]}),e.jsxs("div",{className:"lease-card__row",children:[e.jsx("span",{className:"lease-card__label",children:"Period"}),e.jsx("span",{className:"lease-card__value",children:x.dateRange})]}),e.jsxs("div",{className:"lease-card__row lease-card__row--highlight",children:[e.jsx("span",{className:"lease-card__label",children:"Total Rent"}),e.jsx("span",{className:"lease-card__value lease-card__value--money",children:x.totalRent})]}),e.jsxs("div",{className:"lease-card__row",children:[e.jsx("span",{className:"lease-card__label",children:"Stays"}),e.jsxs("span",{className:"lease-card__value",children:[((k=s.stays)==null?void 0:k.length)||0," stay(s)"]})]})]}),e.jsxs("footer",{className:"lease-card__footer",children:[e.jsxs("span",{className:"lease-card__created",children:["Created ",x.createdAt]}),e.jsxs("div",{className:"lease-card__actions",ref:g,children:[e.jsx("button",{className:"lease-card__menu-trigger",onClick:()=>f(!d),"aria-label":"Actions","aria-expanded":d,children:e.jsxs("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:[e.jsx("circle",{cx:"12",cy:"5",r:"2"}),e.jsx("circle",{cx:"12",cy:"12",r:"2"}),e.jsx("circle",{cx:"12",cy:"19",r:"2"})]})}),d&&e.jsxs("div",{className:"lease-card__menu",children:[e.jsxs("button",{className:"lease-card__menu-item",onClick:()=>{h(s.id),f(!1)},children:[e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"})]}),"View Documents"]}),e.jsxs("button",{className:"lease-card__menu-item",onClick:()=>{m(s.id),f(!1)},children:[e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("polyline",{points:"17 8 12 3 7 8"}),e.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),"Upload Document"]}),e.jsx("hr",{className:"lease-card__menu-divider"}),s.status!=="active"&&e.jsxs("button",{className:"lease-card__menu-item",onClick:()=>{o(s.id,"active"),f(!1)},children:[e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),"Mark Active"]}),s.status!=="completed"&&e.jsxs("button",{className:"lease-card__menu-item",onClick:()=>{o(s.id,"completed"),f(!1)},children:[e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("polyline",{points:"9 11 12 14 22 4"}),e.jsx("path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"})]}),"Mark Completed"]}),e.jsx("hr",{className:"lease-card__menu-divider"}),s.status!=="cancelled"&&e.jsxs("button",{className:"lease-card__menu-item lease-card__menu-item--warning",onClick:()=>{c(s.id),f(!1)},children:[e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),e.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),"Cancel Lease"]}),e.jsxs("button",{className:"lease-card__menu-item lease-card__menu-item--danger",onClick:()=>{p(s.id),f(!1)},children:[e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("polyline",{points:"3 6 5 6 21 6"}),e.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),e.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),e.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]}),"Delete Permanently"]})]})]})]})]})}function Le({value:s,onChange:t,placeholder:n="Search..."}){return e.jsxs("div",{className:"search-box",children:[e.jsxs("svg",{className:"search-box__icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),e.jsx("input",{type:"text",className:"search-box__input",value:s,onChange:o=>t(o.target.value),placeholder:n,"aria-label":n}),s&&e.jsx("button",{className:"search-box__clear",onClick:()=>t(""),"aria-label":"Clear search",children:e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})}function T({value:s,onChange:t,options:n,label:o}){return e.jsxs("div",{className:"lease-dropdown",children:[o&&e.jsx("label",{className:"lease-dropdown__label",children:o}),e.jsxs("div",{className:"lease-dropdown__wrapper",children:[e.jsx("select",{className:"lease-dropdown__select",value:s,onChange:c=>t(c.target.value),"aria-label":o,children:n.map(c=>e.jsx("option",{value:c.value,children:c.label},c.value))}),e.jsx("svg",{className:"lease-dropdown__icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("polyline",{points:"6 9 12 15 18 9"})})]})]})}function De({selectedCount:s,onSelectAll:t,onClearSelection:n,onBulkStatusChange:o,onBulkExport:c,onBulkDelete:p,isAllSelected:h,statusOptions:m}){const[d,f]=r.useState(!1),[g,x]=r.useState(!1);return e.jsxs("div",{className:"bulk-toolbar",children:[e.jsxs("div",{className:"bulk-toolbar__info",children:[e.jsxs("span",{className:"bulk-toolbar__count",children:[s," selected"]}),e.jsx("button",{className:"bulk-toolbar__select-all",onClick:t,children:h?"Deselect All":"Select All"}),e.jsx("button",{className:"bulk-toolbar__clear",onClick:n,children:"Clear Selection"})]}),e.jsxs("div",{className:"bulk-toolbar__actions",children:[e.jsxs("div",{className:"bulk-toolbar__dropdown",children:[e.jsxs("button",{className:"bulk-toolbar__btn",onClick:()=>f(!d),"aria-expanded":d,children:[e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M12 20h9"}),e.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"})]}),"Change Status",e.jsx("svg",{className:"bulk-toolbar__dropdown-arrow",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),d&&e.jsx("div",{className:"bulk-toolbar__menu",children:m.map(j=>e.jsx("button",{className:"bulk-toolbar__menu-item",onClick:()=>{o(j.value),f(!1)},children:j.label},j.value))})]}),e.jsxs("div",{className:"bulk-toolbar__dropdown",children:[e.jsxs("button",{className:"bulk-toolbar__btn",onClick:()=>x(!g),"aria-expanded":g,children:[e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("polyline",{points:"7 10 12 15 17 10"}),e.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),"Export",e.jsx("svg",{className:"bulk-toolbar__dropdown-arrow",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),g&&e.jsxs("div",{className:"bulk-toolbar__menu",children:[e.jsx("button",{className:"bulk-toolbar__menu-item",onClick:()=>{c("csv"),x(!1)},children:"Export as CSV"}),e.jsx("button",{className:"bulk-toolbar__menu-item",onClick:()=>{c("json"),x(!1)},children:"Export as JSON"})]})]}),e.jsxs("button",{className:"bulk-toolbar__btn bulk-toolbar__btn--danger",onClick:p,children:[e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),e.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),"Cancel Selected"]})]})]})}function Ee({message:s="Loading..."}){return e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"loading-state__spinner"}),e.jsx("p",{className:"loading-state__message",children:s})]})}function Ae({title:s,message:t,onClearFilters:n}){return e.jsxs("div",{className:"empty-state",children:[e.jsx("svg",{className:"empty-state__icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:e.jsx("path",{d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("h3",{className:"empty-state__title",children:s}),e.jsx("p",{className:"empty-state__message",children:t}),n&&e.jsx("button",{className:"empty-state__btn",onClick:n,children:"Clear Filters"})]})}function Me({message:s,onRetry:t}){return e.jsxs("div",{className:"error-state",children:[e.jsx("svg",{className:"error-state__icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:e.jsx("path",{d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsx("h3",{className:"error-state__title",children:"Something went wrong"}),e.jsx("p",{className:"error-state__message",children:s}),t&&e.jsx("button",{className:"error-state__btn",onClick:t,children:"Try Again"})]})}function Be({isOpen:s,title:t,message:n,confirmLabel:o,confirmType:c="warning",onConfirm:p,onCancel:h,requiresDoubleConfirm:m=!1}){const[d,f]=r.useState(!1),[g,x]=r.useState(""),j=r.useRef(null);if(r.useEffect(()=>{s&&(f(!1),x(""))},[s]),r.useEffect(()=>{if(!s)return;const _=C=>{C.key==="Escape"&&h()};return document.addEventListener("keydown",_),()=>document.removeEventListener("keydown",_)},[s,h]),!s)return null;const y=()=>{m?f(!0):p()},N=()=>{g==="DELETE"&&p()},k=c==="danger"?"confirm-dialog__btn--danger":"confirm-dialog__btn--warning";return e.jsx("div",{className:"confirm-dialog__overlay",onClick:h,children:e.jsxs("div",{className:"confirm-dialog",ref:j,role:"dialog","aria-modal":"true","aria-labelledby":"confirm-dialog-title",onClick:_=>_.stopPropagation(),children:[e.jsx("div",{className:`confirm-dialog__icon confirm-dialog__icon--${c}`,children:c==="danger"?e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("polyline",{points:"3 6 5 6 21 6"}),e.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]}):e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"}),e.jsx("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),e.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]})}),e.jsx("h2",{id:"confirm-dialog-title",className:"confirm-dialog__title",children:t}),e.jsx("p",{className:"confirm-dialog__message",children:n}),m&&d&&e.jsxs("div",{className:"confirm-dialog__double-confirm",children:[e.jsxs("label",{className:"confirm-dialog__input-label",children:["Type ",e.jsx("strong",{children:"DELETE"})," to confirm:"]}),e.jsx("input",{type:"text",className:"confirm-dialog__input",value:g,onChange:_=>x(_.target.value.toUpperCase()),placeholder:"DELETE",autoFocus:!0})]}),e.jsxs("div",{className:"confirm-dialog__actions",children:[e.jsx("button",{className:"confirm-dialog__btn confirm-dialog__btn--cancel",onClick:h,children:"Cancel"}),m&&d?e.jsx("button",{className:`confirm-dialog__btn ${k}`,onClick:N,disabled:g!=="DELETE",children:o}):e.jsx("button",{className:`confirm-dialog__btn ${k}`,onClick:y,children:m?"Continue":o})]})]})})}function Oe(){const{showToast:s}=he(),t=be({showToast:s});return t.isLoading&&!t.leases.length?e.jsxs("div",{className:"leases-overview",children:[e.jsx(B,{}),e.jsx(Ee,{message:"Loading leases..."})]}):t.error&&!t.leases.length?e.jsxs("div",{className:"leases-overview",children:[e.jsx(B,{}),e.jsx(Me,{message:t.error,onRetry:t.handleRetry})]}):e.jsxs("div",{className:"leases-overview",children:[e.jsx(B,{}),e.jsxs("header",{className:"leases-overview__header",children:[e.jsxs("div",{className:"leases-overview__header-content",children:[e.jsx("h1",{className:"leases-overview__title",children:"Leases Overview"}),e.jsx("p",{className:"leases-overview__subtitle",children:"Manage and monitor all lease agreements"})]}),e.jsxs("div",{className:"leases-overview__header-stats",children:[e.jsxs("div",{className:"leases-overview__stat",children:[e.jsx("span",{className:"leases-overview__stat-value",children:t.stats.total}),e.jsx("span",{className:"leases-overview__stat-label",children:"Total"})]}),e.jsxs("div",{className:"leases-overview__stat leases-overview__stat--active",children:[e.jsx("span",{className:"leases-overview__stat-value",children:t.stats.active}),e.jsx("span",{className:"leases-overview__stat-label",children:"Active"})]}),e.jsxs("div",{className:"leases-overview__stat leases-overview__stat--completed",children:[e.jsx("span",{className:"leases-overview__stat-value",children:t.stats.completed}),e.jsx("span",{className:"leases-overview__stat-label",children:"Completed"})]})]})]}),e.jsxs("div",{className:"leases-overview__filters",children:[e.jsx(Le,{value:t.searchQuery,onChange:t.setSearchQuery,placeholder:"Search by ID, guest, listing..."}),e.jsx(T,{value:t.statusFilter,onChange:t.setStatusFilter,options:t.statusOptions,label:"Status"}),e.jsx(T,{value:t.sortField,onChange:t.setSortField,options:t.sortOptions,label:"Sort by"}),e.jsx("button",{className:`leases-overview__sort-order ${t.sortOrder==="desc"?"leases-overview__sort-order--desc":""}`,onClick:t.toggleSortOrder,"aria-label":`Sort ${t.sortOrder==="asc"?"descending":"ascending"}`,children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 5v14M5 12l7 7 7-7",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),t.selectedLeases.length>0&&e.jsx(De,{selectedCount:t.selectedLeases.length,onSelectAll:t.handleSelectAll,onClearSelection:t.handleClearSelection,onBulkStatusChange:t.handleBulkStatusChange,onBulkExport:t.handleBulkExport,onBulkDelete:t.handleBulkSoftDelete,isAllSelected:t.isAllSelected,statusOptions:t.bulkStatusOptions}),t.filteredLeases.length===0?e.jsx(Ae,{title:t.searchQuery||t.statusFilter!=="all"?"No matching leases":"No leases found",message:t.searchQuery||t.statusFilter!=="all"?"Try adjusting your filters or search terms":"Leases will appear here once created",onClearFilters:t.searchQuery||t.statusFilter!=="all"?t.handleClearFilters:null}):e.jsx("div",{className:"leases-overview__grid",children:t.filteredLeases.map(n=>e.jsx(Se,{lease:n,isSelected:t.selectedLeases.includes(n.id),onSelect:t.handleSelectLease,onStatusChange:t.handleStatusChange,onSoftDelete:t.handleSoftDelete,onHardDelete:t.handleHardDelete,onViewDocuments:t.handleViewDocuments,onUploadDocument:t.handleUploadDocument},n.id))}),t.totalPages>1&&e.jsxs("div",{className:"leases-overview__pagination",children:[e.jsx("button",{className:"leases-overview__pagination-btn",onClick:()=>t.setPage(t.page-1),disabled:t.page===1,children:"Previous"}),e.jsxs("span",{className:"leases-overview__pagination-info",children:["Page ",t.page," of ",t.totalPages]}),e.jsx("button",{className:"leases-overview__pagination-btn",onClick:()=>t.setPage(t.page+1),disabled:t.page===t.totalPages,children:"Next"})]}),t.confirmDialog&&e.jsx(Be,{isOpen:t.confirmDialog.isOpen,title:t.confirmDialog.title,message:t.confirmDialog.message,confirmLabel:t.confirmDialog.confirmLabel,confirmType:t.confirmDialog.confirmType,onConfirm:t.confirmDialog.onConfirm,onCancel:t.handleCloseConfirmDialog,requiresDoubleConfirm:t.confirmDialog.requiresDoubleConfirm}),t.isLoading&&t.leases.length>0&&e.jsx("div",{className:"leases-overview__loading-overlay",children:e.jsx("div",{className:"leases-overview__loading-spinner"})})]})}ue(document.getElementById("root")).render(e.jsx(me.StrictMode,{children:e.jsx(pe,{children:e.jsx(fe,{children:e.jsx(Oe,{})})})}));
