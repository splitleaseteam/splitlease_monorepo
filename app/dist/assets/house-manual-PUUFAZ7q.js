import{r as s,j as e,c as Ce,R as be}from"./client-BJVKzfAi.js";/* empty css             */import{H as $}from"./Header-BJKWma2V.js";import{F as G}from"./Footer-Bzf1rLKh.js";import{s as W}from"./supabase-BoCLEw6R.js";import{a as ke}from"./Toast-BQk6Nzgd.js";import"./config-QPKPRtag.js";import"./auth-QZ4BJadW.js";import"./constants-CPVJY5eo.js";import"./proposalDataFetcher-CipdyWU2.js";import"./proposalStatuses-1Bj0NYR4.js";const d=Object.freeze({FREEFORM_TEXT:"freeform_text",WIFI_PHOTO:"wifi_photo",PDF_DOC:"pdf_doc",PHONE_CALL:"phone_call",AUDIO_RECORD:"audio_record"}),Z={wifi_name:"",wifi_password:"",check_in_instructions:"",check_out_instructions:"",parking_info:"",emergency_contacts:[],house_rules:[],appliance_instructions:"",local_recommendations:[],additional_notes:""};function Ne(o={}){const[a,i]=s.useState(d.FREEFORM_TEXT),[n,m]=s.useState({[d.FREEFORM_TEXT]:!1,[d.WIFI_PHOTO]:!1,[d.PDF_DOC]:!1,[d.PHONE_CALL]:!1,[d.AUDIO_RECORD]:!1}),[y,r]=s.useState({...Z,...o}),[t,p]=s.useState({[d.FREEFORM_TEXT]:null,[d.WIFI_PHOTO]:null,[d.PDF_DOC]:null,[d.PHONE_CALL]:null,[d.AUDIO_RECORD]:null}),[c,g]=s.useState({[d.FREEFORM_TEXT]:!1,[d.WIFI_PHOTO]:!1,[d.PDF_DOC]:!1,[d.PHONE_CALL]:!1,[d.AUDIO_RECORD]:!1}),f=s.useCallback((h,x)=>{m(_=>({..._,[h]:x})),x&&(p(_=>({..._,[h]:null})),g(_=>({..._,[h]:!1})))},[]),C=s.useCallback((h,x)=>{p(_=>({..._,[h]:x}))},[]),j=s.useCallback(h=>{g(x=>({...x,[h]:!0}))},[]),I=s.useCallback((h,x)=>{r(_=>({..._,...x})),j(h)},[j]),b=s.useCallback(()=>{r({...Z,...o})},[o]),w=s.useCallback(h=>{p(x=>({...x,[h]:null}))},[]),l=s.useCallback(()=>{i(d.FREEFORM_TEXT),m({[d.FREEFORM_TEXT]:!1,[d.WIFI_PHOTO]:!1,[d.PDF_DOC]:!1,[d.PHONE_CALL]:!1,[d.AUDIO_RECORD]:!1}),r({...Z,...o}),p({[d.FREEFORM_TEXT]:null,[d.WIFI_PHOTO]:null,[d.PDF_DOC]:null,[d.PHONE_CALL]:null,[d.AUDIO_RECORD]:null}),g({[d.FREEFORM_TEXT]:!1,[d.WIFI_PHOTO]:!1,[d.PDF_DOC]:!1,[d.PHONE_CALL]:!1,[d.AUDIO_RECORD]:!1})},[o]),k=s.useMemo(()=>Object.values(n).some(Boolean),[n]),N=s.useMemo(()=>Object.values(t).some(Boolean),[t]),A=s.useMemo(()=>n[a],[n,a]),O=s.useMemo(()=>t[a],[t,a]),S=s.useMemo(()=>Object.entries(y).some(([h,x])=>h==="emergency_contacts"||h==="house_rules"||h==="local_recommendations"?Array.isArray(x)&&x.length>0:!!x),[y]);return{activeMethod:a,processingStates:n,extractedData:y,errors:t,successStates:c,setActiveMethod:i,setProcessingState:f,setError:C,setSuccess:j,updateExtractedData:I,clearExtractedData:b,clearError:w,resetAll:l,isAnyProcessing:k,hasAnyError:N,isActiveMethodProcessing:A,activeMethodError:O,hasExtractedContent:S,INPUT_METHODS:d}}const ge=s.createContext(null);function Te({children:o,initialData:a={}}){const i=Ne(a);return e.jsx(ge.Provider,{value:i,children:o})}function U(){const o=s.useContext(ge);if(!o)throw new Error("useAITools must be used within an AIToolsProvider. Wrap your component tree with <AIToolsProvider>.");return o}const Ee=()=>e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),e.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),e.jsx("polyline",{points:"10 9 9 9 8 9"})]}),Ie=()=>e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M5 12.55a11 11 0 0 1 14.08 0"}),e.jsx("path",{d:"M1.42 9a16 16 0 0 1 21.16 0"}),e.jsx("path",{d:"M8.53 16.11a6 6 0 0 1 6.95 0"}),e.jsx("line",{x1:"12",y1:"20",x2:"12.01",y2:"20"})]}),Fe=()=>e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"}),e.jsx("path",{d:"M19 10v2a7 7 0 0 1-14 0v-2"}),e.jsx("line",{x1:"12",y1:"19",x2:"12",y2:"23"}),e.jsx("line",{x1:"8",y1:"23",x2:"16",y2:"23"})]}),Oe=()=>e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"})]}),Pe=()=>e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"})}),oe={[d.FREEFORM_TEXT]:{icon:Ee,label:"Text Input",shortLabel:"Text",description:"Type or paste your house manual content"},[d.WIFI_PHOTO]:{icon:Ie,label:"WiFi Photo",shortLabel:"WiFi",description:"Extract WiFi credentials from a photo"},[d.AUDIO_RECORDING]:{icon:Fe,label:"Voice Recording",shortLabel:"Voice",description:"Record or upload audio of your house manual"},[d.PDF_DOC]:{icon:Oe,label:"Document Upload",shortLabel:"Docs",description:"Upload PDF or import from Google Docs"},[d.PHONE_CALL]:{icon:Pe,label:"AI Phone Call",shortLabel:"Call",description:"Receive an AI-powered call to collect information"}};function De({className:o=""}){var y;const{activeMethod:a,setActiveMethod:i,isAnyProcessing:n}=U(),m=Object.values(d);return e.jsxs("div",{className:`ai-tools-selector ${o}`,children:[e.jsx("div",{className:"ai-tools-selector__tabs",role:"tablist",children:m.map(r=>{const t=oe[r],p=t.icon,c=a===r;return e.jsxs("button",{type:"button",role:"tab","aria-selected":c,className:`ai-tools-selector__tab ${c?"ai-tools-selector__tab--active":""}`,onClick:()=>i(r),disabled:n,title:t.description,children:[e.jsx("span",{className:"ai-tools-selector__tab-icon",children:e.jsx(p,{})}),e.jsx("span",{className:"ai-tools-selector__tab-label",children:t.label}),e.jsx("span",{className:"ai-tools-selector__tab-short-label",children:t.shortLabel})]},r)})}),e.jsx("p",{className:"ai-tools-selector__description",children:(y=oe[a])==null?void 0:y.description})]})}const te=()=>e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"})}),Me=()=>e.jsx("svg",{className:"ai-tools-spinner",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"})}),Ae=()=>e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#22c55e",strokeWidth:"2",children:e.jsx("path",{d:"M20 6L9 17l-5-5"})}),Re=[{label:"Basic Info",text:`WiFi Network: MyHomeNetwork
WiFi Password: SecurePass123

Check-in: Use the lockbox (code: 1234) at the front door. Keys are inside.
Check-out: Leave keys on the kitchen counter. No need to clean, just tidy up.`},{label:"Detailed Manual",text:`Welcome to our apartment!

WiFi Details:
- Network: ApartmentWiFi_5G
- Password: Welcome2024!

Check-in Instructions:
1. Find the lockbox on the left side of the main entrance
2. Code is 5678
3. Take the silver key for the apartment
4. Unit is #305 on the 3rd floor

Check-out:
- Please leave by 11 AM
- Strip the beds and leave linens in the hamper
- Take out any trash
- Lock all windows
- Return keys to the lockbox

House Rules:
- No smoking inside
- Quiet hours: 10 PM - 8 AM
- No parties or events
- Max 4 guests

Parking: One spot in the garage, space #15. Use the remote on the keychain.`}],J=10,ie=5e4;function ae({onDataExtracted:o}){const{setProcessingState:a,setError:i,updateExtractedData:n,processingStates:m,errors:y,successStates:r,INPUT_METHODS:t}=U(),[p,c]=s.useState(""),[g,f]=s.useState(!1),C=m[t.FREEFORM_TEXT],j=y[t.FREEFORM_TEXT],I=r[t.FREEFORM_TEXT],b=s.useCallback(async()=>{if(p.trim().length<J){i(t.FREEFORM_TEXT,`Please enter at least ${J} characters`);return}a(t.FREEFORM_TEXT,!0);try{const{data:l,error:k}=await W.functions.invoke("house-manual",{body:{action:"parse_text",payload:{text:p.trim()}}});if(k)throw new Error(k.message||"Failed to process text");if(!(l!=null&&l.success))throw new Error((l==null?void 0:l.error)||"Failed to parse text");n(t.FREEFORM_TEXT,l.data),o==null||o(l.data),window.showToast&&window.showToast("Text parsed successfully!","success")}catch(l){console.error("[FreeformTextInput] Error:",l),i(t.FREEFORM_TEXT,l.message),window.showToast&&window.showToast(l.message,"error")}finally{a(t.FREEFORM_TEXT,!1)}},[p,a,i,n,o,t]),w=s.useCallback(l=>{c(l.text),f(!1)},[]);return e.jsxs("div",{className:"ai-tools-freeform",children:[e.jsxs("div",{className:"ai-tools-freeform__header",children:[e.jsxs("h3",{className:"ai-tools-freeform__title",children:[e.jsx(te,{}),"Type or Paste Your House Manual"]}),e.jsx("p",{className:"ai-tools-freeform__description",children:"Enter your house manual content in any format. Our AI will extract WiFi credentials, check-in instructions, house rules, and more."})]}),e.jsxs("div",{className:"ai-tools-freeform__templates",children:[e.jsx("button",{type:"button",className:"ai-tools-freeform__template-toggle",onClick:()=>f(!g),children:g?"Hide Examples":"Show Examples"}),g&&e.jsx("div",{className:"ai-tools-freeform__template-list",children:Re.map((l,k)=>e.jsxs("button",{type:"button",className:"ai-tools-freeform__template-btn",onClick:()=>w(l),children:['Use "',l.label,'"']},k))})]}),e.jsxs("div",{className:"ai-tools-freeform__input-wrapper",children:[e.jsx("textarea",{className:"ai-tools-freeform__textarea",value:p,onChange:l=>c(l.target.value),placeholder:`Paste your house manual content here...\r
\r
Example:\r
WiFi: MyNetwork / Password123\r
Check-in: Use the lockbox (code 1234) by the front door...\r
House Rules: No smoking, quiet hours after 10pm...`,disabled:C,maxLength:ie,rows:12}),e.jsxs("div",{className:"ai-tools-freeform__char-count",children:[p.length.toLocaleString()," / ",ie.toLocaleString()," characters"]})]}),j&&e.jsx("div",{className:"ai-tools-freeform__error",children:j}),I&&!C&&e.jsxs("div",{className:"ai-tools-freeform__success",children:[e.jsx(Ae,{}),"Content parsed successfully! Review the extracted fields below."]}),e.jsx("button",{type:"button",className:"ai-tools-freeform__submit",onClick:b,disabled:C||p.trim().length<J,children:C?e.jsxs(e.Fragment,{children:[e.jsx(Me,{}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(te,{}),"Extract Information"]})}),e.jsx("p",{className:"ai-tools-freeform__hint",children:"Tip: Include WiFi details, check-in/out instructions, parking info, and house rules for best results."})]})}const Se=()=>e.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[e.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),e.jsx("circle",{cx:"12",cy:"13",r:"4"})]}),ne=()=>e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M5 12.55a11 11 0 0 1 14.08 0"}),e.jsx("path",{d:"M1.42 9a16 16 0 0 1 21.16 0"}),e.jsx("path",{d:"M8.53 16.11a6 6 0 0 1 6.95 0"}),e.jsx("line",{x1:"12",y1:"20",x2:"12.01",y2:"20"})]}),Le=()=>e.jsx("svg",{className:"ai-tools-spinner",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"})}),We=()=>e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#22c55e",strokeWidth:"2",children:e.jsx("path",{d:"M20 6L9 17l-5-5"})}),He=()=>e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),le=["image/jpeg","image/jpg","image/png","image/gif","image/webp"],K=10;async function Ue(o){return new Promise((a,i)=>{const n=new FileReader;n.onload=()=>{const m=n.result.split(",")[1];a(m)},n.onerror=i,n.readAsDataURL(o)})}function Be({onDataExtracted:o}){const{setProcessingState:a,setError:i,updateExtractedData:n,processingStates:m,errors:y,successStates:r,INPUT_METHODS:t}=U(),p=s.useRef(null),[c,g]=s.useState(null),[f,C]=s.useState(null),[j,I]=s.useState(!1),[b,w]=s.useState(null),l=m[t.WIFI_PHOTO],k=y[t.WIFI_PHOTO];r[t.WIFI_PHOTO];const N=s.useCallback(async v=>{if(!le.includes(v.type)){i(t.WIFI_PHOTO,"Please upload a JPG, PNG, GIF, or WebP image");return}if(v.size>K*1024*1024){i(t.WIFI_PHOTO,`Image must be smaller than ${K}MB`);return}C(v),w(null);const T=new FileReader;T.onload=P=>g(P.target.result),T.readAsDataURL(v)},[i,t]),A=s.useCallback(v=>{var P;const T=(P=v.target.files)==null?void 0:P[0];T&&N(T)},[N]),O=s.useCallback(v=>{v.preventDefault(),I(!0)},[]),S=s.useCallback(v=>{v.preventDefault(),I(!1)},[]),h=s.useCallback(v=>{var P;v.preventDefault(),I(!1);const T=(P=v.dataTransfer.files)==null?void 0:P[0];T&&N(T)},[N]),x=s.useCallback(()=>{C(null),g(null),w(null),p.current&&(p.current.value="")},[]),_=s.useCallback(async()=>{if(f){a(t.WIFI_PHOTO,!0);try{const v=await Ue(f),{data:T,error:P}=await W.functions.invoke("house-manual",{body:{action:"extract_wifi",payload:{image:v,mimeType:f.type}}});if(P)throw new Error(P.message||"Failed to process image");if(!(T!=null&&T.success))throw new Error((T==null?void 0:T.error)||"Failed to extract WiFi credentials");const u=T.data;w(u),u.wifi_name||u.wifi_password?(n(t.WIFI_PHOTO,{wifi_name:u.wifi_name||"",wifi_password:u.wifi_password||""}),o==null||o({wifi_name:u.wifi_name||"",wifi_password:u.wifi_password||""}),window.showToast&&window.showToast("WiFi credentials extracted!","success")):window.showToast&&window.showToast("No WiFi credentials found in image","warning")}catch(v){console.error("[WifiPhotoExtractor] Error:",v),i(t.WIFI_PHOTO,v.message),window.showToast&&window.showToast(v.message,"error")}finally{a(t.WIFI_PHOTO,!1)}}},[f,a,i,n,o,t]),L=v=>{switch(v){case"high":return"#22c55e";case"medium":return"#eab308";case"low":return"#ef4444";default:return"#6b7280"}};return e.jsxs("div",{className:"ai-tools-wifi",children:[e.jsxs("div",{className:"ai-tools-wifi__header",children:[e.jsxs("h3",{className:"ai-tools-wifi__title",children:[e.jsx(ne,{}),"WiFi Photo Extractor"]}),e.jsx("p",{className:"ai-tools-wifi__description",children:"Upload a photo of your router label, WiFi card, or any image showing your network credentials."})]}),e.jsx("input",{ref:p,type:"file",accept:le.join(","),onChange:A,className:"ai-tools-wifi__input",style:{display:"none"}}),c?e.jsxs("div",{className:"ai-tools-wifi__preview-container",children:[e.jsxs("div",{className:"ai-tools-wifi__preview",children:[e.jsx("img",{src:c,alt:"WiFi credential preview"}),e.jsx("button",{type:"button",className:"ai-tools-wifi__clear-btn",onClick:x,"aria-label":"Clear image",children:e.jsx(He,{})})]}),b&&e.jsxs("div",{className:"ai-tools-wifi__results",children:[e.jsxs("div",{className:"ai-tools-wifi__results-header",children:[e.jsx("h4",{children:"Extracted Credentials"}),e.jsxs("span",{className:"ai-tools-wifi__confidence-badge",style:{backgroundColor:L(b.confidence)},children:[b.confidence," confidence"]})]}),e.jsxs("div",{className:"ai-tools-wifi__credential",children:[e.jsx("span",{className:"ai-tools-wifi__credential-label",children:"Network:"}),e.jsx("span",{className:"ai-tools-wifi__credential-value",children:b.wifi_name||"Not found"})]}),e.jsxs("div",{className:"ai-tools-wifi__credential",children:[e.jsx("span",{className:"ai-tools-wifi__credential-label",children:"Password:"}),e.jsx("span",{className:"ai-tools-wifi__credential-value",children:b.wifi_password||"Not found"})]}),b.notes&&e.jsx("p",{className:"ai-tools-wifi__notes",children:b.notes})]})]}):e.jsxs("div",{className:`ai-tools-wifi__dropzone ${j?"ai-tools-wifi__dropzone--dragging":""}`,onClick:()=>{var v;return(v=p.current)==null?void 0:v.click()},onDragOver:O,onDragLeave:S,onDrop:h,children:[e.jsx(Se,{}),e.jsxs("p",{className:"ai-tools-wifi__dropzone-text",children:[e.jsx("strong",{children:"Click to upload"})," or drag and drop"]}),e.jsxs("p",{className:"ai-tools-wifi__dropzone-hint",children:["JPG, PNG, GIF, or WebP up to ",K,"MB"]})]}),k&&e.jsx("div",{className:"ai-tools-wifi__error",children:k}),c&&!b&&e.jsx("button",{type:"button",className:"ai-tools-wifi__submit",onClick:_,disabled:l,children:l?e.jsxs(e.Fragment,{children:[e.jsx(Le,{}),"Extracting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ne,{}),"Extract WiFi Credentials"]})}),b&&(b.wifi_name||b.wifi_password)&&e.jsxs("div",{className:"ai-tools-wifi__success-actions",children:[e.jsx(We,{}),e.jsx("span",{children:"Credentials added to your house manual"})]}),e.jsx("p",{className:"ai-tools-wifi__hint",children:"Tip: Make sure the WiFi name and password are clearly visible in the photo for best results."})]})}const q=()=>e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"}),e.jsx("path",{d:"M19 10v2a7 7 0 0 1-14 0v-2"}),e.jsx("line",{x1:"12",y1:"19",x2:"12",y2:"22"})]}),$e=()=>e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("rect",{x:"6",y:"6",width:"12",height:"12",rx:"2"})}),Ge=()=>e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),ze=()=>e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:[e.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),e.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]}),re=()=>e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("polyline",{points:"17 8 12 3 7 8"}),e.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),Xe=()=>e.jsx("svg",{className:"ai-tools-spinner",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"})}),Ve=()=>e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("polyline",{points:"3 6 5 6 21 6"}),e.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]}),qe=["audio/webm","audio/mp3","audio/mpeg","audio/mp4","audio/m4a","audio/wav","audio/ogg","audio/flac"],Q=25;function ce(o){const a=Math.floor(o/60),i=o%60;return`${a.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`}async function Ye(o){return new Promise((a,i)=>{const n=new FileReader;n.onload=()=>{const m=n.result.split(",")[1];a(m)},n.onerror=i,n.readAsDataURL(o)})}function Ze({onDataExtracted:o}){const{setProcessingState:a,setError:i,updateExtractedData:n,processingStates:m,errors:y,successStates:r,INPUT_METHODS:t}=U(),p=s.useRef(null),c=s.useRef([]),g=s.useRef(null),f=s.useRef(null),C=s.useRef(null),[j,I]=s.useState(!1),[b,w]=s.useState(0),[l,k]=s.useState(null),[N,A]=s.useState(null),[O,S]=s.useState(!1),[h,x]=s.useState(""),[_,L]=s.useState("record"),v=m[t.AUDIO_RECORD],T=y[t.AUDIO_RECORD];r[t.AUDIO_RECORD],s.useEffect(()=>()=>{N&&URL.revokeObjectURL(N)},[N]);const P=s.useCallback(async()=>{try{const D=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,sampleRate:16e3}});p.current=new MediaRecorder(D,{mimeType:"audio/webm"}),c.current=[],p.current.ondataavailable=F=>{F.data.size>0&&c.current.push(F.data)},p.current.onstop=()=>{const F=new Blob(c.current,{type:"audio/webm"});k(F),A(URL.createObjectURL(F)),D.getTracks().forEach(R=>R.stop())},p.current.start(100),I(!0),w(0),x(""),C.current=setInterval(()=>{w(F=>F+1)},1e3)}catch(D){console.error("[AudioRecorder] Error accessing microphone:",D),i(t.AUDIO_RECORD,"Could not access microphone. Please allow microphone permissions.")}},[i,t]),u=s.useCallback(()=>{p.current&&j&&(p.current.stop(),I(!1),C.current&&(clearInterval(C.current),C.current=null))},[j]),E=s.useCallback(D=>{var R;const F=(R=D.target.files)==null?void 0:R[0];if(F){if(!qe.some(X=>F.type.startsWith(X.split("/")[0]))){i(t.AUDIO_RECORD,"Please upload an audio file (MP3, WAV, M4A, etc.)");return}if(F.size>Q*1024*1024){i(t.AUDIO_RECORD,`Audio file must be smaller than ${Q}MB`);return}k(F),A(URL.createObjectURL(F)),x("")}},[i,t]),M=s.useCallback(()=>{g.current&&(O?g.current.pause():g.current.play(),S(!O))},[O]),B=s.useCallback(()=>{S(!1)},[]),we=s.useCallback(()=>{N&&URL.revokeObjectURL(N),k(null),A(null),S(!1),w(0),x(""),f.current&&(f.current.value="")},[N]),ve=s.useCallback(async()=>{if(l){a(t.AUDIO_RECORD,!0);try{const D=await Ye(l);let F="webm";if(l.type){const se=l.type.match(/audio\/(\w+)/);se&&(F=se[1])}const{data:R,error:X}=await W.functions.invoke("house-manual",{body:{action:"transcribe_audio",payload:{audio:D,format:F,parseAfterTranscribe:!0}}});if(X)throw new Error(X.message||"Failed to transcribe audio");if(!(R!=null&&R.success))throw new Error((R==null?void 0:R.error)||"Failed to transcribe audio");const{text:ye,parsed:V}=R.data;x(ye),V&&Object.keys(V).length>0?(n(t.AUDIO_RECORD,V),o==null||o(V),window.showToast&&window.showToast("Audio transcribed and parsed!","success")):window.showToast&&window.showToast("Audio transcribed! Review the text below.","success")}catch(D){console.error("[AudioRecorder] Error:",D),i(t.AUDIO_RECORD,D.message),window.showToast&&window.showToast(D.message,"error")}finally{a(t.AUDIO_RECORD,!1)}}},[l,a,i,n,o,t]);return e.jsxs("div",{className:"ai-tools-audio",children:[e.jsxs("div",{className:"ai-tools-audio__header",children:[e.jsxs("h3",{className:"ai-tools-audio__title",children:[e.jsx(q,{}),"Voice Recording"]}),e.jsx("p",{className:"ai-tools-audio__description",children:"Record yourself describing your house manual, or upload an existing audio file."})]}),e.jsxs("div",{className:"ai-tools-audio__mode-toggle",children:[e.jsxs("button",{type:"button",className:`ai-tools-audio__mode-btn ${_==="record"?"ai-tools-audio__mode-btn--active":""}`,onClick:()=>L("record"),children:[e.jsx(q,{}),"Record"]}),e.jsxs("button",{type:"button",className:`ai-tools-audio__mode-btn ${_==="upload"?"ai-tools-audio__mode-btn--active":""}`,onClick:()=>L("upload"),children:[e.jsx(re,{}),"Upload"]})]}),_==="record"&&!l&&e.jsxs("div",{className:"ai-tools-audio__recorder",children:[e.jsx("button",{type:"button",className:`ai-tools-audio__record-btn ${j?"ai-tools-audio__record-btn--recording":""}`,onClick:j?u:P,children:j?e.jsx($e,{}):e.jsx(q,{})}),j&&e.jsxs("div",{className:"ai-tools-audio__recording-indicator",children:[e.jsx("span",{className:"ai-tools-audio__recording-dot"}),"Recording... ",ce(b)]}),!j&&e.jsx("p",{className:"ai-tools-audio__record-hint",children:"Click to start recording"})]}),_==="upload"&&!l&&e.jsxs("div",{className:"ai-tools-audio__uploader",children:[e.jsx("input",{ref:f,type:"file",accept:"audio/*",onChange:E,style:{display:"none"}}),e.jsxs("button",{type:"button",className:"ai-tools-audio__upload-btn",onClick:()=>{var D;return(D=f.current)==null?void 0:D.click()},children:[e.jsx(re,{}),"Select Audio File"]}),e.jsxs("p",{className:"ai-tools-audio__upload-hint",children:["MP3, WAV, M4A, OGG, FLAC up to ",Q,"MB"]})]}),l&&N&&e.jsxs("div",{className:"ai-tools-audio__player",children:[e.jsx("audio",{ref:g,src:N,onEnded:B}),e.jsxs("div",{className:"ai-tools-audio__player-controls",children:[e.jsx("button",{type:"button",className:"ai-tools-audio__play-btn",onClick:M,children:O?e.jsx(ze,{}):e.jsx(Ge,{})}),e.jsx("span",{className:"ai-tools-audio__duration",children:_==="record"?ce(b):"Uploaded audio"}),e.jsx("button",{type:"button",className:"ai-tools-audio__clear-btn",onClick:we,"aria-label":"Clear recording",children:e.jsx(Ve,{})})]})]}),h&&e.jsxs("div",{className:"ai-tools-audio__transcription",children:[e.jsx("h4",{children:"Transcription:"}),e.jsx("p",{children:h})]}),T&&e.jsx("div",{className:"ai-tools-audio__error",children:T}),l&&!h&&e.jsx("button",{type:"button",className:"ai-tools-audio__submit",onClick:ve,disabled:v,children:v?e.jsxs(e.Fragment,{children:[e.jsx(Xe,{}),"Transcribing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{}),"Transcribe Audio"]})}),e.jsx("p",{className:"ai-tools-audio__hint",children:"Tip: Speak clearly about WiFi details, check-in instructions, house rules, and other important information."})]})}const z=()=>e.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),e.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),e.jsx("polyline",{points:"10 9 9 9 8 9"})]}),Je=()=>e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),e.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})]}),de=()=>e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),e.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),e.jsx("line",{x1:"10",y1:"9",x2:"8",y2:"9"})]}),ue=()=>e.jsx("svg",{className:"ai-tools-spinner",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"})}),Ke=()=>e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#22c55e",strokeWidth:"2",children:e.jsx("path",{d:"M20 6L9 17l-5-5"})}),Qe=()=>e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),he=["application/pdf","image/png","image/jpeg"],ee=20;async function es(o){return new Promise((a,i)=>{const n=new FileReader;n.onload=()=>{const m=n.result.split(",")[1];a(m)},n.onerror=i,n.readAsDataURL(o)})}function ss(o){return[/docs\.google\.com\/document\/d\//,/drive\.google\.com\/file\/d\//,/drive\.google\.com\/open\?id=/].some(i=>i.test(o))}function os({onDataExtracted:o}){var P;const{setProcessingState:a,setError:i,updateExtractedData:n,processingStates:m,errors:y,successStates:r,INPUT_METHODS:t}=U(),p=s.useRef(null),[c,g]=s.useState("file"),[f,C]=s.useState(null),[j,I]=s.useState(""),[b,w]=s.useState(!1),[l,k]=s.useState(null),N=m[t.PDF_DOC],A=y[t.PDF_DOC];r[t.PDF_DOC];const O=s.useCallback(u=>{if(!he.includes(u.type)){i(t.PDF_DOC,"Please upload a PDF or image file");return}if(u.size>ee*1024*1024){i(t.PDF_DOC,`Document must be smaller than ${ee}MB`);return}C(u),k(null)},[i,t]),S=s.useCallback(u=>{var M;const E=(M=u.target.files)==null?void 0:M[0];E&&O(E)},[O]),h=s.useCallback(u=>{u.preventDefault(),w(!0)},[]),x=s.useCallback(u=>{u.preventDefault(),w(!1)},[]),_=s.useCallback(u=>{var M;u.preventDefault(),w(!1);const E=(M=u.dataTransfer.files)==null?void 0:M[0];E&&O(E)},[O]),L=s.useCallback(()=>{C(null),k(null),p.current&&(p.current.value="")},[]),v=s.useCallback(async()=>{if(f){a(t.PDF_DOC,!0);try{const u=await es(f),{data:E,error:M}=await W.functions.invoke("house-manual",{body:{action:"parse_document",payload:{document:u,fileName:f.name,mimeType:f.type}}});if(M)throw new Error(M.message||"Failed to process document");if(!(E!=null&&E.success))throw new Error((E==null?void 0:E.error)||"Failed to parse document");const B=E.data;k(B),n(t.PDF_DOC,B),o==null||o(B),window.showToast&&window.showToast("Document parsed successfully!","success")}catch(u){console.error("[PdfDocUploader] Error:",u),i(t.PDF_DOC,u.message),window.showToast&&window.showToast(u.message,"error")}finally{a(t.PDF_DOC,!1)}}},[f,a,i,n,o,t]),T=s.useCallback(async()=>{if(!j.trim()){i(t.PDF_DOC,"Please enter a Google Docs URL");return}if(!ss(j)){i(t.PDF_DOC,"Please enter a valid Google Docs or Google Drive URL");return}a(t.PDF_DOC,!0);try{const{data:u,error:E}=await W.functions.invoke("house-manual",{body:{action:"parse_google_doc",payload:{url:j.trim()}}});if(E)throw new Error(E.message||"Failed to fetch Google Doc");if(!(u!=null&&u.success))throw new Error((u==null?void 0:u.error)||"Failed to parse Google Doc");const M=u.data;k(M),n(t.PDF_DOC,M),o==null||o(M),window.showToast&&window.showToast("Google Doc imported successfully!","success")}catch(u){console.error("[PdfDocUploader] Error:",u),i(t.PDF_DOC,u.message),window.showToast&&window.showToast(u.message,"error")}finally{a(t.PDF_DOC,!1)}},[j,a,i,n,o,t]);return e.jsxs("div",{className:"ai-tools-pdf",children:[e.jsxs("div",{className:"ai-tools-pdf__header",children:[e.jsxs("h3",{className:"ai-tools-pdf__title",children:[e.jsx(z,{}),"Document Import"]}),e.jsx("p",{className:"ai-tools-pdf__description",children:"Upload a PDF or import from Google Docs to extract house manual content."})]}),e.jsxs("div",{className:"ai-tools-pdf__mode-toggle",children:[e.jsxs("button",{type:"button",className:`ai-tools-pdf__mode-btn ${c==="file"?"ai-tools-pdf__mode-btn--active":""}`,onClick:()=>g("file"),children:[e.jsx(z,{}),"Upload PDF"]}),e.jsxs("button",{type:"button",className:`ai-tools-pdf__mode-btn ${c==="url"?"ai-tools-pdf__mode-btn--active":""}`,onClick:()=>g("url"),children:[e.jsx(de,{}),"Google Docs"]})]}),c==="file"&&e.jsxs(e.Fragment,{children:[e.jsx("input",{ref:p,type:"file",accept:he.join(","),onChange:S,style:{display:"none"}}),f?e.jsxs("div",{className:"ai-tools-pdf__file-preview",children:[e.jsxs("div",{className:"ai-tools-pdf__file-info",children:[e.jsx(z,{}),e.jsx("span",{className:"ai-tools-pdf__file-name",children:f.name}),e.jsxs("span",{className:"ai-tools-pdf__file-size",children:["(",Math.round(f.size/1024),"KB)"]})]}),e.jsx("button",{type:"button",className:"ai-tools-pdf__clear-btn",onClick:L,"aria-label":"Clear file",children:e.jsx(Qe,{})})]}):e.jsxs("div",{className:`ai-tools-pdf__dropzone ${b?"ai-tools-pdf__dropzone--dragging":""}`,onClick:()=>{var u;return(u=p.current)==null?void 0:u.click()},onDragOver:h,onDragLeave:x,onDrop:_,children:[e.jsx(z,{}),e.jsxs("p",{className:"ai-tools-pdf__dropzone-text",children:[e.jsx("strong",{children:"Click to upload"})," or drag and drop"]}),e.jsxs("p",{className:"ai-tools-pdf__dropzone-hint",children:["PDF or image files up to ",ee,"MB"]})]}),f&&!l&&e.jsx("button",{type:"button",className:"ai-tools-pdf__submit",onClick:v,disabled:N,children:N?e.jsxs(e.Fragment,{children:[e.jsx(ue,{}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(z,{}),"Extract Content"]})})]}),c==="url"&&e.jsxs("div",{className:"ai-tools-pdf__url-input",children:[e.jsxs("div",{className:"ai-tools-pdf__url-field",children:[e.jsx(Je,{}),e.jsx("input",{type:"url",value:j,onChange:u=>I(u.target.value),placeholder:"https://docs.google.com/document/d/...",disabled:N})]}),e.jsx("p",{className:"ai-tools-pdf__url-hint",children:'Make sure the document is shared as "Anyone with the link can view"'}),e.jsx("button",{type:"button",className:"ai-tools-pdf__submit",onClick:T,disabled:N||!j.trim(),children:N?e.jsxs(e.Fragment,{children:[e.jsx(ue,{}),"Importing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(de,{}),"Import from Google Docs"]})})]}),l&&e.jsxs("div",{className:"ai-tools-pdf__preview",children:[e.jsxs("div",{className:"ai-tools-pdf__preview-header",children:[e.jsx(Ke,{}),e.jsx("span",{children:"Content extracted successfully"})]}),e.jsxs("div",{className:"ai-tools-pdf__preview-fields",children:[l.wifi_name&&e.jsxs("div",{className:"ai-tools-pdf__preview-field",children:[e.jsx("strong",{children:"WiFi:"})," ",l.wifi_name]}),l.check_in_instructions&&e.jsxs("div",{className:"ai-tools-pdf__preview-field",children:[e.jsx("strong",{children:"Check-in:"})," ",l.check_in_instructions.substring(0,100),"..."]}),((P=l.house_rules)==null?void 0:P.length)>0&&e.jsxs("div",{className:"ai-tools-pdf__preview-field",children:[e.jsx("strong",{children:"House Rules:"})," ",l.house_rules.length," rules found"]})]})]}),A&&e.jsx("div",{className:"ai-tools-pdf__error",children:A}),e.jsx("p",{className:"ai-tools-pdf__hint",children:"Tip: PDF documents work best when they have selectable text (not scanned images)."})]})}const ts=()=>e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"})}),xe=()=>e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("polyline",{points:"23 7 23 1 17 1"}),e.jsx("line",{x1:"16",y1:"8",x2:"23",y2:"1"}),e.jsx("path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"})]}),is=()=>e.jsx("svg",{className:"ai-tools-spinner",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"})}),pe=()=>e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),as=()=>e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#22c55e",strokeWidth:"2",children:[e.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]});function ns({onDataExtracted:o}){const{setProcessingState:a,setError:i,updateExtractedData:n,processingStates:m,errors:y,INPUT_METHODS:r}=U(),[t,p]=s.useState("guided"),[c,g]=s.useState(null),[f,C]=s.useState(""),j=m[r.PHONE_CALL],I=y[r.PHONE_CALL],b=s.useCallback(async()=>{a(r.PHONE_CALL,!0),g(null),C("");try{const{data:w,error:l}=await W.functions.invoke("house-manual",{body:{action:"initiate_call",payload:{callType:t}}});if(l)throw new Error(l.message||"Failed to initiate call");if(!(w!=null&&w.success))throw new Error((w==null?void 0:w.error)||"Failed to initiate call");const k=w.data;g(k.status),C(k.message),k.status==="queued"?window.showToast&&window.showToast("Call queued! You will receive a call shortly.","success"):k.status==="unavailable"&&window.showToast&&window.showToast("Phone call feature is not yet available.","info")}catch(w){console.error("[PhoneCallInterface] Error:",w),i(r.PHONE_CALL,w.message),window.showToast&&window.showToast(w.message,"error")}finally{a(r.PHONE_CALL,!1)}},[t,a,i,r]);return e.jsxs("div",{className:"ai-tools-phone",children:[e.jsxs("div",{className:"ai-tools-phone__header",children:[e.jsxs("h3",{className:"ai-tools-phone__title",children:[e.jsx(ts,{}),"AI Phone Call"]}),e.jsx("p",{className:"ai-tools-phone__description",children:"Receive an AI-powered phone call that will guide you through providing your house manual information."})]}),e.jsxs("div",{className:"ai-tools-phone__notice",children:[e.jsx(pe,{}),e.jsxs("div",{children:[e.jsx("strong",{children:"Coming Soon"}),e.jsx("p",{children:"The AI phone call feature is currently in development. In the meantime, try our voice recording feature to speak your house manual content."})]})]}),e.jsxs("div",{className:"ai-tools-phone__type-selection",children:[e.jsx("h4",{children:"Call Type:"}),e.jsxs("div",{className:"ai-tools-phone__type-options",children:[e.jsxs("label",{className:"ai-tools-phone__type-option",children:[e.jsx("input",{type:"radio",name:"callType",value:"guided",checked:t==="guided",onChange:()=>p("guided"),disabled:j}),e.jsxs("div",{className:"ai-tools-phone__type-content",children:[e.jsx("strong",{children:"Guided Call"}),e.jsx("span",{children:"AI asks specific questions about your property"})]})]}),e.jsxs("label",{className:"ai-tools-phone__type-option",children:[e.jsx("input",{type:"radio",name:"callType",value:"freeform",checked:t==="freeform",onChange:()=>p("freeform"),disabled:j}),e.jsxs("div",{className:"ai-tools-phone__type-content",children:[e.jsx("strong",{children:"Speak Freely"}),e.jsx("span",{children:"Tell us about your property in your own way"})]})]})]})]}),e.jsxs("div",{className:"ai-tools-phone__how-it-works",children:[e.jsx("h4",{children:"How it works:"}),e.jsxs("ol",{children:[e.jsx("li",{children:`Click "Start Call" and we'll call your registered phone number`}),e.jsxs("li",{children:["Our AI assistant will ",t==="guided"?"ask you questions":"listen to your description"]}),e.jsx("li",{children:"Your answers are transcribed and extracted into your house manual"}),e.jsx("li",{children:"The call typically takes 3-5 minutes"})]})]}),c&&e.jsxs("div",{className:`ai-tools-phone__status ai-tools-phone__status--${c}`,children:[c==="queued"&&e.jsx(as,{}),c==="unavailable"&&e.jsx(pe,{}),e.jsx("span",{children:f})]}),I&&e.jsx("div",{className:"ai-tools-phone__error",children:I}),e.jsx("button",{type:"button",className:"ai-tools-phone__submit",onClick:b,disabled:j||c==="queued",children:j?e.jsxs(e.Fragment,{children:[e.jsx(is,{}),"Initiating..."]}):c==="queued"?e.jsxs(e.Fragment,{children:[e.jsx(xe,{}),"Call Queued"]}):e.jsxs(e.Fragment,{children:[e.jsx(xe,{}),"Start Call"]})}),e.jsx("p",{className:"ai-tools-phone__hint",children:"Tip: Make sure your phone number is up to date in your account settings before starting a call."})]})}const ls=()=>e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),rs=()=>e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("polyline",{points:"20 6 9 17 4 12"})}),cs=()=>e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),me=()=>e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M5 12.55a11 11 0 0 1 14.08 0"}),e.jsx("path",{d:"M1.42 9a16 16 0 0 1 21.16 0"}),e.jsx("path",{d:"M8.53 16.11a6 6 0 0 1 6.95 0"}),e.jsx("line",{x1:"12",y1:"20",x2:"12.01",y2:"20"})]}),ds=()=>e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),e.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),_e=()=>e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12 6 12 12 16 14"})]}),us=()=>e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M14 16H9m10 0h3v-3.15a1 1 0 0 0-.84-.99L16 11l-2.7-3.6a1 1 0 0 0-.8-.4H5.24a2 2 0 0 0-1.8 1.1l-.8 1.63A6 6 0 0 0 2 12.42V16h2"}),e.jsx("circle",{cx:"6.5",cy:"16.5",r:"2.5"}),e.jsx("circle",{cx:"16.5",cy:"16.5",r:"2.5"})]}),hs=()=>e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"})}),xs=()=>e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("line",{x1:"8",y1:"6",x2:"21",y2:"6"}),e.jsx("line",{x1:"8",y1:"12",x2:"21",y2:"12"}),e.jsx("line",{x1:"8",y1:"18",x2:"21",y2:"18"}),e.jsx("line",{x1:"3",y1:"6",x2:"3.01",y2:"6"}),e.jsx("line",{x1:"3",y1:"12",x2:"3.01",y2:"12"}),e.jsx("line",{x1:"3",y1:"18",x2:"3.01",y2:"18"})]}),ps=()=>e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),ms=()=>e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}),e.jsx("circle",{cx:"12",cy:"10",r:"3"})]}),_s=()=>e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),e.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),Y=[{key:"wifi_name",label:"WiFi Network Name",icon:me,type:"text",placeholder:"Enter WiFi network name"},{key:"wifi_password",label:"WiFi Password",icon:me,type:"text",placeholder:"Enter WiFi password"},{key:"check_in_instructions",label:"Check-in Instructions",icon:_e,type:"textarea",placeholder:"Instructions for guest check-in"},{key:"check_out_instructions",label:"Check-out Instructions",icon:_e,type:"textarea",placeholder:"Instructions for guest check-out"},{key:"parking_info",label:"Parking Information",icon:us,type:"textarea",placeholder:"Parking details and instructions"},{key:"emergency_contacts",label:"Emergency Contacts",icon:hs,type:"textarea",placeholder:"Emergency contact information"},{key:"house_rules",label:"House Rules",icon:xs,type:"textarea",placeholder:"Rules and guidelines for guests"},{key:"appliance_instructions",label:"Appliance Instructions",icon:ps,type:"textarea",placeholder:"How to use appliances"},{key:"local_recommendations",label:"Local Recommendations",icon:ms,type:"textarea",placeholder:"Nearby restaurants, attractions, etc."},{key:"additional_notes",label:"Additional Notes",icon:_s,type:"textarea",placeholder:"Any other information for guests"}];function fs({config:o,value:a,onChange:i}){const[n,m]=s.useState(!1),[y,r]=s.useState(a||""),t=s.useCallback(()=>{r(a||""),m(!0)},[a]),p=s.useCallback(()=>{i(o.key,y),m(!1)},[o.key,y,i]),c=s.useCallback(()=>{r(a||""),m(!1)},[a]),g=o.icon,f=!a||a.trim()==="";return e.jsxs("div",{className:`house-manual-editor__field ${f?"house-manual-editor__field--empty":""}`,children:[e.jsxs("div",{className:"house-manual-editor__field-header",children:[e.jsxs("div",{className:"house-manual-editor__field-label",children:[e.jsx(g,{}),e.jsx("span",{children:o.label})]}),!n&&e.jsx("button",{type:"button",className:"house-manual-editor__field-edit-btn",onClick:t,"aria-label":`Edit ${o.label}`,children:e.jsx(ls,{})})]}),n?e.jsxs("div",{className:"house-manual-editor__field-edit",children:[o.type==="textarea"?e.jsx("textarea",{value:y,onChange:C=>r(C.target.value),placeholder:o.placeholder,rows:4,autoFocus:!0}):e.jsx("input",{type:"text",value:y,onChange:C=>r(C.target.value),placeholder:o.placeholder,autoFocus:!0}),e.jsxs("div",{className:"house-manual-editor__field-actions",children:[e.jsxs("button",{type:"button",className:"house-manual-editor__field-save",onClick:p,children:[e.jsx(rs,{}),"Save"]}),e.jsxs("button",{type:"button",className:"house-manual-editor__field-cancel",onClick:c,children:[e.jsx(cs,{}),"Cancel"]})]})]}):e.jsx("div",{className:"house-manual-editor__field-value",children:f?e.jsx("span",{className:"house-manual-editor__field-placeholder",children:o.placeholder}):e.jsx("span",{children:a})})]})}function js({onSave:o,className:a=""}){const{extractedData:i,updateExtractedData:n,hasExtractedContent:m}=U(),y=s.useCallback((c,g)=>{n(d.FREEFORM_TEXT,{...i[d.FREEFORM_TEXT],[c]:g})},[i,n]),r=Object.values(i).reduce((c,g)=>g?{...c,...g}:c,{}),t=s.useCallback(()=>{o&&o(r)},[r,o]),p=Y.filter(c=>r[c.key]&&r[c.key].trim()!=="").length;return e.jsxs("div",{className:`house-manual-editor ${a}`,children:[e.jsxs("div",{className:"house-manual-editor__header",children:[e.jsxs("div",{className:"house-manual-editor__header-info",children:[e.jsx(ds,{}),e.jsx("h3",{children:"House Manual Content"})]}),e.jsxs("div",{className:"house-manual-editor__progress",children:[e.jsxs("span",{className:"house-manual-editor__progress-text",children:[p," of ",Y.length," fields filled"]}),e.jsx("div",{className:"house-manual-editor__progress-bar",children:e.jsx("div",{className:"house-manual-editor__progress-fill",style:{width:`${p/Y.length*100}%`}})})]})]}),!m&&e.jsx("div",{className:"house-manual-editor__empty-notice",children:e.jsx("p",{children:"Use one of the input methods above to extract or enter your house manual content."})}),e.jsx("div",{className:"house-manual-editor__fields",children:Y.map(c=>e.jsx(fs,{config:c,value:r[c.key],onChange:y},c.key))}),m&&e.jsx("div",{className:"house-manual-editor__actions",children:e.jsx("button",{type:"button",className:"house-manual-editor__save-btn",onClick:t,children:"Save House Manual"})})]})}const H={LOADING:"loading",AUTHENTICATED:"authenticated",UNAUTHENTICATED:"unauthenticated"};function gs(){const[o,a]=s.useState(H.LOADING),[i,n]=s.useState(null),[m,y]=s.useState([]),[r,t]=s.useState(null),[p,c]=s.useState(!1),[g,f]=s.useState(null),[C,j]=s.useState(!1),[I,b]=s.useState(!1),[w,l]=s.useState(null),k=s.useMemo(()=>m.find(h=>h.id===r)||null,[m,r]),N=o===H.LOADING||p;s.useEffect(()=>{(async()=>{try{const{data:{session:_}}=await W.auth.getSession();_!=null&&_.user?(n(_.user),a(H.AUTHENTICATED)):a(H.UNAUTHENTICATED)}catch(_){console.error("[useHouseManualPageLogic] Auth check failed:",_),a(H.UNAUTHENTICATED)}})();const{data:{subscription:x}}=W.auth.onAuthStateChange((_,L)=>{L!=null&&L.user?(n(L.user),a(H.AUTHENTICATED)):(n(null),a(H.UNAUTHENTICATED))});return()=>x==null?void 0:x.unsubscribe()},[]),s.useEffect(()=>{o===H.UNAUTHENTICATED&&(window.location.href="/?login=true")},[o]),s.useEffect(()=>{if(o!==H.AUTHENTICATED||!i)return;(async()=>{c(!0),l(null);try{const{data:x,error:_}=await W.from("listing").select("id, title, main_photo_url, created_at").eq("host_user_id",i.id).order("created_at",{ascending:!1});if(_)throw _;y(x||[]),x&&x.length>0&&!r&&t(x[0].id)}catch(x){console.error("[useHouseManualPageLogic] Failed to fetch listings:",x),l("Failed to load your listings. Please try again.")}finally{c(!1)}})()},[o,i,r]),s.useEffect(()=>{if(!r)return;(async()=>{j(!0);try{const{data:x,error:_}=await W.from("house_manual").select("*").eq("listing_id",r).single();if(_&&_.code!=="PGRST116")throw _;f(x||null)}catch(x){console.error("[useHouseManualPageLogic] Failed to fetch house manual:",x)}finally{j(!1)}})()},[r]);const A=s.useCallback(h=>{t(h),f(null)},[]),O=s.useCallback(async h=>{if(!r||!i){window.showToast&&window.showToast("Please select a listing first","error");return}b(!0),l(null);try{const x={listing_id:r,user_id:i.id,wifi_name:h.wifi_name||null,wifi_password:h.wifi_password||null,check_in_instructions:h.check_in_instructions||null,check_out_instructions:h.check_out_instructions||null,parking_info:h.parking_info||null,emergency_contacts:h.emergency_contacts||null,house_rules:h.house_rules||null,appliance_instructions:h.appliance_instructions||null,local_recommendations:h.local_recommendations||null,additional_notes:h.additional_notes||null,updated_at:new Date().toISOString()},{error:_}=await W.from("house_manual").upsert(x,{onConflict:"listing_id"});if(_)throw _;f(x),window.showToast&&window.showToast("House manual saved successfully!","success")}catch(x){console.error("[useHouseManualPageLogic] Failed to save house manual:",x),l("Failed to save house manual. Please try again."),window.showToast&&window.showToast("Failed to save house manual","error")}finally{b(!1)}},[r,i]),S=s.useCallback(h=>{console.log("[useHouseManualPageLogic] Data extracted:",h)},[]);return{authState:o,user:i,isAuthenticated:o===H.AUTHENTICATED,listings:m,selectedListingId:r,selectedListing:k,handleListingChange:A,existingManual:g,isLoadingManual:C,isSaving:I,handleSave:O,handleDataExtracted:S,isLoading:N,error:w}}function fe(){return e.jsxs("div",{className:"house-manual__loading",children:[e.jsx("div",{className:"house-manual__spinner"}),e.jsx("p",{children:"Loading..."})]})}function ws({error:o}){return e.jsxs("div",{className:"house-manual__error",children:[e.jsx("p",{children:o}),e.jsx("button",{onClick:()=>window.location.reload(),children:"Try Again"})]})}function vs(){return e.jsxs("div",{className:"house-manual__empty",children:[e.jsx("div",{className:"house-manual__empty-icon",children:e.jsxs("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[e.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),e.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]})}),e.jsx("h2",{children:"No Listings Found"}),e.jsx("p",{children:"You need to create a listing before adding a house manual."}),e.jsx("a",{href:"/self-listing",className:"house-manual__cta-btn",children:"Create Your First Listing"})]})}function ys({listings:o,selectedId:a,onChange:i,disabled:n}){return o.length===1?e.jsxs("div",{className:"house-manual__listing-info",children:[e.jsx("img",{src:o[0].main_photo_url||"/assets/images/placeholder-listing.jpg",alt:o[0].title,className:"house-manual__listing-thumb"}),e.jsx("span",{className:"house-manual__listing-title",children:o[0].title})]}):e.jsxs("div",{className:"house-manual__listing-selector",children:[e.jsx("label",{htmlFor:"listing-select",children:"Select Listing:"}),e.jsx("select",{id:"listing-select",value:a||"",onChange:m=>i(m.target.value),disabled:n,children:o.map(m=>e.jsx("option",{value:m.id,children:m.title},m.id))})]})}function Cs({onDataExtracted:o}){const{activeMethod:a}=U();switch(a){case d.FREEFORM_TEXT:return e.jsx(ae,{onDataExtracted:o});case d.WIFI_PHOTO:return e.jsx(Be,{onDataExtracted:o});case d.AUDIO_RECORDING:return e.jsx(Ze,{onDataExtracted:o});case d.PDF_DOC:return e.jsx(os,{onDataExtracted:o});case d.PHONE_CALL:return e.jsx(ns,{onDataExtracted:o});default:return e.jsx(ae,{onDataExtracted:o})}}function bs(){const{isAuthenticated:o,listings:a,selectedListingId:i,selectedListing:n,handleListingChange:m,isSaving:y,handleSave:r,handleDataExtracted:t,isLoading:p,error:c}=gs();return s.useEffect(()=>(document.body.classList.add("house-manual-page"),()=>{document.body.classList.remove("house-manual-page")}),[]),p?e.jsxs(e.Fragment,{children:[e.jsx($,{}),e.jsx("main",{className:"house-manual",children:e.jsx("div",{className:"house-manual__container",children:e.jsx(fe,{})})}),e.jsx(G,{})]}):c?e.jsxs(e.Fragment,{children:[e.jsx($,{}),e.jsx("main",{className:"house-manual",children:e.jsx("div",{className:"house-manual__container",children:e.jsx(ws,{error:c})})}),e.jsx(G,{})]}):o?a.length===0?e.jsxs(e.Fragment,{children:[e.jsx($,{}),e.jsx("main",{className:"house-manual",children:e.jsx("div",{className:"house-manual__container",children:e.jsx(vs,{})})}),e.jsx(G,{})]}):e.jsxs(e.Fragment,{children:[e.jsx($,{}),e.jsx("main",{className:"house-manual",children:e.jsxs("div",{className:"house-manual__container",children:[e.jsxs("div",{className:"house-manual__header",children:[e.jsx("h1",{className:"house-manual__title",children:"House Manual"}),e.jsx("p",{className:"house-manual__subtitle",children:"Create a comprehensive guide for your guests with AI-powered tools"})]}),e.jsxs("div",{className:"house-manual__listing-section",children:[e.jsx(ys,{listings:a,selectedId:i,onChange:m,disabled:y}),n&&e.jsx("a",{href:`/listing-dashboard?id=${i}`,className:"house-manual__listing-link",children:"View Listing Dashboard "})]}),e.jsxs("div",{className:"house-manual__ai-tools",children:[e.jsxs("div",{className:"house-manual__section-header",children:[e.jsx("h2",{children:"Add Content"}),e.jsx("p",{children:"Choose your preferred method to add information to your house manual"})]}),e.jsx(De,{}),e.jsx("div",{className:"house-manual__input-area",children:e.jsx(Cs,{onDataExtracted:t})})]}),e.jsx("div",{className:"house-manual__editor-section",children:e.jsx(js,{onSave:r})}),y&&e.jsxs("div",{className:"house-manual__saving-overlay",children:[e.jsx("div",{className:"house-manual__spinner"}),e.jsx("p",{children:"Saving..."})]})]})}),e.jsx(G,{})]}):e.jsxs(e.Fragment,{children:[e.jsx($,{}),e.jsx("main",{className:"house-manual",children:e.jsx("div",{className:"house-manual__container",children:e.jsx(fe,{})})}),e.jsx(G,{})]})}function ks(){return e.jsx(Te,{children:e.jsx(bs,{})})}const je=document.getElementById("root");je&&Ce(je).render(e.jsx(be.StrictMode,{children:e.jsx(ke,{children:e.jsx(ks,{})})}));
