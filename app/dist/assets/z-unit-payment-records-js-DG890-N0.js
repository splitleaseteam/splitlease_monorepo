import{r as h,j as e,c as be}from"./client-BJVKzfAi.js";import{s as G}from"./supabase-BoCLEw6R.js";const ze=["Nightly","Weekly","Monthly"],ve=["Every week","One week on, one week off","Two weeks on, two weeks off","One week on, three weeks off"];function Se(t){const n=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0"),l=t.getFullYear();return`${n}-${a}-${l}`}function De(t){if(!t)throw new Error("moveInDate is required");let n=t;if(t.includes("/")){const l=t.split("/");if(l.length===3){const r=l[0].padStart(2,"0"),s=l[1].padStart(2,"0");let o=l[2];o.length===2&&(o="20"+o),n=`${o}-${r}-${s}`}}const a=new Date(n);if(isNaN(a.getTime()))throw new Error(`Invalid date format: ${t}`);return a}function ee(t){return Math.round(t*100)/100}function ke(t,n,a){if(t==="Monthly"){if(!a||a<=0)throw new Error("reservationSpanMonths is required for Monthly rental type");return Number.isInteger(a)?a:Math.ceil(a)}if(!n||n<=0)throw new Error("reservationSpanWeeks is required for Nightly and Weekly rental types");return Math.ceil(n/4)}function Pe(t,n){return t==="Monthly"?0:(n||0)%4}function Me(t,n,a){const l=[],r=new Date(t);r.setDate(t.getDate()-3);let s=new Date(r);for(let o=0;o<n;o++){l.push(Se(s));const m=a==="Monthly"?31:28;s.setDate(s.getDate()+m)}return l}function Re(t,n,a,l,r){if(t==="Monthly"){if(r&&!Number.isInteger(r)){const s=r-Math.floor(r);return n*s}return n}if(a===0)return n;if(t==="Nightly")return n*(a/4);switch(l){case"Every week":return n*(a/4);case"One week on, one week off":return a<=2?n*.5:n;case"Two weeks on, two weeks off":return a===1?n*.5:n;case"One week on, three weeks off":return n;default:return n}}function Ee(t,n,a,l,r,s){const o=[];for(let m=0;m<t;m++){let c=n;m===t-1&&(c=Re(a,n,l,r,s)),c=isNaN(c)?0:c,c=ee(c),o.push(c)}return o}function Le(t,n,a){return t.map((l,r)=>{let s=l+n;return r===0&&a>0&&(s+=a),ee(s)})}function Ce({rentalType:t,moveInDate:n,reservationSpanWeeks:a,reservationSpanMonths:l,weekPattern:r,fourWeekRent:s,rentPerMonth:o,maintenanceFee:m,damageDeposit:c=0}){if(!ze.includes(t))throw new Error("rentalType is required and must be one of: 'Nightly', 'Weekly', 'Monthly'");if(!ve.includes(r))throw new Error("weekPattern is required and must be one of: 'Every week', 'One week on, one week off', 'Two weeks on, two weeks off', 'One week on, three weeks off'");if((t==="Nightly"||t==="Weekly")&&(!s||s<=0))throw new Error("fourWeekRent is required for Nightly and Weekly rental types and must be a positive number");if(t==="Monthly"&&(!o||o<=0))throw new Error("rentPerMonth is required for Monthly rental type and must be a positive number");if(isNaN(m))throw new Error("maintenanceFee must be a number");const f=De(n),u=ke(t,a,l),b=Pe(t,a),w=Me(f,u,t),v=Ee(u,t==="Monthly"?o:s,t,b,r,l),S=Le(v,m,c),P=ee(S.reduce((M,I)=>M+I,0)-c);return{paymentDates:w,rentList:v,totalRentList:S,totalReservationPrice:P,numberOfPaymentCycles:u}}const Fe=["Nightly","Weekly","Monthly"],Te=["Every week","One week on, one week off","Two weeks on, two weeks off","One week on, three weeks off"];function Ie(t){const n=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0"),l=t.getFullYear();return`${n}-${a}-${l}`}function Ae(t){if(!t)throw new Error("moveInDate is required");let n=t;if(t.includes("/")){const l=t.split("/");if(l.length===3){const r=l[0].padStart(2,"0"),s=l[1].padStart(2,"0");let o=l[2];o.length===2&&(o="20"+o),n=`${o}-${r}-${s}`}}const a=new Date(n);if(isNaN(a.getTime()))throw new Error(`Invalid date format: ${t}`);return a}function te(t){return Math.round(t*100)/100}function Je(t,n,a){if(t==="Monthly"){if(!a||a<=0)throw new Error("reservationSpanMonths is required for Monthly rental type");return Number.isInteger(a)?a:Math.ceil(a)}if(!n||n<=0)throw new Error("reservationSpanWeeks is required for Nightly and Weekly rental types");return Math.ceil(n/4)}function _e(t,n){return t==="Monthly"?0:(n||0)%4}function $e(t,n,a){const l=[],r=new Date(t);r.setDate(t.getDate()+2);let s=new Date(r);for(let o=0;o<n;o++){l.push(Ie(s));const m=a==="Monthly"?31:28;s.setDate(s.getDate()+m)}return l}function Ye(t,n,a,l,r){if(t==="Monthly"){if(r&&!Number.isInteger(r)){const s=r-Math.floor(r);return n*s}return n}if(a===0)return n;if(t==="Nightly")return n*(a/4);switch(l){case"Every week":return n*(a/4);case"One week on, one week off":return a<=2?n*.5:n;case"Two weeks on, two weeks off":return a===1?n*.5:n;case"One week on, three weeks off":return n;default:return n}}function Oe(t,n,a,l,r,s){const o=[];for(let m=0;m<t;m++){let c=n;m===t-1&&(c=Ye(a,n,l,r,s)),c=isNaN(c)?0:c,c=te(c),o.push(c)}return o}function We(t,n){return t.map(a=>{const l=a+n;return te(l)})}function Ue({rentalType:t,moveInDate:n,reservationSpanWeeks:a,reservationSpanMonths:l,weekPattern:r,fourWeekRent:s,rentPerMonth:o,maintenanceFee:m}){if(!Fe.includes(t))throw new Error("rentalType is required and must be one of: 'Nightly', 'Weekly', 'Monthly'");if(!Te.includes(r))throw new Error("weekPattern is required and must be one of: 'Every week', 'One week on, one week off', 'Two weeks on, two weeks off', 'One week on, three weeks off'");if((t==="Nightly"||t==="Weekly")&&(!s||s<=0))throw new Error("fourWeekRent is required for Nightly and Weekly rental types and must be a positive number");if(t==="Monthly"&&(!o||o<=0))throw new Error("rentPerMonth is required for Monthly rental type and must be a positive number");if(isNaN(m))throw new Error("maintenanceFee must be a number");const c=Ae(n),f=Je(t,a,l),u=_e(t,a),b=$e(c,f,t),z=Oe(f,t==="Monthly"?o:s,t,u,r,l),v=We(z,m),S=te(v.reduce((P,M)=>P+M,0));return{paymentDates:b,rentList:z,totalRentList:v,totalCompensationAmount:S,numberOfPaymentCycles:f}}const Ge=["January","February","March","April","May","June","July","August","September","October","November","December"],He=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],X={jsCalculated:[],bubbleNative:[]},K={jsCalculated:[],bubbleNative:[]};function ie(t){if(Array.isArray(t))return t;if(typeof t=="string")try{return JSON.parse(t)}catch{return[]}return[]}function H(t){if(!t)return null;if(t instanceof Date)return t;const n=new Date(t);return isNaN(n.getTime())?null:n}function Ze(t){if(!t)return"-";const n=H(t);return n?n.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"-"}function Be(t){return typeof t!="number"||isNaN(t)?"$0.00":`$${t.toFixed(2)}`}function qe(){const[t,n]=h.useState([]),[a,l]=h.useState(!1),[r,s]=h.useState(null),[o,m]=h.useState(""),[c,f]=h.useState(null),[u,b]=h.useState(!1),[w,z]=h.useState(null),[v,S]=h.useState(X),[P,M]=h.useState(K),[I,Y]=h.useState(!1),[C,F]=h.useState(new Date().getFullYear()),[T,A]=h.useState(new Date().getMonth()),[Z,O]=h.useState(!1),[B,W]=h.useState(!1),[_,x]=h.useState(null),[de,J]=h.useState(null),[q,ne]=h.useState("jsCalculated");h.useEffect(()=>{(async()=>{l(!0),s(null);try{const{data:d,error:N}=await G.from("bookings_leases").select(`
            _id,
            "Agreement Number",
            "Lease Status",
            "Reservation Period : Start",
            "Reservation Period : End",
            "Total Rent",
            "Total Compensation",
            Listing,
            Proposal,
            Guest,
            Host,
            "Payment Records Guest-SL",
            "Payment Records SL-Hosts"
          `).not("Proposal","is",null).order('"Agreement Number"',{ascending:!1}).limit(100);if(N)throw N;n(d||[])}catch(d){console.error("[ZUnitPaymentRecordsJs] Failed to fetch leases:",d),s("Failed to load leases")}finally{l(!1)}})()},[]);const ae=h.useCallback(async i=>{if(!i)return z(null),null;try{const{data:d,error:N}=await G.from("proposal").select(`
          _id,
          "Days Selected",
          "Nights Selected",
          "Reservation Span (Weeks)",
          "Reservation Span (Months)",
          "rental type",
          "4 week rent",
          "Rent per Month",
          "Move in range start",
          "Move in range end",
          "Week Pattern",
          "Maintenance Fee",
          "Damage Deposit"
        `).eq("_id",i).single();if(N)throw N;return z(d),d}catch(d){return console.error("[ZUnitPaymentRecordsJs] Failed to fetch proposal:",d),z(null),null}},[]),se=h.useCallback(async(i,d)=>{const N=[],D=[];if(i&&i.length>0)try{const{data:y,error:j}=await G.from("paymentrecords").select(`
            _id,
            "Payment #",
            "Scheduled Date",
            "Date payment received",
            "ðŸ’°Rent",
            "ðŸ’°Maintenance Fee",
            "ðŸ’° Damage Deposit",
            "ðŸ’°Total",
            "Bank Transaction Number",
            "receipt_status"
          `).in("_id",i).order('"Payment #"',{ascending:!0});!j&&y&&y.forEach(p=>{N.push({paymentNumber:p["Payment #"]||0,scheduledDate:p["Scheduled Date"],actualDate:p["Date payment received"],rent:parseFloat(p["ðŸ’°Rent"])||0,maintenanceFee:parseFloat(p["ðŸ’°Maintenance Fee"])||0,damageDeposit:parseFloat(p["ðŸ’° Damage Deposit"])||0,total:parseFloat(p["ðŸ’°Total"])||0,bankTransactionNumber:p["Bank Transaction Number"]||null,receiptStatus:p.receipt_status||"pending"})})}catch(y){console.error("[ZUnitPaymentRecordsJs] Failed to fetch guest payments:",y)}if(d&&d.length>0)try{const{data:y,error:j}=await G.from("paymentrecords").select(`
            _id,
            "Payment #",
            "Scheduled Date",
            "Date payment received",
            "ðŸ’°Rent",
            "ðŸ’°Maintenance Fee",
            "ðŸ’°Total",
            "Bank Transaction Number",
            "receipt_status"
          `).in("_id",d).order('"Payment #"',{ascending:!0});!j&&y&&y.forEach(p=>{D.push({paymentNumber:p["Payment #"]||0,scheduledDate:p["Scheduled Date"],actualDate:p["Date payment received"],rent:parseFloat(p["ðŸ’°Rent"])||0,maintenanceFee:parseFloat(p["ðŸ’°Maintenance Fee"])||0,total:parseFloat(p["ðŸ’°Total"])||0,bankTransactionNumber:p["Bank Transaction Number"]||null,payoutStatus:p.receipt_status||"pending"})})}catch(y){console.error("[ZUnitPaymentRecordsJs] Failed to fetch host payments:",y)}return{guestNative:N,hostNative:D}},[]),re=h.useCallback((i,d)=>{if(!i)return{guestSchedule:[],hostSchedule:[]};const N=i["rental type"],D=i["Move in range start"],y=parseFloat(i["Reservation Span (Weeks)"])||0,j=parseFloat(i["Reservation Span (Months)"])||0,p=i["Week Pattern"]||"Every week",g=parseFloat(i["4 week rent"])||0,R=parseFloat(i["Rent per Month"])||0,E=parseFloat(i["Maintenance Fee"])||0,U=parseFloat(i["Damage Deposit"])||0;let le=[],oe=[];if(D&&N)try{const k=Ce({rentalType:N,moveInDate:D,reservationSpanWeeks:y>0?y:void 0,reservationSpanMonths:j>0?j:void 0,weekPattern:p,fourWeekRent:g>0?g:void 0,rentPerMonth:R>0?R:void 0,maintenanceFee:E,damageDeposit:U});le=k.paymentDates.map((V,L)=>({paymentNumber:L+1,scheduledDate:V,actualDate:null,rent:k.rentList[L],maintenanceFee:E,damageDeposit:L===0?U:0,total:k.totalRentList[L],bankTransactionNumber:null,receiptStatus:"pending"}))}catch(k){console.error("[ZUnitPaymentRecordsJs] Guest calculation error:",k)}if(D&&N)try{const k=Ue({rentalType:N,moveInDate:D,reservationSpanWeeks:y>0?y:void 0,reservationSpanMonths:j>0?j:void 0,weekPattern:p,fourWeekRent:g>0?g:void 0,rentPerMonth:R>0?R:void 0,maintenanceFee:E});oe=k.paymentDates.map((V,L)=>({paymentNumber:L+1,scheduledDate:V,actualDate:null,rent:k.rentList[L],maintenanceFee:E,total:k.totalRentList[L],bankTransactionNumber:null,payoutStatus:"pending"}))}catch(k){console.error("[ZUnitPaymentRecordsJs] Host calculation error:",k)}return{guestSchedule:le,hostSchedule:oe}},[]),$=h.useCallback(async i=>{if(m(i),x(null),J(null),!i){f(null),z(null),S(X),M(K);return}b(!0),Y(!0);try{const d=t.find(U=>U._id===i);if(!d)throw new Error("Lease not found");f(d);const N=H(d["Reservation Period : Start"]);N&&(F(N.getFullYear()),A(N.getMonth()));const D=await ae(d.Proposal),y=ie(d["Payment Records Guest-SL"]),j=ie(d["Payment Records SL-Hosts"]),{guestNative:p,hostNative:g}=await se(y,j),{guestSchedule:R,hostSchedule:E}=re(D,d);S({jsCalculated:R,bubbleNative:p}),M({jsCalculated:E,bubbleNative:g})}catch(d){console.error("[ZUnitPaymentRecordsJs] Failed to load lease details:",d),s("Failed to load lease details")}finally{b(!1),Y(!1)}},[t,ae,se,re]),he=h.useCallback(async()=>{if(!c||!w){x("No lease selected");return}O(!0),x(null),J(null);try{const i=await fetch("https://qcfifybkaddcoimjroca.supabase.co/functions/v1/guest-payment-records",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFjZmlmeWJrYWRkY29pbWpyb2NhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk0NzU0MDUsImV4cCI6MjA3NTA1MTQwNX0.glGwHxds0PzVLF1Y8VBGX0jYz3zrLsgE9KAWWwkYms8"},body:JSON.stringify({action:"generate",payload:{leaseId:c._id,proposalId:w._id}})}),d=await i.json();if(!i.ok||!d.success)throw new Error(d.error||"Failed to regenerate guest payments");J("Guest payment records regenerated successfully"),await $(o)}catch(i){console.error("[ZUnitPaymentRecordsJs] Failed to regenerate guest payments:",i),x(i.message||"Failed to regenerate guest payments")}finally{O(!1)}},[c,w,o,$]),me=h.useCallback(async()=>{if(!c||!w){x("No lease selected");return}W(!0),x(null),J(null);try{const i=await fetch("https://qcfifybkaddcoimjroca.supabase.co/functions/v1/host-payment-records",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFjZmlmeWJrYWRkY29pbWpyb2NhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk0NzU0MDUsImV4cCI6MjA3NTA1MTQwNX0.glGwHxds0PzVLF1Y8VBGX0jYz3zrLsgE9KAWWwkYms8"},body:JSON.stringify({action:"generate",payload:{leaseId:c._id,proposalId:w._id}})}),d=await i.json();if(!i.ok||!d.success)throw new Error(d.error||"Failed to regenerate host payments");J("Host payment records regenerated successfully"),await $(o)}catch(i){console.error("[ZUnitPaymentRecordsJs] Failed to regenerate host payments:",i),x(i.message||"Failed to regenerate host payments")}finally{W(!1)}},[c,w,o,$]),pe=h.useCallback(()=>{A(i=>i===11?(F(d=>d+1),0):i+1)},[]),fe=h.useCallback(()=>{A(i=>i===0?(F(d=>d-1),11):i-1)},[]),ye=h.useCallback(i=>{F(parseInt(i))},[]),Ne=h.useCallback(i=>{ne(i)},[]),ge=h.useCallback(()=>{m(""),f(null),z(null),S(X),M(K),F(new Date().getFullYear()),A(new Date().getMonth()),x(null),J(null),ne("jsCalculated")},[]),je=h.useMemo(()=>{const i=new Date(C,T,1),d=new Date(C,T+1,0),N=i.getDay(),D=d.getDate(),y=[];for(let g=0;g<N;g++)y.push({day:null,isBooked:!1,isPaymentDay:!1});const j=H(c==null?void 0:c["Reservation Period : Start"]),p=H(c==null?void 0:c["Reservation Period : End"]);for(let g=1;g<=D;g++){const R=new Date(C,T,g);let E=!1;j&&p&&(E=R>=j&&R<=p),y.push({day:g,date:R,isBooked:E,isPaymentDay:!1})}return y},[C,T,c]),we=q==="jsCalculated"?v.jsCalculated:v.bubbleNative,xe=q==="jsCalculated"?P.jsCalculated:P.bubbleNative;return{MONTH_NAMES:Ge,DAY_NAMES:He,leases:t,leasesLoading:a,leasesError:r,selectedLeaseId:o,selectedLease:c,selectedLeaseLoading:u,proposalData:w,guestPaymentSchedule:v,hostPaymentSchedule:P,activeGuestSchedule:we,activeHostSchedule:xe,paymentSchedulesLoading:I,calendarYear:C,calendarMonth:T,calendarDays:je,regeneratingGuest:Z,regeneratingHost:B,regenerationError:_,regenerationSuccess:de,viewMode:q,handleLeaseSelect:$,handleRegenerateGuestPayments:he,handleRegenerateHostPayments:me,handleCalendarMonthNext:pe,handleCalendarMonthPrev:fe,handleCalendarYearChange:ye,handleViewModeChange:Ne,handleReset:ge,formatDisplayDate:Ze,formatCurrency:Be}}function Q(){return e.jsxs("div",{className:"zupr-loading",children:[e.jsx("div",{className:"zupr-spinner"}),e.jsx("span",{children:"Loading..."})]})}function ue({message:t}){return e.jsx("div",{className:"zupr-error",children:t})}function Ve({message:t}){return e.jsx("div",{className:"zupr-success",children:t})}function Xe({leases:t,leasesLoading:n,leasesError:a,selectedLeaseId:l,selectedLease:r,proposalData:s,handleLeaseSelect:o,handleReset:m,formatDisplayDate:c,formatCurrency:f}){return e.jsxs("div",{className:"zupr-panel",children:[e.jsx("h2",{className:"zupr-panel-header",children:"Lease Selector"}),e.jsxs("div",{className:"zupr-form-group",children:[e.jsx("label",{className:"zupr-label",children:"Select Lease"}),n?e.jsx(Q,{}):a?e.jsx(ue,{message:a}):e.jsxs("select",{className:"zupr-select",value:l,onChange:u=>o(u.target.value),children:[e.jsx("option",{value:"",children:"-- Select a lease --"}),t.map(u=>e.jsxs("option",{value:u._id,children:[u["Agreement Number"]||u._id," - ",u["Lease Status"]||"Unknown"]},u._id))]})]}),r&&e.jsxs("div",{className:"zupr-lease-info",children:[e.jsx("h3",{className:"zupr-panel-subheader",children:"Lease Details"}),e.jsxs("div",{className:"zupr-info-grid",children:[e.jsxs("div",{className:"zupr-info-row",children:[e.jsx("span",{className:"zupr-info-label",children:"Agreement #:"}),e.jsx("span",{className:"zupr-info-value",children:r["Agreement Number"]||"-"})]}),e.jsxs("div",{className:"zupr-info-row",children:[e.jsx("span",{className:"zupr-info-label",children:"Status:"}),e.jsx("span",{className:"zupr-info-value",children:r["Lease Status"]||"-"})]}),e.jsxs("div",{className:"zupr-info-row",children:[e.jsx("span",{className:"zupr-info-label",children:"Start Date:"}),e.jsx("span",{className:"zupr-info-value",children:c(r["Reservation Period : Start"])})]}),e.jsxs("div",{className:"zupr-info-row",children:[e.jsx("span",{className:"zupr-info-label",children:"End Date:"}),e.jsx("span",{className:"zupr-info-value",children:c(r["Reservation Period : End"])})]}),e.jsxs("div",{className:"zupr-info-row",children:[e.jsx("span",{className:"zupr-info-label",children:"Total Rent:"}),e.jsx("span",{className:"zupr-info-value",children:f(r["Total Rent"])})]}),e.jsxs("div",{className:"zupr-info-row",children:[e.jsx("span",{className:"zupr-info-label",children:"Total Compensation:"}),e.jsx("span",{className:"zupr-info-value",children:f(r["Total Compensation"])})]})]}),s&&e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"zupr-panel-subheader",children:"Proposal Details"}),e.jsxs("div",{className:"zupr-info-grid",children:[e.jsxs("div",{className:"zupr-info-row",children:[e.jsx("span",{className:"zupr-info-label",children:"Rental Type:"}),e.jsx("span",{className:"zupr-info-value",children:s["rental type"]||"-"})]}),e.jsxs("div",{className:"zupr-info-row",children:[e.jsx("span",{className:"zupr-info-label",children:"Week Pattern:"}),e.jsx("span",{className:"zupr-info-value",children:s["Week Pattern"]||"-"})]}),e.jsxs("div",{className:"zupr-info-row",children:[e.jsx("span",{className:"zupr-info-label",children:"Span (Weeks):"}),e.jsx("span",{className:"zupr-info-value",children:s["Reservation Span (Weeks)"]||"-"})]}),e.jsxs("div",{className:"zupr-info-row",children:[e.jsx("span",{className:"zupr-info-label",children:"Span (Months):"}),e.jsx("span",{className:"zupr-info-value",children:s["Reservation Span (Months)"]||"-"})]}),e.jsxs("div",{className:"zupr-info-row",children:[e.jsx("span",{className:"zupr-info-label",children:"4-Week Rent:"}),e.jsx("span",{className:"zupr-info-value",children:f(s["4 week rent"])})]}),e.jsxs("div",{className:"zupr-info-row",children:[e.jsx("span",{className:"zupr-info-label",children:"Rent/Month:"}),e.jsx("span",{className:"zupr-info-value",children:f(s["Rent per Month"])})]}),e.jsxs("div",{className:"zupr-info-row",children:[e.jsx("span",{className:"zupr-info-label",children:"Maintenance Fee:"}),e.jsx("span",{className:"zupr-info-value",children:f(s["Maintenance Fee"])})]}),e.jsxs("div",{className:"zupr-info-row",children:[e.jsx("span",{className:"zupr-info-label",children:"Damage Deposit:"}),e.jsx("span",{className:"zupr-info-value",children:f(s["Damage Deposit"])})]})]})]})]}),e.jsx("button",{type:"button",className:"zupr-btn zupr-btn-secondary",onClick:m,style:{width:"100%",marginTop:"16px"},children:"Reset All"})]})}function ce({title:t,records:n,isGuest:a=!0,formatDisplayDate:l,formatCurrency:r}){return!n||n.length===0?e.jsxs("div",{className:"zupr-table-empty",children:["No ",a?"guest":"host"," payment records available"]}):e.jsx("div",{className:"zupr-table-container",children:e.jsxs("table",{className:"zupr-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Scheduled Date"}),e.jsx("th",{children:"Actual Date"}),e.jsx("th",{children:"Rent"}),e.jsx("th",{children:"Maint. Fee"}),a&&e.jsx("th",{children:"Damage Dep."}),e.jsx("th",{children:"Total"}),e.jsx("th",{children:"Bank Txn #"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:n.map((s,o)=>e.jsxs("tr",{children:[e.jsx("td",{children:s.paymentNumber}),e.jsx("td",{children:l(s.scheduledDate)}),e.jsx("td",{children:l(s.actualDate)}),e.jsx("td",{children:r(s.rent)}),e.jsx("td",{children:r(s.maintenanceFee)}),a&&e.jsx("td",{children:r(s.damageDeposit)}),e.jsx("td",{className:"zupr-table-total",children:r(s.total)}),e.jsx("td",{children:s.bankTransactionNumber||"-"}),e.jsx("td",{children:e.jsx("span",{className:`zupr-status zupr-status-${(s.receiptStatus||s.payoutStatus||"pending").toLowerCase()}`,children:s.receiptStatus||s.payoutStatus||"pending"})})]},o))})]})})}function Ke({viewMode:t,handleViewModeChange:n}){return e.jsxs("div",{className:"zupr-view-toggle",children:[e.jsx("button",{type:"button",className:`zupr-toggle-btn ${t==="jsCalculated"?"active":""}`,onClick:()=>n("jsCalculated"),children:"JS Calculated"}),e.jsx("button",{type:"button",className:`zupr-toggle-btn ${t==="bubbleNative"?"active":""}`,onClick:()=>n("bubbleNative"),children:"Bubble Native"})]})}function Qe({calendarYear:t,calendarMonth:n,calendarDays:a,MONTH_NAMES:l,DAY_NAMES:r,handleCalendarMonthPrev:s,handleCalendarMonthNext:o,handleCalendarYearChange:m}){const c=new Date().getFullYear(),f=[];for(let u=c-5;u<=c+5;u++)f.push(u);return e.jsxs("div",{className:"zupr-calendar",children:[e.jsxs("div",{className:"zupr-calendar-nav",children:[e.jsx("button",{type:"button",className:"zupr-btn zupr-btn-icon",onClick:s,children:"<"}),e.jsxs("div",{className:"zupr-calendar-title",children:[e.jsx("span",{children:l[n]}),e.jsx("select",{className:"zupr-select-small",value:t,onChange:u=>m(u.target.value),children:f.map(u=>e.jsx("option",{value:u,children:u},u))})]}),e.jsx("button",{type:"button",className:"zupr-btn zupr-btn-icon",onClick:o,children:">"})]}),e.jsx("div",{className:"zupr-calendar-header",children:r.map(u=>e.jsx("div",{className:"zupr-calendar-day-name",children:u},u))}),e.jsx("div",{className:"zupr-calendar-grid",children:a.map((u,b)=>e.jsx("div",{className:`zupr-calendar-day ${u.day?"":"empty"} ${u.isBooked?"booked":""}`,children:u.day||""},b))}),e.jsx("div",{className:"zupr-calendar-legend",children:e.jsxs("div",{className:"zupr-legend-item",children:[e.jsx("span",{className:"zupr-legend-box booked"}),e.jsx("span",{children:"Reservation Period"})]})})]})}function et(){const{MONTH_NAMES:t,DAY_NAMES:n,leases:a,leasesLoading:l,leasesError:r,selectedLeaseId:s,selectedLease:o,selectedLeaseLoading:m,proposalData:c,activeGuestSchedule:f,activeHostSchedule:u,paymentSchedulesLoading:b,calendarYear:w,calendarMonth:z,calendarDays:v,regeneratingGuest:S,regeneratingHost:P,regenerationError:M,regenerationSuccess:I,viewMode:Y,handleLeaseSelect:C,handleRegenerateGuestPayments:F,handleRegenerateHostPayments:T,handleCalendarMonthNext:A,handleCalendarMonthPrev:Z,handleCalendarYearChange:O,handleViewModeChange:B,handleReset:W,formatDisplayDate:_,formatCurrency:x}=qe();return e.jsxs("div",{className:"zupr-page",children:[e.jsxs("header",{className:"zupr-header",children:[e.jsx("h1",{children:"Z-Unit Payment Records JS Test"}),e.jsx("p",{children:"Payment schedule management and JavaScript vs. Bubble comparison"})]}),e.jsxs("div",{className:"zupr-container",children:[e.jsx("div",{className:"zupr-column zupr-column-selector",children:e.jsx(Xe,{leases:a,leasesLoading:l,leasesError:r,selectedLeaseId:s,selectedLease:o,proposalData:c,handleLeaseSelect:C,handleReset:W,formatDisplayDate:_,formatCurrency:x})}),e.jsxs("div",{className:"zupr-column zupr-column-payments",children:[e.jsx("div",{className:"zupr-panel zupr-panel-compact",children:e.jsxs("div",{className:"zupr-panel-header-row",children:[e.jsx("h2",{className:"zupr-panel-header-inline",children:"Payment Schedules"}),e.jsx(Ke,{viewMode:Y,handleViewModeChange:B})]})}),e.jsxs("div",{className:"zupr-panel",children:[e.jsxs("div",{className:"zupr-panel-header-row",children:[e.jsx("h2",{className:"zupr-panel-header-inline",children:"Guest Payment Schedule"}),e.jsx("button",{type:"button",className:"zupr-btn zupr-btn-primary zupr-btn-small",onClick:F,disabled:!o||S,children:S?"Regenerating...":"Regenerate"})]}),m||b?e.jsx(Q,{}):e.jsx(ce,{title:"Guest Payments",records:f,isGuest:!0,formatDisplayDate:_,formatCurrency:x})]}),e.jsxs("div",{className:"zupr-panel",children:[e.jsxs("div",{className:"zupr-panel-header-row",children:[e.jsx("h2",{className:"zupr-panel-header-inline",children:"Host Payout Schedule"}),e.jsx("button",{type:"button",className:"zupr-btn zupr-btn-primary zupr-btn-small",onClick:T,disabled:!o||P,children:P?"Regenerating...":"Regenerate"})]}),m||b?e.jsx(Q,{}):e.jsx(ce,{title:"Host Payouts",records:u,isGuest:!1,formatDisplayDate:_,formatCurrency:x})]}),M&&e.jsx(ue,{message:M}),I&&e.jsx(Ve,{message:I})]}),e.jsxs("div",{className:"zupr-column zupr-column-calendar",children:[e.jsxs("div",{className:"zupr-panel",children:[e.jsx("h2",{className:"zupr-panel-header",children:"Reservation Calendar"}),e.jsx(Qe,{calendarYear:w,calendarMonth:z,calendarDays:v,MONTH_NAMES:t,DAY_NAMES:n,handleCalendarMonthPrev:Z,handleCalendarMonthNext:A,handleCalendarYearChange:O})]}),o&&e.jsxs("div",{className:"zupr-panel",children:[e.jsx("h2",{className:"zupr-panel-header",children:"Comparison Summary"}),e.jsxs("div",{className:"zupr-comparison-summary",children:[e.jsxs("div",{className:"zupr-comparison-row",children:[e.jsx("span",{className:"zupr-comparison-label",children:"JS Guest Payments:"}),e.jsxs("span",{className:"zupr-comparison-value",children:[(f==null?void 0:f.length)||0," records"]})]}),e.jsxs("div",{className:"zupr-comparison-row",children:[e.jsx("span",{className:"zupr-comparison-label",children:"JS Host Payouts:"}),e.jsxs("span",{className:"zupr-comparison-value",children:[(u==null?void 0:u.length)||0," records"]})]})]})]})]})]})]})}const tt=be(document.getElementById("root"));tt.render(e.jsx(et,{}));
