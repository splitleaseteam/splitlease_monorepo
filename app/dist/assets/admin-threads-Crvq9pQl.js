import{r as l,j as e,c as ie,R as ne}from"./client-BJVKzfAi.js";import{s as le}from"./supabase-BoCLEw6R.js";import{u as re,a as de}from"./Toast-BQk6Nzgd.js";import{M as A,A as P}from"./AdminHeader-tCInZd3n.js";import{S as oe}from"./search-CwPLSYgc.js";import{X as B}from"./x-CrJVeoCh.js";import{f as O}from"./format-AibE8BX3.js";import{C as ce}from"./calendar-CDI4qHEX.js";import{F as me}from"./file-text-Bqp_Hw0X.js";import{C as he}from"./chevron-up-BHVOGcSe.js";import{C as _e}from"./star-OtPMgcH9.js";import{U as R}from"./user-C2rhnql4.js";import{M as z}from"./mail-CRbL90NL.js";import{P as w}from"./phone-JQItnCAU.js";import{B as ue}from"./bell-xU0WfKlw.js";import{T as pe}from"./trash-2-DKO8yvV5.js";import{T as H}from"./triangle-alert-Bp6DQQmR.js";import{S as ge}from"./send-C4mziT0-.js";import{E as xe}from"./ErrorBoundary-9_HbXv1y.js";/* empty css             */import"./config-QPKPRtag.js";import"./auth-QZ4BJadW.js";import"./createLucideIcon-CgZZH2OU.js";import"./users-d0RSvnp4.js";import"./pen-line-Duo49k9O.js";import"./user-check-CoCGzn5Y.js";import"./dollar-sign-Dn2-KjNW.js";const U="https://qcfifybkaddcoimjroca.supabase.co",F=20;function je(s,a,c){if(s["is Split Bot"]){const h=s["is Visible to Host"],n=s["is Visible to Guest"];return h&&!n?"bot-to-host":n&&!h?"bot-to-guest":"bot-to-both"}const r=s["-Originator User"];return r===a?"host":r===c?"guest":"unknown"}function fe(s){var a,c;return{id:s._id,subject:s["Thread Subject"]||"No Subject",createdDate:s["Created Date"],modifiedDate:s["Modified Date"],lastMessageDate:s["~Date Last Message"],callToAction:s["Call to Action"],proposalId:s.Proposal,listingId:s.Listing,maskedEmail:s["Masked Email"],fromLoggedOutUser:s["from logged out user?"],host:s.hostUser?{id:s.hostUser._id,name:s.hostUser["Name - Full"]||"Unknown Host",email:s.hostUser.email,phone:s.hostUser["Phone Number (as text)"],photo:s.hostUser["Profile Photo"]}:null,guest:s.guestUser?{id:s.guestUser._id,name:s.guestUser["Name - Full"]||"Unknown Guest",email:s.guestUser.email,phone:s.guestUser["Phone Number (as text)"],photo:s.guestUser["Profile Photo"]}:null,messages:((a=s.threadMessages)==null?void 0:a.map(o=>Ne(o,s)))||[],messageCount:((c=s.threadMessages)==null?void 0:c.length)||0}}function Ne(s,a){const c=a["-Host User"],o=a["-Guest User"];return{id:s._id,body:s["Message Body"]||"",createdDate:s["Created Date"],senderType:je(s,c,o),isSplitBot:s["is Split Bot"]||!1,isVisibleToHost:s["is Visible to Host"]??!0,isVisibleToGuest:s["is Visible to Guest"]??!0,isDeleted:s["is deleted (is hidden)"]||!1,callToAction:s["Call to Action"],notLoggedInName:s["Not Logged In Name"],notLoggedInEmail:s["Not Logged In Email"]}}function be(){const{showToast:s}=re(),[a,c]=l.useState(""),[o,r]=l.useState([]),[h,n]=l.useState(!0),[j,x]=l.useState(null),[_,v]=l.useState({guestEmail:"",hostEmail:"",threadId:"",proposalId:""}),[f,N]=l.useState(1),[C,y]=l.useState(null),[D,b]=l.useState(null),[m,k]=l.useState(null),[E,p]=l.useState(!1);l.useEffect(()=>{(async()=>{try{const{data:{session:i}}=await le.auth.getSession(),d=localStorage.getItem("sl_auth_token")||sessionStorage.getItem("sl_auth_token");c((i==null?void 0:i.access_token)||d||"")}catch(i){console.error("[AdminThreads] Token lookup failed:",i),c("")}})()},[]);const S=l.useCallback(()=>{const t={"Content-Type":"application/json"};return a&&(t.Authorization=`Bearer ${a}`),t},[a]),M=l.useCallback(async()=>{n(!0),x(null);try{const t=await fetch(`${U}/functions/v1/messages`,{method:"POST",headers:S(),body:JSON.stringify({action:"admin_get_all_threads",payload:{limit:500,includeMessages:!0}})}),i=await t.json();if(!t.ok||!i.success)throw new Error(i.error||"Failed to fetch threads");const d=(i.data||[]).map(fe);r(d)}catch(t){console.error("[AdminThreads] Fetch error:",t),x(t.message),s({title:"Failed to load threads",type:"error"})}finally{n(!1)}},[S]);l.useEffect(()=>{M()},[M]);const G=l.useMemo(()=>Object.values(_).some(t=>t.trim()!==""),[_]),L=l.useMemo(()=>{let t=o;if(_.guestEmail){const i=_.guestEmail.toLowerCase();t=t.filter(d=>{var u,g,T;return((g=(u=d.guest)==null?void 0:u.email)==null?void 0:g.toLowerCase().includes(i))||((T=d.maskedEmail)==null?void 0:T.toLowerCase().includes(i))})}if(_.hostEmail){const i=_.hostEmail.toLowerCase();t=t.filter(d=>{var u,g;return(g=(u=d.host)==null?void 0:u.email)==null?void 0:g.toLowerCase().includes(i)})}if(_.threadId){const i=_.threadId.toLowerCase();t=t.filter(d=>{var u;return(u=d.id)==null?void 0:u.toLowerCase().includes(i)})}if(_.proposalId){const i=_.proposalId.toLowerCase();t=t.filter(d=>{var u;return(u=d.proposalId)==null?void 0:u.toLowerCase().includes(i)})}return t.sort((i,d)=>{const u=new Date(i.lastMessageDate||i.modifiedDate||0);return new Date(d.lastMessageDate||d.modifiedDate||0)-u})},[o,_]),V=Math.ceil(L.length/F),$=l.useMemo(()=>{const t=(f-1)*F;return L.slice(t,t+F)},[L,f]);l.useEffect(()=>{N(1)},[_]);const K=l.useMemo(()=>{const t=new Date,i=new Date(t-24*60*60*1e3);return{total:o.length,withMessages:o.filter(d=>d.messageCount>0).length,recentActivity:o.filter(d=>new Date(d.lastMessageDate||d.modifiedDate||0)>i).length}},[o]),J=l.useCallback((t,i)=>{v(d=>({...d,[t]:i}))},[]),q=l.useCallback(()=>{v({guestEmail:"",hostEmail:"",threadId:"",proposalId:""})},[]),W=l.useCallback(()=>{N(1)},[]),X=l.useCallback(t=>{y(i=>i===t?null:t)},[]),Z=l.useCallback(t=>{y(i=>i===t.id?null:t.id)},[]),Q=l.useCallback(t=>{b({isOpen:!0,title:"Delete Thread",message:"Are you sure you want to delete this thread? This will soft-delete the thread and all its messages. The data will be recoverable.",confirmLabel:"Delete Thread",confirmType:"danger",onConfirm:async()=>{try{n(!0);const i=await fetch(`${U}/functions/v1/messages`,{method:"POST",headers:S(),body:JSON.stringify({action:"admin_delete_thread",payload:{threadId:t.id}})}),d=await i.json();if(!i.ok||!d.success)throw new Error(d.error||"Failed to delete thread");r(u=>u.filter(g=>g.id!==t.id)),s({title:"Thread deleted",type:"success"}),b(null)}catch(i){console.error("[AdminThreads] Delete error:",i),s({title:i.message||"Failed to delete thread",type:"error"})}finally{n(!1)}}})},[S]),Y=l.useCallback(()=>{b(null)},[]),ee=l.useCallback(t=>{k({isOpen:!0,thread:t})},[]),se=l.useCallback(()=>{k(null)},[]),ae=l.useCallback(async t=>{const{threadId:i,recipientType:d,method:u}=t;p(!0);try{const g=await fetch(`${U}/functions/v1/messages`,{method:"POST",headers:S(),body:JSON.stringify({action:"admin_send_reminder",payload:{threadId:i,recipientType:d,method:u}})}),T=await g.json();if(!g.ok||!T.success)throw new Error(T.error||"Failed to send reminder");s({title:`Reminder sent to ${d}`,type:"success"}),k(null)}catch(g){console.error("[AdminThreads] Reminder error:",g),s({title:g.message||"Failed to send reminder",type:"error"})}finally{p(!1)}},[S]),te=l.useCallback(()=>{M()},[M]);return{threads:o,filteredThreads:$,stats:K,isLoading:h,error:j,filters:_,hasActiveFilters:G,handleFilterChange:J,handleClearFilters:q,handleSearch:W,page:f,setPage:N,totalPages:V,expandedThreadId:C,handleToggleExpand:X,handleViewMessages:Z,handleDeleteThread:Q,handleOpenReminderModal:ee,handleSendReminder:ae,isSendingReminder:E,confirmDialog:D,handleCloseConfirmDialog:Y,reminderModal:m,handleCloseReminderModal:se,handleRetry:te}}function ve({filters:s,onFilterChange:a,onClearFilters:c,onSearch:o}){const r=Object.values(s).some(n=>n.trim()!==""),h=n=>{n.key==="Enter"&&o()};return e.jsxs("div",{className:"admin-threads__filters",children:[e.jsxs("div",{className:"admin-threads__filter-row",children:[e.jsxs("div",{className:"admin-threads__filter-group",children:[e.jsx("label",{className:"admin-threads__filter-label",children:"Guest Email"}),e.jsx("input",{type:"text",className:"admin-threads__filter-input",placeholder:"Search guest email...",value:s.guestEmail,onChange:n=>a("guestEmail",n.target.value),onKeyDown:h})]}),e.jsxs("div",{className:"admin-threads__filter-group",children:[e.jsx("label",{className:"admin-threads__filter-label",children:"Host Email"}),e.jsx("input",{type:"text",className:"admin-threads__filter-input",placeholder:"Search host email...",value:s.hostEmail,onChange:n=>a("hostEmail",n.target.value),onKeyDown:h})]}),e.jsxs("div",{className:"admin-threads__filter-group",children:[e.jsx("label",{className:"admin-threads__filter-label",children:"Thread ID"}),e.jsx("input",{type:"text",className:"admin-threads__filter-input",placeholder:"Search thread ID...",value:s.threadId,onChange:n=>a("threadId",n.target.value),onKeyDown:h})]}),e.jsxs("div",{className:"admin-threads__filter-group",children:[e.jsx("label",{className:"admin-threads__filter-label",children:"Proposal ID"}),e.jsx("input",{type:"text",className:"admin-threads__filter-input",placeholder:"Search proposal ID...",value:s.proposalId,onChange:n=>a("proposalId",n.target.value),onKeyDown:h})]})]}),e.jsxs("div",{className:"admin-threads__filter-actions",children:[e.jsxs("button",{className:"admin-threads__filter-btn admin-threads__filter-btn--search",onClick:o,children:[e.jsx(oe,{size:16}),"Search"]}),r&&e.jsxs("button",{className:"admin-threads__filter-btn admin-threads__filter-btn--clear",onClick:c,children:[e.jsx(B,{size:16}),"Clear Filters"]})]})]})}function ye({children:s}){return e.jsx("div",{className:"admin-threads__list",children:s})}function I({title:s,messages:a,variant:c}){const o=r=>{if(!r)return"";try{return O(new Date(r),"MMM d, h:mm a")}catch{return""}};return e.jsxs("div",{className:`message-column message-column--${c}`,children:[e.jsxs("h4",{className:"message-column__title",children:[s,e.jsxs("span",{className:"message-column__count",children:["(",a.length,")"]})]}),e.jsx("div",{className:"message-column__messages",children:a.length===0?e.jsx("p",{className:"message-column__empty",children:"No messages"}):a.map(r=>e.jsxs("div",{className:`message-column__message ${r.isDeleted?"message-column__message--deleted":""}`,children:[e.jsxs("div",{className:"message-column__message-header",children:[e.jsx("span",{className:"message-column__message-date",children:o(r.createdDate)}),r.isDeleted&&e.jsx("span",{className:"message-column__message-deleted-badge",children:"Deleted"})]}),e.jsx("p",{className:"message-column__message-body",children:r.body||e.jsx("em",{children:"Empty message"})}),r.notLoggedInName&&e.jsxs("p",{className:"message-column__message-sender",children:["From: ",r.notLoggedInName," (",r.notLoggedInEmail,")"]}),r.callToAction&&e.jsxs("p",{className:"message-column__message-cta",children:["CTA: ",r.callToAction]})]},r.id))})]})}function Ce({thread:s,onDelete:a,onSendReminder:c,onViewMessages:o,expandedThreadId:r,onToggleExpand:h}){var _,v,f,N,C,y,D,b;const n=r===s.id,j=m=>{if(!m)return"N/A";try{return O(new Date(m),"MMM d, yyyy h:mm a")}catch{return"Invalid date"}},x={host:s.messages.filter(m=>m.senderType==="host"),guest:s.messages.filter(m=>m.senderType==="guest"),botToHost:s.messages.filter(m=>m.senderType==="bot-to-host"),botToGuest:s.messages.filter(m=>m.senderType==="bot-to-guest"),botToBoth:s.messages.filter(m=>m.senderType==="bot-to-both")};return e.jsxs("div",{className:`thread-card ${n?"thread-card--expanded":""}`,children:[e.jsxs("div",{className:"thread-card__header",onClick:()=>h(s.id),children:[e.jsxs("div",{className:"thread-card__header-left",children:[e.jsx("h3",{className:"thread-card__subject",children:s.subject}),e.jsxs("div",{className:"thread-card__meta",children:[e.jsxs("span",{className:"thread-card__meta-item",children:[e.jsx(A,{size:14}),s.messageCount," messages"]}),e.jsxs("span",{className:"thread-card__meta-item",children:[e.jsx(ce,{size:14}),j(s.lastMessageDate||s.modifiedDate)]}),s.proposalId&&e.jsxs("span",{className:"thread-card__meta-item",children:[e.jsx(me,{size:14}),s.proposalId.slice(0,8),"..."]})]})]}),e.jsx("div",{className:"thread-card__header-right",children:e.jsx("button",{className:"thread-card__expand-btn","aria-label":n?"Collapse":"Expand",children:n?e.jsx(he,{size:20}):e.jsx(_e,{size:20})})})]}),e.jsxs("div",{className:"thread-card__participants",children:[e.jsxs("div",{className:"thread-card__participant",children:[e.jsx("div",{className:"thread-card__participant-avatar",children:(_=s.host)!=null&&_.photo?e.jsx("img",{src:s.host.photo,alt:s.host.name}):e.jsx(R,{size:20})}),e.jsxs("div",{className:"thread-card__participant-info",children:[e.jsx("span",{className:"thread-card__participant-role",children:"Host"}),e.jsx("span",{className:"thread-card__participant-name",children:((v=s.host)==null?void 0:v.name)||"Unknown"}),((f=s.host)==null?void 0:f.email)&&e.jsxs("span",{className:"thread-card__participant-email",children:[e.jsx(z,{size:12}),s.host.email]}),((N=s.host)==null?void 0:N.phone)&&e.jsxs("span",{className:"thread-card__participant-phone",children:[e.jsx(w,{size:12}),s.host.phone]})]})]}),e.jsxs("div",{className:"thread-card__participant",children:[e.jsx("div",{className:"thread-card__participant-avatar",children:(C=s.guest)!=null&&C.photo?e.jsx("img",{src:s.guest.photo,alt:s.guest.name}):e.jsx(R,{size:20})}),e.jsxs("div",{className:"thread-card__participant-info",children:[e.jsx("span",{className:"thread-card__participant-role",children:"Guest"}),e.jsx("span",{className:"thread-card__participant-name",children:((y=s.guest)==null?void 0:y.name)||s.maskedEmail||"Unknown"}),((D=s.guest)==null?void 0:D.email)&&e.jsxs("span",{className:"thread-card__participant-email",children:[e.jsx(z,{size:12}),s.guest.email]}),((b=s.guest)==null?void 0:b.phone)&&e.jsxs("span",{className:"thread-card__participant-phone",children:[e.jsx(w,{size:12}),s.guest.phone]})]})]}),e.jsxs("div",{className:"thread-card__actions",children:[e.jsxs("button",{className:"thread-card__action-btn thread-card__action-btn--reminder",onClick:m=>{m.stopPropagation(),c(s)},title:"Send reminder",children:[e.jsx(ue,{size:16}),"Remind"]}),e.jsxs("button",{className:"thread-card__action-btn thread-card__action-btn--delete",onClick:m=>{m.stopPropagation(),a(s)},title:"Delete thread",children:[e.jsx(pe,{size:16}),"Delete"]})]})]}),n&&e.jsxs("div",{className:"thread-card__messages",children:[e.jsxs("div",{className:"thread-card__messages-grid",children:[e.jsx(I,{title:"Host Messages",messages:x.host,variant:"host"}),e.jsx(I,{title:"Guest Messages",messages:x.guest,variant:"guest"}),e.jsx(I,{title:"Bot → Host",messages:x.botToHost,variant:"bot"}),e.jsx(I,{title:"Bot → Guest",messages:x.botToGuest,variant:"bot"}),x.botToBoth.length>0&&e.jsx(I,{title:"Bot → Both",messages:x.botToBoth,variant:"bot"})]}),s.messageCount===0&&e.jsxs("div",{className:"thread-card__no-messages",children:[e.jsx(A,{size:24}),e.jsx("p",{children:"No messages in this thread"})]}),e.jsxs("div",{className:"thread-card__details",children:[e.jsxs("div",{className:"thread-card__detail",children:[e.jsx("span",{className:"thread-card__detail-label",children:"Thread ID:"}),e.jsx("code",{className:"thread-card__detail-value",children:s.id})]}),s.proposalId&&e.jsxs("div",{className:"thread-card__detail",children:[e.jsx("span",{className:"thread-card__detail-label",children:"Proposal ID:"}),e.jsx("code",{className:"thread-card__detail-value",children:s.proposalId})]}),s.listingId&&e.jsxs("div",{className:"thread-card__detail",children:[e.jsx("span",{className:"thread-card__detail-label",children:"Listing ID:"}),e.jsx("code",{className:"thread-card__detail-value",children:s.listingId})]}),e.jsxs("div",{className:"thread-card__detail",children:[e.jsx("span",{className:"thread-card__detail-label",children:"Created:"}),e.jsx("span",{className:"thread-card__detail-value",children:j(s.createdDate)})]})]})]})]})}function De({message:s="Loading..."}){return e.jsxs("div",{className:"admin-threads__loading",children:[e.jsx("div",{className:"admin-threads__loading-spinner"}),e.jsx("p",{className:"admin-threads__loading-message",children:s})]})}function ke({title:s,message:a,onClearFilters:c}){return e.jsxs("div",{className:"admin-threads__empty",children:[e.jsx(A,{size:48,className:"admin-threads__empty-icon"}),e.jsx("h3",{className:"admin-threads__empty-title",children:s}),e.jsx("p",{className:"admin-threads__empty-message",children:a}),c&&e.jsx("button",{className:"admin-threads__empty-btn",onClick:c,children:"Clear Filters"})]})}function Se({message:s,onRetry:a}){return e.jsxs("div",{className:"admin-threads__error",children:[e.jsx(H,{size:48,className:"admin-threads__error-icon"}),e.jsx("h3",{className:"admin-threads__error-title",children:"Something went wrong"}),e.jsx("p",{className:"admin-threads__error-message",children:s}),a&&e.jsx("button",{className:"admin-threads__error-btn",onClick:a,children:"Try Again"})]})}function Te({isOpen:s,title:a,message:c,confirmLabel:o,confirmType:r="danger",onConfirm:h,onCancel:n}){return s?e.jsx("div",{className:"confirm-dialog__overlay",onClick:n,children:e.jsxs("div",{className:"confirm-dialog",onClick:j=>j.stopPropagation(),children:[e.jsxs("div",{className:"confirm-dialog__header",children:[e.jsx(H,{size:24,className:`confirm-dialog__icon confirm-dialog__icon--${r}`}),e.jsx("h3",{className:"confirm-dialog__title",children:a}),e.jsx("button",{className:"confirm-dialog__close",onClick:n,"aria-label":"Close",children:e.jsx(B,{size:20})})]}),e.jsx("div",{className:"confirm-dialog__body",children:e.jsx("p",{className:"confirm-dialog__message",children:c})}),e.jsxs("div",{className:"confirm-dialog__footer",children:[e.jsx("button",{className:"confirm-dialog__btn confirm-dialog__btn--cancel",onClick:n,children:"Cancel"}),e.jsx("button",{className:`confirm-dialog__btn confirm-dialog__btn--${r}`,onClick:h,children:o})]})]})}):null}function Ie({isOpen:s,thread:a,onSend:c,onClose:o,isSending:r}){var N,C,y,D,b,m,k,E;const[h,n]=l.useState("both"),[j,x]=l.useState("email");if(!s||!a)return null;const _=()=>{c({threadId:a.id,recipientType:h,method:j})},v=((N=a.host)==null?void 0:N.email)||((C=a.host)==null?void 0:C.phone),f=((y=a.guest)==null?void 0:y.email)||((D=a.guest)==null?void 0:D.phone);return e.jsx("div",{className:"reminder-modal__overlay",onClick:o,children:e.jsxs("div",{className:"reminder-modal",onClick:p=>p.stopPropagation(),children:[e.jsxs("div",{className:"reminder-modal__header",children:[e.jsx("h3",{className:"reminder-modal__title",children:"Send Reminder"}),e.jsx("button",{className:"reminder-modal__close",onClick:o,"aria-label":"Close",children:e.jsx(B,{size:20})})]}),e.jsxs("div",{className:"reminder-modal__body",children:[e.jsxs("div",{className:"reminder-modal__thread-info",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Thread:"})," ",a.subject]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Host:"})," ",((b=a.host)==null?void 0:b.name)||"Unknown"," (",((m=a.host)==null?void 0:m.email)||"No email",")"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Guest:"})," ",((k=a.guest)==null?void 0:k.name)||a.maskedEmail||"Unknown"," (",((E=a.guest)==null?void 0:E.email)||"No email",")"]})]}),e.jsxs("div",{className:"reminder-modal__field",children:[e.jsx("label",{className:"reminder-modal__label",children:"Send to:"}),e.jsxs("div",{className:"reminder-modal__options",children:[e.jsxs("label",{className:"reminder-modal__option",children:[e.jsx("input",{type:"radio",name:"recipient",value:"host",checked:h==="host",onChange:p=>n(p.target.value),disabled:!v}),e.jsx("span",{children:"Host only"})]}),e.jsxs("label",{className:"reminder-modal__option",children:[e.jsx("input",{type:"radio",name:"recipient",value:"guest",checked:h==="guest",onChange:p=>n(p.target.value),disabled:!f}),e.jsx("span",{children:"Guest only"})]}),e.jsxs("label",{className:"reminder-modal__option",children:[e.jsx("input",{type:"radio",name:"recipient",value:"both",checked:h==="both",onChange:p=>n(p.target.value),disabled:!v||!f}),e.jsx("span",{children:"Both"})]})]})]}),e.jsxs("div",{className:"reminder-modal__field",children:[e.jsx("label",{className:"reminder-modal__label",children:"Method:"}),e.jsxs("div",{className:"reminder-modal__options",children:[e.jsxs("label",{className:"reminder-modal__option",children:[e.jsx("input",{type:"radio",name:"method",value:"email",checked:j==="email",onChange:p=>x(p.target.value)}),e.jsx(z,{size:16}),e.jsx("span",{children:"Email"})]}),e.jsxs("label",{className:"reminder-modal__option",children:[e.jsx("input",{type:"radio",name:"method",value:"sms",checked:j==="sms",onChange:p=>x(p.target.value)}),e.jsx(A,{size:16}),e.jsx("span",{children:"SMS"})]}),e.jsxs("label",{className:"reminder-modal__option",children:[e.jsx("input",{type:"radio",name:"method",value:"both",checked:j==="both",onChange:p=>x(p.target.value)}),e.jsx("span",{children:"Both"})]})]})]})]}),e.jsxs("div",{className:"reminder-modal__footer",children:[e.jsx("button",{className:"reminder-modal__btn reminder-modal__btn--cancel",onClick:o,disabled:r,children:"Cancel"}),e.jsx("button",{className:"reminder-modal__btn reminder-modal__btn--send",onClick:_,disabled:r,children:r?e.jsx(e.Fragment,{children:"Sending..."}):e.jsxs(e.Fragment,{children:[e.jsx(ge,{size:16}),"Send Reminder"]})})]})]})})}function Ee(){const s=be();return s.isLoading&&!s.threads.length?e.jsxs("div",{className:"admin-threads",children:[e.jsx(P,{}),e.jsx(De,{message:"Loading threads..."})]}):s.error&&!s.threads.length?e.jsxs("div",{className:"admin-threads",children:[e.jsx(P,{}),e.jsx(Se,{message:s.error,onRetry:s.handleRetry})]}):e.jsxs("div",{className:"admin-threads",children:[e.jsx(P,{}),e.jsxs("div",{className:"admin-threads__stats",children:[e.jsxs("div",{className:"admin-threads__stat",children:[e.jsx("span",{className:"admin-threads__stat-value",children:s.stats.total}),e.jsx("span",{className:"admin-threads__stat-label",children:"Total Threads"})]}),e.jsxs("div",{className:"admin-threads__stat",children:[e.jsx("span",{className:"admin-threads__stat-value",children:s.stats.withMessages}),e.jsx("span",{className:"admin-threads__stat-label",children:"With Messages"})]}),e.jsxs("div",{className:"admin-threads__stat",children:[e.jsx("span",{className:"admin-threads__stat-value",children:s.stats.recentActivity}),e.jsx("span",{className:"admin-threads__stat-label",children:"Active (24h)"})]})]}),e.jsx(ve,{filters:s.filters,onFilterChange:s.handleFilterChange,onClearFilters:s.handleClearFilters,onSearch:s.handleSearch}),s.filteredThreads.length===0?e.jsx(ke,{title:s.hasActiveFilters?"No matching threads":"No threads found",message:s.hasActiveFilters?"Try adjusting your filters or search terms":"Threads will appear here once users start messaging",onClearFilters:s.hasActiveFilters?s.handleClearFilters:null}):e.jsx(ye,{children:s.filteredThreads.map(a=>e.jsx(Ce,{thread:a,onDelete:s.handleDeleteThread,onSendReminder:s.handleOpenReminderModal,onViewMessages:s.handleViewMessages,expandedThreadId:s.expandedThreadId,onToggleExpand:s.handleToggleExpand},a.id))}),s.totalPages>1&&e.jsxs("div",{className:"admin-threads__pagination",children:[e.jsx("button",{className:"admin-threads__pagination-btn",onClick:()=>s.setPage(s.page-1),disabled:s.page===1,children:"Previous"}),e.jsxs("span",{className:"admin-threads__pagination-info",children:["Page ",s.page," of ",s.totalPages]}),e.jsx("button",{className:"admin-threads__pagination-btn",onClick:()=>s.setPage(s.page+1),disabled:s.page===s.totalPages,children:"Next"})]}),s.confirmDialog&&e.jsx(Te,{isOpen:s.confirmDialog.isOpen,title:s.confirmDialog.title,message:s.confirmDialog.message,confirmLabel:s.confirmDialog.confirmLabel,confirmType:s.confirmDialog.confirmType,onConfirm:s.confirmDialog.onConfirm,onCancel:s.handleCloseConfirmDialog}),s.reminderModal&&e.jsx(Ie,{isOpen:s.reminderModal.isOpen,thread:s.reminderModal.thread,onSend:s.handleSendReminder,onClose:s.handleCloseReminderModal,isSending:s.isSendingReminder}),s.isLoading&&s.threads.length>0&&e.jsx("div",{className:"admin-threads__loading-overlay",children:e.jsx("div",{className:"admin-threads__loading-spinner"})})]})}ie(document.getElementById("root")).render(e.jsx(ne.StrictMode,{children:e.jsx(xe,{children:e.jsx(de,{children:e.jsx(Ee,{})})})}));
