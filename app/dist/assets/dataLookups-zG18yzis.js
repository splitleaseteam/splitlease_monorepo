import{s as i}from"./supabase-BoCLEw6R.js";import{d as t}from"./constants-CPVJY5eo.js";const n={neighborhoods:new Map,boroughs:new Map,propertyTypes:new Map,amenities:new Map,safety:new Map,houseRules:new Map,parking:new Map,cancellationPolicies:new Map,storage:new Map,guestCancellationReasons:new Map,hostCancellationReasons:new Map,initialized:!1},s={"Entire Place":"Entire Place","Private Room":"Private Room","Shared Room":"Shared Room",Studio:"Studio","1 Bedroom":"1 Bedroom","2 Bedroom":"2 Bedroom","3+ Bedroom":"3+ Bedroom"};async function z(){if(!n.initialized)try{await Promise.all([l(),c(),u(),f(),h(),y(),p(),d(),g(),m()]),n.initialized=!0,console.log("Data lookups initialized successfully")}catch(e){console.error("Failed to initialize data lookups:",e)}}async function l(){try{const{data:e,error:o}=await i.schema("reference_table").from(t.TABLES.BOROUGH).select('_id, "Display Borough"');if(o)throw o;e&&Array.isArray(e)&&(e.forEach(r=>{const a=r["Display Borough"]||"Unknown Borough";n.boroughs.set(r._id,a.trim())}),console.log(`Cached ${n.boroughs.size} boroughs`))}catch(e){console.error("Failed to initialize borough lookups:",e)}}async function c(){try{const{data:e,error:o}=await i.schema("reference_table").from(t.TABLES.NEIGHBORHOOD).select("_id, Display");if(o)throw o;e&&Array.isArray(e)&&(e.forEach(r=>{const a=r.Display||"Unknown Neighborhood";n.neighborhoods.set(r._id,a.trim())}),console.log(`Cached ${n.neighborhoods.size} neighborhoods`))}catch(e){console.error("Failed to initialize neighborhood lookups:",e)}}async function u(){try{const{data:e,error:o}=await i.schema("reference_table").from(t.TABLES.LISTING_TYPE).select('_id, "Label "').limit(100);!o&&e&&Array.isArray(e)?(e.forEach(r=>{const a=r["Label "];a&&n.propertyTypes.set(r._id,a.trim())}),console.log(`Cached ${n.propertyTypes.size} property types from database`)):(Object.entries(s).forEach(([r,a])=>{n.propertyTypes.set(r,a)}),console.log("Using static property type mappings"))}catch(e){console.error("Failed to initialize property type lookups:",e),Object.entries(s).forEach(([o,r])=>{n.propertyTypes.set(o,r)})}}async function f(){try{const{data:e,error:o}=await i.from(t.TABLES.AMENITY).select("_id, Name, Icon");if(o)throw o;e&&Array.isArray(e)&&(e.forEach(r=>{n.amenities.set(r._id,{name:r.Name||"Unknown Amenity",icon:r.Icon||""})}),console.log(`Cached ${n.amenities.size} amenities`))}catch(e){console.error("Failed to initialize amenity lookups:",e)}}async function h(){try{const{data:e,error:o}=await i.from(t.TABLES.SAFETY).select("_id, Name, Icon");if(o)throw o;e&&Array.isArray(e)&&(e.forEach(r=>{n.safety.set(r._id,{name:r.Name||"Unknown Safety Feature",icon:r.Icon||""})}),console.log(`Cached ${n.safety.size} safety features`))}catch(e){console.error("Failed to initialize safety lookups:",e)}}async function y(){try{const{data:e,error:o}=await i.schema("reference_table").from(t.TABLES.HOUSE_RULE).select("_id, Name, Icon");if(o)throw o;e&&Array.isArray(e)&&(e.forEach(r=>{n.houseRules.set(r._id,{name:r.Name||"Unknown Rule",icon:r.Icon||""})}),console.log(`Cached ${n.houseRules.size} house rules`))}catch(e){console.error("Failed to initialize house rule lookups:",e)}}async function p(){try{const{data:e,error:o}=await i.schema("reference_table").from(t.TABLES.PARKING).select("_id, Label");if(o)throw o;e&&Array.isArray(e)&&(e.forEach(r=>{n.parking.set(r._id,{label:r.Label||"Unknown Parking"})}),console.log(`Cached ${n.parking.size} parking options`))}catch(e){console.error("Failed to initialize parking lookups:",e)}}async function d(){try{const{data:e,error:o}=await i.schema("reference_table").from(t.TABLES.CANCELLATION_POLICY).select('_id, Display, "Best Case Text", "Medium Case Text", "Worst Case Text", "Summary Texts"');if(o)throw o;e&&Array.isArray(e)&&(e.forEach(r=>{n.cancellationPolicies.set(r._id,{display:r.Display||"Unknown Policy",bestCaseText:r["Best Case Text"]||null,mediumCaseText:r["Medium Case Text"]||null,worstCaseText:r["Worst Case Text"]||null,summaryTexts:r["Summary Texts"]||null})}),console.log(`Cached ${n.cancellationPolicies.size} cancellation policies`))}catch(e){console.error("Failed to initialize cancellation policy lookups:",e)}}async function g(){try{const{data:e,error:o}=await i.schema("reference_table").from(t.TABLES.STORAGE).select('_id, Title, "Summary - Guest"');if(o)throw o;e&&Array.isArray(e)&&(e.forEach(r=>{n.storage.set(r._id,{title:r.Title||"Unknown Storage",summaryGuest:r["Summary - Guest"]||""})}),console.log(`Cached ${n.storage.size} storage options`))}catch(e){console.error("Failed to initialize storage lookups:",e)}}async function m(){try{const{data:e,error:o}=await i.schema("reference_table").from(t.TABLES.CANCELLATION_REASON).select("id, user_type, reason, display_order").eq("is_active",!0).order("display_order",{ascending:!0});if(o)throw o;e&&Array.isArray(e)&&(e.forEach(r=>{const a={id:r.id,reason:r.reason,displayOrder:r.display_order};r.user_type==="guest"?n.guestCancellationReasons.set(r.id,a):r.user_type==="host"&&n.hostCancellationReasons.set(r.id,a)}),console.log(`Cached ${n.guestCancellationReasons.size} guest cancellation reasons`),console.log(`Cached ${n.hostCancellationReasons.size} host rejection reasons`))}catch(e){console.error("Failed to initialize cancellation reason lookups:",e)}}function _(e){if(!e)return"";const o=n.neighborhoods.get(e);return o||(console.warn(`Neighborhood ID not found in cache: ${e}`),e)}function T(e){if(!e)return"";const o=n.boroughs.get(e);return o||(console.warn(`Borough ID not found in cache: ${e}`),e)}function L(e){if(!e)return"Entire Place";const o=n.propertyTypes.get(e);if(o)return o;const r=s[e];return r||(typeof e=="string"&&!e.includes("x")||console.warn(`Property type not found in cache: ${e}`),e)}function A(e){if(!e)return null;const o=n.amenities.get(e);return o||(console.warn(`Amenity ID not found in cache: ${e}`),null)}function b(e){return Array.isArray(e)?e.map(o=>A(o)).filter(Boolean):[]}function w(e){if(!e)return null;const o=n.safety.get(e);return o||(console.warn(`Safety feature ID not found in cache: ${e}`),null)}function S(e){return Array.isArray(e)?e.map(o=>w(o)).filter(Boolean):[]}function k(e){if(!e)return null;const o=n.houseRules.get(e);return o||(console.warn(`House rule ID not found in cache: ${e}`),null)}function R(e){return Array.isArray(e)?e.map(o=>k(o)).filter(Boolean):[]}function B(e){if(!e)return null;const o=n.parking.get(e);return o||(console.warn(`Parking option ID not found in cache: ${e}`),null)}function P(e){if(!e)return null;const o=n.cancellationPolicies.get(e);return o||(console.warn(`Cancellation policy ID not found in cache: ${e}`),null)}function O(){const e=[];return n.cancellationPolicies.forEach((o,r)=>{e.push({id:r,display:o.display})}),e}function N(){const e=[];return n.parking.forEach((o,r)=>{e.push({id:r,label:o.label})}),e}function $(e){if(!e)return null;const o=n.storage.get(e);return o||(console.warn(`Storage option ID not found in cache: ${e}`),null)}function D(){const e=[];return n.guestCancellationReasons.forEach((o,r)=>{e.push({id:r,reason:o.reason,displayOrder:o.displayOrder})}),e.sort((o,r)=>o.displayOrder-r.displayOrder)}function F(){const e=[];return n.hostCancellationReasons.forEach((o,r)=>{e.push({id:r,reason:o.reason,displayOrder:o.displayOrder})}),e.sort((o,r)=>o.displayOrder-r.displayOrder)}function M(){return n.initialized}export{T as a,L as b,M as c,F as d,D as e,O as f,_ as g,N as h,z as i,b as j,S as k,R as l,B as m,P as n,$ as o};
