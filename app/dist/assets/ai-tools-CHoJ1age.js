import{g as Ee,j as e,r as i,c as De}from"./client-BJVKzfAi.js";import{s as V}from"./supabase-BoCLEw6R.js";import{A as Q}from"./AdminHeader-tCInZd3n.js";import"./auth-QZ4BJadW.js";import"./star-OtPMgcH9.js";import"./createLucideIcon-CgZZH2OU.js";import"./file-text-Bqp_Hw0X.js";import"./triangle-alert-Bp6DQQmR.js";import"./users-d0RSvnp4.js";import"./pen-line-Duo49k9O.js";import"./calendar-CDI4qHEX.js";import"./mail-CRbL90NL.js";import"./user-check-CoCGzn5Y.js";import"./dollar-sign-Dn2-KjNW.js";import"./send-C4mziT0-.js";import"./x-CrJVeoCh.js";var ae={exports:{}},Ae="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Te=Ae,Pe=Te;function se(){}function re(){}re.resetWarningCache=se;var Ge=function(){function t(h,m,y,u,C,n){if(n!==Pe){var j=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw j.name="Invariant Violation",j}}t.isRequired=t;function o(){return t}var d={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:o,element:t,elementType:t,instanceOf:o,node:t,objectOf:o,oneOf:o,oneOfType:o,shape:o,exact:o,checkPropTypes:re,resetWarningCache:se};return d.PropTypes=d,d};ae.exports=Ge();var Je=ae.exports;const s=Ee(Je);function te({selectedHouseManual:t="",deepfakes:o=[],deepfakeForm:d={videoId:"",voiceId:"",script:""},deepfakeStatus:h={loading:!1,error:null,message:null},onFormChange:m,onGenerateScript:y,onGenerateVideo:u,onCheckStatus:C,onAttach:n}){const j=!t;return e.jsxs("section",{className:"tool-section heygen-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsxs("h2",{className:"section-title",children:[e.jsx("span",{className:"section-icon heygen-icon",children:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("polygon",{points:"23 7 16 12 23 17 23 7"}),e.jsx("rect",{x:"1",y:"5",width:"15",height:"14",rx:"2",ry:"2"})]})}),"HeyGen Deepfake"]}),e.jsx("p",{className:"section-description",children:"Generate AI-powered welcome videos using HeyGen avatars"})]}),(h.error||h.message)&&e.jsx("div",{className:`status-message ${h.error?"error":"success"}`,children:h.error||h.message}),e.jsxs("div",{className:"section-grid heygen-grid",children:[e.jsxs("div",{className:"grid-column",children:[e.jsx("h3",{className:"column-title",children:"Configuration"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"heygen-video-id",children:"Video/Avatar ID"}),e.jsx("input",{type:"text",id:"heygen-video-id",className:"text-input",placeholder:"Enter HeyGen video ID...",value:d.videoId,onChange:l=>m("videoId",l.target.value),disabled:j}),e.jsx("span",{className:"field-hint",children:"The HeyGen avatar template ID to use"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"heygen-voice-id",children:"Voice ID"}),e.jsx("input",{type:"text",id:"heygen-voice-id",className:"text-input",placeholder:"Enter HeyGen voice ID...",value:d.voiceId,onChange:l=>m("voiceId",l.target.value),disabled:j}),e.jsx("span",{className:"field-hint",children:"The HeyGen voice to use for text-to-speech"})]})]}),e.jsxs("div",{className:"grid-column",children:[e.jsx("h3",{className:"column-title",children:"Script & Video"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"heygen-script",children:"Script"}),e.jsx("textarea",{id:"heygen-script",className:"textarea-input",placeholder:"Enter or generate a script for the welcome video...",value:d.script,onChange:l=>m("script",l.target.value),disabled:j,rows:6})]}),e.jsxs("div",{className:"button-group",children:[e.jsx("button",{className:"btn btn--secondary",onClick:y,disabled:j||h.loading,children:h.loading?"Generating...":"Generate Script"}),e.jsx("button",{className:"btn btn--primary",onClick:u,disabled:j||!d.script||h.loading,children:h.loading?"Processing...":"Generate Video"})]})]}),e.jsxs("div",{className:"grid-column",children:[e.jsx("h3",{className:"column-title",children:"Generated Videos"}),o.length===0?e.jsxs("div",{className:"empty-list",children:[e.jsx("p",{children:"No deepfake videos generated yet."}),e.jsx("p",{className:"hint",children:"Generate a script and create a video to see it here."})]}):e.jsx("div",{className:"items-list",children:o.map(l=>e.jsxs("div",{className:`item-card status-${l.status}`,children:[e.jsxs("div",{className:"item-header",children:[e.jsx("span",{className:`status-badge ${l.status}`,children:l.status}),e.jsx("span",{className:"item-date",children:new Date(l.created_at).toLocaleDateString()})]}),l.video_url&&e.jsx("div",{className:"video-preview",children:e.jsx("a",{href:l.video_url,target:"_blank",rel:"noopener noreferrer",className:"preview-link",children:"View Video"})}),l.script&&e.jsxs("p",{className:"item-script",children:[l.script.slice(0,100),"..."]}),e.jsxs("div",{className:"item-actions",children:[l.status==="processing"&&e.jsx("button",{className:"btn btn--small btn--secondary",onClick:()=>C(l),disabled:h.loading,children:"Check Status"}),l.status==="completed"&&!l.attached_to_manual&&e.jsx("button",{className:"btn btn--small btn--primary",onClick:()=>n(l.id),disabled:h.loading,children:"Attach to Manual"}),l.attached_to_manual&&e.jsx("span",{className:"attached-badge",children:"Attached"})]})]},l.id))})]})]})]})}te.propTypes={selectedHouseManual:s.string,deepfakes:s.arrayOf(s.shape({id:s.string.isRequired,status:s.string,script:s.string,video_url:s.string,attached_to_manual:s.bool,created_at:s.string})),deepfakeForm:s.shape({videoId:s.string,voiceId:s.string,script:s.string}),deepfakeStatus:s.shape({loading:s.bool,error:s.string,message:s.string}),onFormChange:s.func.isRequired,onGenerateScript:s.func.isRequired,onGenerateVideo:s.func.isRequired,onCheckStatus:s.func.isRequired,onAttach:s.func.isRequired};function ne({selectedHouseManual:t="",selectedVisit:o="",narrations:d=[],narrators:h=[],selectedNarrator:m="",narrationScript:y="",narrationStatus:u={loading:!1,error:null,message:null},onNarratorSelect:C,onScriptChange:n,onGenerateScript:j,onGenerateNarration:l,onAttach:_}){const k=!t;return e.jsxs("section",{className:"tool-section elevenlabs-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsxs("h2",{className:"section-title",children:[e.jsx("span",{className:"section-icon elevenlabs-icon",children:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"}),e.jsx("path",{d:"M19 10v2a7 7 0 0 1-14 0v-2"}),e.jsx("line",{x1:"12",y1:"19",x2:"12",y2:"23"}),e.jsx("line",{x1:"8",y1:"23",x2:"16",y2:"23"})]})}),"ElevenLabs Narration"]}),e.jsx("p",{className:"section-description",children:"Generate professional voice-over narrations for house manuals"})]}),(u.error||u.message)&&e.jsx("div",{className:`status-message ${u.error?"error":"success"}`,children:u.error||u.message}),e.jsxs("div",{className:"section-grid elevenlabs-grid",children:[e.jsxs("div",{className:"grid-column",children:[e.jsx("h3",{className:"column-title",children:"Narrator & Script"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"narrator-select",children:"Select Narrator"}),e.jsxs("select",{id:"narrator-select",className:"select-input",value:m,onChange:c=>C(c.target.value),disabled:k,children:[e.jsx("option",{value:"",children:"Choose a narrator..."}),h.map(c=>e.jsxs("option",{value:c.id,children:[c.name," - ",c.description]},c.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"narration-script",children:"Narration Script"}),e.jsx("textarea",{id:"narration-script",className:"textarea-input",placeholder:"Enter or generate a script for the narration...",value:y,onChange:c=>n(c.target.value),disabled:k,rows:8}),e.jsx("span",{className:"field-hint",children:'Tip: Include pauses with "..." and emphasis with CAPS for better narration.'})]}),e.jsxs("div",{className:"button-group",children:[e.jsx("button",{className:"btn btn--secondary",onClick:j,disabled:k||u.loading,children:u.loading?"Generating...":"Generate Script"}),e.jsx("button",{className:"btn btn--primary",onClick:l,disabled:k||!y||!m||u.loading,children:u.loading?"Processing...":"Generate Narration"})]})]}),e.jsxs("div",{className:"grid-column",children:[e.jsx("h3",{className:"column-title",children:"Generated Narrations"}),d.length===0?e.jsxs("div",{className:"empty-list",children:[e.jsx("p",{children:"No narrations generated yet."}),e.jsx("p",{className:"hint",children:"Select a narrator, generate a script, and create a narration."})]}):e.jsx("div",{className:"items-list",children:d.map(c=>e.jsxs("div",{className:"item-card",children:[e.jsxs("div",{className:"item-header",children:[e.jsx("span",{className:"narrator-name",children:c["Narrator data"]||"Unknown Narrator"}),e.jsx("span",{className:"item-date",children:new Date(c["Created Date"]).toLocaleDateString()})]}),c["Narration/Jingle Audio"]&&e.jsx("div",{className:"audio-preview",children:e.jsxs("audio",{controls:!0,className:"audio-player",children:[e.jsx("source",{src:c["Narration/Jingle Audio"],type:"audio/mpeg"}),"Your browser does not support the audio element."]})}),c["Narration/Jingle Script"]&&e.jsxs("p",{className:"item-script",children:[c["Narration/Jingle Script"].slice(0,150),"..."]}),e.jsxs("div",{className:"item-actions",children:[o&&!c.Visit&&e.jsx("button",{className:"btn btn--small btn--primary",onClick:()=>_(c._id),disabled:u.loading,children:"Attach to Visit"}),c.Visit&&e.jsx("span",{className:"attached-badge",children:"Attached to Visit"})]})]},c._id))})]})]})]})}ne.propTypes={selectedHouseManual:s.string,selectedVisit:s.string,narrations:s.arrayOf(s.shape({_id:s.string.isRequired,"Narrator data":s.string,"Narration/Jingle Audio":s.string,"Narration/Jingle Script":s.string,"Created Date":s.string,Visit:s.string})),narrators:s.arrayOf(s.shape({id:s.string.isRequired,name:s.string.isRequired,description:s.string})),selectedNarrator:s.string,narrationScript:s.string,narrationStatus:s.shape({loading:s.bool,error:s.string,message:s.string}),onNarratorSelect:s.func.isRequired,onScriptChange:s.func.isRequired,onGenerateScript:s.func.isRequired,onGenerateNarration:s.func.isRequired,onAttach:s.func.isRequired};const Re={"morning-melody":"Morning Melody","gentle-nighttime":"Gentle Nighttime","optimistic-commercial":"Optimistic Commercial","hip-hop":"Hip Hop",country:"Country",edm:"EDM",jazz:"Jazz",opera:"Opera",religious:"Religious"},Le={"host-name":"Host Name","guest-nickname":"Guest NickName","arrival-instructions":"Arrival Instructions","house-rules":"House Rules"};function ie({selectedHouseManual:t="",selectedVisit:o="",jingles:d=[],melodyPreference:h="optimistic-commercial",contentPreferences:m=["host-name","house-rules"],jingleLyrics:y="",jingleStatus:u={loading:!1,error:null,message:null},onMelodyPreferenceChange:C,onContentPreferenceToggle:n,onLyricsChange:j,onGenerateLyrics:l,onCreateJingle:_,onAttach:k}){const c=!t;return e.jsxs("section",{className:"tool-section jingle-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsxs("h2",{className:"section-title",children:[e.jsx("span",{className:"section-icon jingle-icon",children:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M9 18V5l12-2v13"}),e.jsx("circle",{cx:"6",cy:"18",r:"3"}),e.jsx("circle",{cx:"18",cy:"16",r:"3"})]})}),"Jingle Creator"]}),e.jsx("p",{className:"section-description",children:"Create custom jingles with AI-generated lyrics and melodies"})]}),(u.error||u.message)&&e.jsx("div",{className:`status-message ${u.error?"error":"success"}`,children:u.error||u.message}),e.jsxs("div",{className:"section-grid jingle-grid",children:[e.jsxs("div",{className:"grid-column",children:[e.jsx("h3",{className:"column-title",children:"Preferences"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"melody-preference",children:"Melody Style"}),e.jsx("select",{id:"melody-preference",className:"select-input",value:h,onChange:g=>C(g.target.value),disabled:c,children:Object.entries(Re).map(([g,E])=>e.jsx("option",{value:g,children:E},g))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Content to Include"}),e.jsx("div",{className:"checkbox-group",children:Object.entries(Le).map(([g,E])=>e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:m.includes(g),onChange:()=>n(g),disabled:c}),e.jsx("span",{className:"checkbox-text",children:E})]},g))})]})]}),e.jsxs("div",{className:"grid-column",children:[e.jsx("h3",{className:"column-title",children:"Lyrics & Generation"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"jingle-lyrics",children:"Jingle Lyrics"}),e.jsx("textarea",{id:"jingle-lyrics",className:"textarea-input",placeholder:"Enter or generate lyrics for your jingle...",value:y,onChange:g=>j(g.target.value),disabled:c,rows:8}),e.jsx("span",{className:"field-hint",children:"Structure: Verse 1, Chorus, Verse 2, Chorus, Outro"})]}),e.jsxs("div",{className:"button-group",children:[e.jsx("button",{className:"btn btn--secondary",onClick:l,disabled:c||u.loading,children:u.loading?"Generating...":"Generate Lyrics"}),e.jsx("button",{className:"btn btn--primary",onClick:_,disabled:c||!y||u.loading,children:u.loading?"Creating...":"Create Jingle"})]})]}),e.jsxs("div",{className:"grid-column",children:[e.jsx("h3",{className:"column-title",children:"Generated Jingles"}),d.length===0?e.jsxs("div",{className:"empty-list",children:[e.jsx("p",{children:"No jingles created yet."}),e.jsx("p",{className:"hint",children:"Set your preferences, generate lyrics, and create a jingle."})]}):e.jsx("div",{className:"items-list",children:d.map(g=>e.jsxs("div",{className:"item-card",children:[e.jsxs("div",{className:"item-header",children:[e.jsx("span",{className:"melody-badge",children:g["Melody Preferences"]||"Custom"}),e.jsx("span",{className:"item-date",children:new Date(g["Created Date"]).toLocaleDateString()})]}),g["Narration/Jingle Audio"]&&e.jsx("div",{className:"audio-preview",children:e.jsxs("audio",{controls:!0,className:"audio-player",children:[e.jsx("source",{src:g["Narration/Jingle Audio"],type:"audio/mpeg"}),"Your browser does not support the audio element."]})}),g["Narration/Jingle Script"]&&e.jsxs("details",{className:"lyrics-details",children:[e.jsx("summary",{children:"View Lyrics"}),e.jsx("pre",{className:"lyrics-text",children:g["Narration/Jingle Script"]})]}),e.jsxs("div",{className:"item-actions",children:[!g["Jingle / Narration created?"]&&e.jsx("button",{className:"btn btn--small btn--primary",onClick:()=>k(g._id),disabled:u.loading,children:"Attach to Manual"}),g["Jingle / Narration created?"]&&e.jsx("span",{className:"attached-badge",children:"Attached"})]})]},g._id))})]})]})]})}ie.propTypes={selectedHouseManual:s.string,selectedVisit:s.string,jingles:s.arrayOf(s.shape({_id:s.string.isRequired,"Melody Preferences":s.string,"Narration/Jingle Audio":s.string,"Narration/Jingle Script":s.string,"Created Date":s.string,"Jingle / Narration created?":s.bool})),melodyPreference:s.string,contentPreferences:s.arrayOf(s.string),jingleLyrics:s.string,jingleStatus:s.shape({loading:s.bool,error:s.string,message:s.string}),onMelodyPreferenceChange:s.func.isRequired,onContentPreferenceToggle:s.func.isRequired,onLyricsChange:s.func.isRequired,onGenerateLyrics:s.func.isRequired,onCreateJingle:s.func.isRequired,onAttach:s.func.isRequired};const N=async(t,o)=>{const{data:{session:d}}=await V.auth.getSession();if(!(d!=null&&d.access_token))throw new Error("Not authenticated. Please log in.");const h=await fetch("https://qcfifybkaddcoimjroca.supabase.co/functions/v1/ai-tools",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d.access_token}`},body:JSON.stringify({action:t,payload:o})}),m=await h.json();if(!h.ok)throw new Error(m.error||`AI Tools API error: ${h.status}`);if(!m.success)throw new Error(m.error||"AI Tools operation failed");return m.data},w={getHouseManuals:()=>N("get_house_manuals",{}),getDeepfakes:t=>N("get_deepfakes",{houseManualId:t}),getNarrations:t=>N("get_narrations",{houseManualId:t}),getJingles:t=>N("get_jingles",{houseManualId:t}),getNarrators:()=>N("get_narrators",{}),createDeepfake:t=>N("create_deepfake",{houseManualId:t}),generateDeepfakeScript:t=>N("generate_deepfake_script",{houseManualId:t}),generateDeepfakeVideo:(t,o,d,h)=>N("generate_deepfake_video",{houseManualId:t,videoId:o,voiceId:d,script:h}),checkDeepfakeStatus:t=>N("check_deepfake_status",{videoToken:t}),getDeepfakeUrl:t=>N("get_deepfake_url",{deepfakeId:t}),attachDeepfake:(t,o)=>N("attach_deepfake",{deepfakeId:t,houseManualId:o}),generateNarrationScript:(t,o,d)=>N("generate_narration_script",{houseManualId:t,visitId:o,narratorId:d}),generateNarration:(t,o,d,h)=>N("generate_narration",{houseManualId:t,visitId:o,narratorId:d,script:h}),attachNarration:(t,o)=>N("attach_narration",{narrationId:t,visitId:o}),generateJingleLyrics:(t,o,d,h)=>N("generate_jingle_lyrics",{houseManualId:t,visitId:o,melodyPreference:d,contentPreferences:h}),createJingle:(t,o,d,h,m)=>N("create_jingle",{houseManualId:t,visitId:o,lyrics:d,melodyPreference:h,contentPreferences:m}),attachJingle:(t,o)=>N("attach_jingle",{jingleId:t,houseManualId:o})};function Me(){const[t,o]=i.useState(!0),[d,h]=i.useState(null),[m,y]=i.useState([]),[u,C]=i.useState([]),[n,j]=i.useState(""),[l,_]=i.useState(""),[k,c]=i.useState([]),[g,E]=i.useState({videoId:"",voiceId:"",script:""}),[O,f]=i.useState({loading:!1,error:null,message:null}),[F,T]=i.useState([]),[$,B]=i.useState([]),[P,H]=i.useState(""),[L,q]=i.useState(""),[W,v]=i.useState({loading:!1,error:null,message:null}),[U,G]=i.useState([]),[J,z]=i.useState("optimistic-commercial"),[R,Y]=i.useState(["host-name","house-rules"]),[M,I]=i.useState(""),[K,b]=i.useState({loading:!1,error:null,message:null}),x=i.useCallback(async()=>{try{const{data:a,error:r}=await V.from("housemanual").select("_id, Display, Host, Listing").order("Created Date",{ascending:!1});if(r)throw r;return a||[]}catch(a){return console.error("[AiTools] Error fetching house manuals:",a),[]}},[]),X=i.useCallback(async a=>{if(!a)return[];try{const{data:r,error:p}=await V.from("visit").select('_id, Display, Guest, "House Manual"').eq("House Manual",a).order("Created Date",{ascending:!1});if(p)throw p;return r||[]}catch(r){return console.error("[AiTools] Error fetching visits:",r),[]}},[]),S=i.useCallback(async a=>{if(!a)return[];try{const{data:r,error:p}=await V.from("heygen_deepfake").select("*").eq("house_manual_id",a).order("created_at",{ascending:!1});if(p)throw p;return r||[]}catch(r){return console.error("[AiTools] Error fetching deepfakes:",r),[]}},[]),D=i.useCallback(async a=>{if(!a)return[];try{const{data:r,error:p}=await V.from("narration").select("*").eq("House Manual",a).eq("is it narration?",!0).order("Created Date",{ascending:!1});if(p)throw p;return r||[]}catch(r){return console.error("[AiTools] Error fetching narrations:",r),[]}},[]),A=i.useCallback(async a=>{if(!a)return[];try{const{data:r,error:p}=await V.from("narration").select("*").eq("House Manual",a).eq("is it jingle?",!0).order("Created Date",{ascending:!1});if(p)throw p;return r||[]}catch(r){return console.error("[AiTools] Error fetching jingles:",r),[]}},[]),Z=i.useCallback(async()=>[{id:"david-attenborough",name:"David Attenborough",description:"English"},{id:"ricardo-darin",name:"Ricardo Darin",description:"Spanish"},{id:"serhiy-prytula",name:"Serhiy Prytula",description:"Ukrainian"},{id:"olena",name:"Olena",description:"Ukrainian"},{id:"eric-braa",name:"Eric Braa",description:"English"},{id:"snoop-dogg",name:"Snoop Dogg",description:"English"},{id:"larry-david",name:"Larry David",description:"English"},{id:"jerry-seinfeld",name:"Jerry Seinfeld",description:"English"},{id:"barack-obama",name:"Barack Obama",description:"English"},{id:"meryl-streep",name:"Meryl Streep",description:"English"},{id:"morgan-freeman",name:"Morgan Freeman",description:"English"},{id:"martha-stewart",name:"Martha Stewart",description:"English"},{id:"mary-poppins",name:"Mary Poppins",description:"English"},{id:"steve-irwin",name:"Steve Irwin",description:"English"}],[]),ee=i.useCallback(async()=>{o(!0),h(null);try{const[a,r]=await Promise.all([x(),Z()]);y(a),B(r),r.length>0&&H(r[0].id),o(!1)}catch(a){console.error("[AiTools] Error loading initial data:",a),h(`Failed to load AI Tools: ${a.message}`),o(!1)}},[x,Z]);i.useEffect(()=>{ee()},[ee]);const le=i.useCallback(async a=>{if(j(a),_(""),!a){C([]),c([]),T([]),G([]);return}const[r,p,we,_e]=await Promise.all([X(a),S(a),D(a),A(a)]);C(r),c(p),T(we),G(_e)},[X,S,D,A]),oe=i.useCallback(a=>{_(a)},[]),ce=i.useCallback((a,r)=>{E(p=>({...p,[a]:r}))},[]),de=i.useCallback(async()=>{if(!n){f({loading:!1,error:"Please select a house manual first",message:null});return}f({loading:!0,error:null,message:"Generating script..."});try{const a=await w.generateDeepfakeScript(n);E(r=>({...r,script:a.script})),f({loading:!1,error:null,message:"Script generated successfully!"})}catch(a){console.error("[AiTools] Error generating deepfake script:",a),f({loading:!1,error:a.message,message:null})}},[n]),he=i.useCallback(async()=>{if(!n||!g.script){f({loading:!1,error:"Please select a house manual and generate/enter a script",message:null});return}f({loading:!0,error:null,message:"Generating video..."});try{const a=await w.generateDeepfakeVideo(n,g.videoId,g.voiceId,g.script);f({loading:!1,error:null,message:`Video generation started. Token: ${a.videoToken}`});const r=await S(n);c(r)}catch(a){console.error("[AiTools] Error generating deepfake video:",a),f({loading:!1,error:a.message,message:null})}},[n,g,S]),ge=i.useCallback(async a=>{if(!a.video_token){f({loading:!1,error:"No video token available",message:null});return}f({loading:!0,error:null,message:"Checking status..."});try{const r=await w.checkDeepfakeStatus(a.video_token);f({loading:!1,error:null,message:`Status: ${r.status}`});const p=await S(n);c(p)}catch(r){console.error("[AiTools] Error checking deepfake status:",r),f({loading:!1,error:r.message,message:null})}},[n,S]),ue=i.useCallback(async a=>{if(!n){f({loading:!1,error:"Please select a house manual first",message:null});return}f({loading:!0,error:null,message:"Attaching to house manual..."});try{await w.attachDeepfake(a,n),f({loading:!1,error:null,message:"Deepfake attached to house manual!"});const r=await S(n);c(r)}catch(r){console.error("[AiTools] Error attaching deepfake:",r),f({loading:!1,error:r.message,message:null})}},[n,S]),me=i.useCallback(a=>{H(a)},[]),pe=i.useCallback(a=>{q(a)},[]),fe=i.useCallback(async()=>{if(!n){v({loading:!1,error:"Please select a house manual first",message:null});return}v({loading:!0,error:null,message:"Generating narration script..."});try{const a=await w.generateNarrationScript(n,l,P);q(a.script),v({loading:!1,error:null,message:"Narration script generated!"})}catch(a){console.error("[AiTools] Error generating narration script:",a),v({loading:!1,error:a.message,message:null})}},[n,l,P]),xe=i.useCallback(async()=>{if(!n||!L){v({loading:!1,error:"Please select a house manual and generate/enter a script",message:null});return}v({loading:!0,error:null,message:"Generating narration audio..."});try{const a=await w.generateNarration(n,l,P,L);v({loading:!1,error:null,message:"Narration generated successfully!"});const r=await D(n);T(r)}catch(a){console.error("[AiTools] Error generating narration:",a),v({loading:!1,error:a.message,message:null})}},[n,l,P,L,D]),Ne=i.useCallback(async a=>{if(!l){v({loading:!1,error:"Please select a visit to attach the narration to",message:null});return}v({loading:!0,error:null,message:"Attaching to visit..."});try{await w.attachNarration(a,l),v({loading:!1,error:null,message:"Narration attached to visit!"});const r=await D(n);T(r)}catch(r){console.error("[AiTools] Error attaching narration:",r),v({loading:!1,error:r.message,message:null})}},[n,l,D]),je=i.useCallback(a=>{z(a)},[]),ye=i.useCallback(a=>{Y(r=>r.includes(a)?r.filter(p=>p!==a):[...r,a])},[]),ve=i.useCallback(a=>{I(a)},[]),be=i.useCallback(async()=>{if(!n){b({loading:!1,error:"Please select a house manual first",message:null});return}b({loading:!0,error:null,message:"Generating jingle lyrics..."});try{const a=await w.generateJingleLyrics(n,l,J,R);I(a.lyrics),b({loading:!1,error:null,message:"Jingle lyrics generated!"})}catch(a){console.error("[AiTools] Error generating jingle lyrics:",a),b({loading:!1,error:a.message,message:null})}},[n,l,J,R]),Ce=i.useCallback(async()=>{if(!n||!M){b({loading:!1,error:"Please select a house manual and generate/enter lyrics",message:null});return}b({loading:!0,error:null,message:"Creating jingle..."});try{await w.createJingle(n,l,M,J,R),b({loading:!1,error:null,message:"Jingle created successfully!"});const a=await A(n);G(a)}catch(a){console.error("[AiTools] Error creating jingle:",a),b({loading:!1,error:a.message,message:null})}},[n,l,M,J,R,A]),ke=i.useCallback(async a=>{if(!n){b({loading:!1,error:"Please select a house manual first",message:null});return}b({loading:!0,error:null,message:"Attaching to house manual..."});try{await w.attachJingle(a,n),b({loading:!1,error:null,message:"Jingle attached to house manual!"});const r=await A(n);G(r)}catch(r){console.error("[AiTools] Error attaching jingle:",r),b({loading:!1,error:r.message,message:null})}},[n,A]),Se=i.useCallback(async()=>{if(!n)return;const[a,r,p]=await Promise.all([S(n),D(n),A(n)]);c(a),T(r),G(p)},[n,S,D,A]);return{loading:t,error:d,houseManuals:m,visits:u,selectedHouseManual:n,selectedVisit:l,deepfakes:k,deepfakeForm:g,deepfakeStatus:O,narrations:F,narrators:$,selectedNarrator:P,narrationScript:L,narrationStatus:W,jingles:U,melodyPreference:J,contentPreferences:R,jingleLyrics:M,jingleStatus:K,handleHouseManualSelect:le,handleVisitSelect:oe,handleDeepfakeFormChange:ce,handleGenerateDeepfakeScript:de,handleGenerateDeepfakeVideo:he,handleCheckDeepfakeStatus:ge,handleAttachDeepfake:ue,handleNarratorSelect:me,handleNarrationScriptChange:pe,handleGenerateNarrationScript:fe,handleGenerateNarration:xe,handleAttachNarration:Ne,handleMelodyPreferenceChange:je,handleContentPreferenceToggle:ye,handleJingleLyricsChange:ve,handleGenerateJingleLyrics:be,handleCreateJingle:Ce,handleAttachJingle:ke,handleRefreshData:Se}}function Ve(){const{loading:t,error:o,houseManuals:d,visits:h,selectedHouseManual:m,selectedVisit:y,deepfakes:u,deepfakeForm:C,deepfakeStatus:n,narrations:j,narrators:l,selectedNarrator:_,narrationScript:k,narrationStatus:c,jingles:g,melodyPreference:E,contentPreferences:O,jingleLyrics:f,jingleStatus:F,handleHouseManualSelect:T,handleVisitSelect:$,handleDeepfakeFormChange:B,handleGenerateDeepfakeScript:P,handleGenerateDeepfakeVideo:H,handleCheckDeepfakeStatus:L,handleAttachDeepfake:q,handleNarratorSelect:W,handleNarrationScriptChange:v,handleGenerateNarrationScript:U,handleGenerateNarration:G,handleAttachNarration:J,handleMelodyPreferenceChange:z,handleContentPreferenceToggle:R,handleJingleLyricsChange:Y,handleGenerateJingleLyrics:M,handleCreateJingle:I,handleAttachJingle:K,handleRefreshData:b}=Me();return t?e.jsxs("div",{className:"ai-tools-page-wrapper",children:[e.jsx(Q,{}),e.jsx("main",{className:"ai-tools-main",children:e.jsx("div",{className:"ai-tools-container",children:e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"Loading AI Tools..."})]})})})]}):o?e.jsxs("div",{className:"ai-tools-page-wrapper",children:[e.jsx(Q,{}),e.jsx("main",{className:"ai-tools-main",children:e.jsx("div",{className:"ai-tools-container",children:e.jsxs("div",{className:"error-state",children:[e.jsx("div",{className:"error-icon",children:"âš "}),e.jsx("h2",{children:"Unable to Load AI Tools"}),e.jsx("p",{className:"error-message",children:o}),e.jsx("button",{onClick:()=>window.location.reload(),className:"btn btn--primary",children:"Reload Page"})]})})})]}):e.jsxs("div",{className:"ai-tools-page-wrapper",children:[e.jsx(Q,{}),e.jsx("main",{className:"ai-tools-main",children:e.jsxs("div",{className:"ai-tools-container",children:[e.jsxs("section",{className:"page-header",children:[e.jsxs("div",{className:"page-header__content",children:[e.jsx("h1",{className:"page-title",children:"AI Tools"}),e.jsx("p",{className:"page-subtitle",children:"Generate deepfake videos, narrations, and jingles for house manuals"})]}),e.jsxs("button",{className:"btn btn--secondary refresh-btn",onClick:b,title:"Refresh data",children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M23 4v6h-6M1 20v-6h6"}),e.jsx("path",{d:"M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"})]}),"Refresh"]})]}),e.jsx("section",{className:"selection-section",children:e.jsxs("div",{className:"selection-grid",children:[e.jsxs("div",{className:"selection-field",children:[e.jsx("label",{htmlFor:"house-manual-select",children:"House Manual"}),e.jsxs("select",{id:"house-manual-select",value:m,onChange:x=>T(x.target.value),className:"select-input",children:[e.jsx("option",{value:"",children:"Select a house manual..."}),d.map(x=>e.jsx("option",{value:x._id,children:[x.Display||x._id,x.Listing,x.Host].filter(Boolean).join(" - ")},x._id))]})]}),e.jsxs("div",{className:"selection-field",children:[e.jsx("label",{htmlFor:"visit-select",children:"Visit (Optional)"}),e.jsxs("select",{id:"visit-select",value:y,onChange:x=>$(x.target.value),className:"select-input",disabled:!m,children:[e.jsx("option",{value:"",children:"Select a visit..."}),h.map(x=>e.jsx("option",{value:x._id,children:x.Display||`Visit ${x._id.slice(-6)}`},x._id))]})]})]})}),e.jsx(te,{selectedHouseManual:m,deepfakes:u,deepfakeForm:C,deepfakeStatus:n,onFormChange:B,onGenerateScript:P,onGenerateVideo:H,onCheckStatus:L,onAttach:q}),e.jsx(ne,{selectedHouseManual:m,selectedVisit:y,narrations:j,narrators:l,selectedNarrator:_,narrationScript:k,narrationStatus:c,onNarratorSelect:W,onScriptChange:v,onGenerateScript:U,onGenerateNarration:G,onAttach:J}),e.jsx(ie,{selectedHouseManual:m,selectedVisit:y,jingles:g,melodyPreference:E,contentPreferences:O,jingleLyrics:f,jingleStatus:F,onMelodyPreferenceChange:z,onContentPreferenceToggle:R,onLyricsChange:Y,onGenerateLyrics:M,onCreateJingle:I,onAttach:K})]})})]})}const He=De(document.getElementById("root"));He.render(e.jsx(Ve,{}));
