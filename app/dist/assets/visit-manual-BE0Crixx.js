import{r as i,j as e,c as oe,R as ue}from"./client-BJVKzfAi.js";/* empty css             */import"./config-QPKPRtag.js";import{s as E}from"./supabase-BoCLEw6R.js";import{c as de,e as he}from"./auth-QZ4BJadW.js";import{E as me}from"./ErrorBoundary-9_HbXv1y.js";async function ve({visitId:a,accessToken:r}){if(!a)return{status:"error",message:"Visit ID is required"};try{const{data:n,error:t}=await E.functions.invoke("house-manual",{body:{action:"get_visit_manual",payload:{visitId:a,accessToken:r}}});if(t)throw new Error(t.message||"Failed to fetch house manual");if(!(n!=null&&n.success))throw new Error((n==null?void 0:n.error)||"Failed to fetch house manual");return{status:"success",data:n.data}}catch(n){return console.error("API Error (fetch-visit-manual):",n),{status:"error",message:n instanceof Error?n.message:"Unknown error occurred"}}}async function ge({accessToken:a,visitId:r}){if(!a)return{status:"error",message:"Access token is required"};try{const{data:n,error:t}=await E.functions.invoke("house-manual",{body:{action:"validate_access_token",payload:{accessToken:a,visitId:r}}});if(t)throw new Error(t.message||"Failed to validate access token");if(!(n!=null&&n.success))throw new Error((n==null?void 0:n.error)||"Invalid access token");return{status:"success",data:n.data}}catch(n){return console.error("API Error (validate-access-token):",n),{status:"error",message:n instanceof Error?n.message:"Unknown error occurred"}}}async function fe({visitId:a,eventType:r}){if(!a||!r)return{status:"error",message:"Visit ID and event type are required"};const n=["link_saw","map_saw","narration_heard"];if(!n.includes(r))return{status:"error",message:`Invalid event type. Must be one of: ${n.join(", ")}`};try{const{data:t,error:s}=await E.functions.invoke("house-manual",{body:{action:"track_engagement",payload:{visitId:a,eventType:r}}});if(s)throw new Error(s.message||"Failed to track engagement");return{status:"success"}}catch(t){return console.error("API Error (track-engagement):",t),{status:"error",message:t instanceof Error?t.message:"Unknown error occurred"}}}async function we({visitId:a,review:r}){if(!a)return{status:"error",message:"Visit ID is required"};if(!r||!r.reviewText)return{status:"error",message:"Review text is required"};const n=["overallRating","cleanlinessRating","accuracyRating","communicationRating","locationRating","valueRating","checkInRating"];for(const t of n)if(r[t]!==void 0){const s=r[t];if(typeof s!="number"||s<1||s>5)return{status:"error",message:`${t} must be a number between 1 and 5`}}try{const{data:t,error:s}=await E.functions.invoke("house-manual",{body:{action:"submit_review",payload:{visitId:a,review:r}}});if(s)throw new Error(s.message||"Failed to submit review");if(!(t!=null&&t.success))throw new Error((t==null?void 0:t.error)||"Failed to submit review");return{status:"success",data:t.data}}catch(t){return console.error("API Error (submit-review):",t),{status:"error",message:t instanceof Error?t.message:"Unknown error occurred"}}}const b={fetchVisitManual:ve,validateAccessToken:ge,trackEngagement:fe,submitGuestReview:we},xe={essentials:["check_in","check_out","wifi","parking","keys","access"],living:["kitchen","bathroom","bedroom","laundry","amenities","hvac","appliances"],local:["neighborhood","restaurants","transportation","attractions","emergency"],other:[]};function _e({response:a}){if(!a)return{houseManual:null,visit:null};const{house_manual:r,visit:n,listing:t}=a,s=((r==null?void 0:r.sections)||[]).map((l,c)=>({id:l.id||`section-${c}`,title:l.title||"Untitled Section",content:l.content||"",category:l.category||"other",order:l.order??c,icon:l.icon||null,images:l.images||[]}));return s.sort((l,c)=>l.order-c.order),{houseManual:{id:(r==null?void 0:r.id)||null,title:(r==null?void 0:r.title)||(t==null?void 0:t.title)||"House Manual",description:(r==null?void 0:r.description)||"",sections:s,listingId:(t==null?void 0:t.id)||null,listingTitle:(t==null?void 0:t.title)||"",listingAddress:(t==null?void 0:t.address)||"",hostName:(t==null?void 0:t.host_name)||"",hostPhone:(t==null?void 0:t.host_phone)||"",emergencyContact:(r==null?void 0:r.emergency_contact)||""},visit:{id:(n==null?void 0:n.id)||null,guestId:(n==null?void 0:n.guest_id)||null,guestName:(n==null?void 0:n.guest_name)||"",checkInDate:(n==null?void 0:n.check_in_date)||null,checkOutDate:(n==null?void 0:n.check_out_date)||null,hasReviewed:!!(n!=null&&n.has_reviewed),linkSaw:!!(n!=null&&n.link_saw),status:(n==null?void 0:n.status)||"unknown"}}}function pe({sections:a}){var n;const r={essentials:[],living:[],local:[],other:[]};if(!Array.isArray(a))return r;for(const t of a){const s=((n=t.category)==null?void 0:n.toLowerCase())||"other";let l="other";for(const[c,u]of Object.entries(xe))if(u.includes(s)){l=c;break}r[l].push(t)}return r}function je({currentUserId:a,visitGuestId:r,isAuthenticated:n}){return n?a?r?a!==r?{canAccess:!1,denyReason:"You are not authorized to view this house manual"}:{canAccess:!0,denyReason:null}:{canAccess:!1,denyReason:"Visit has no guest assigned"}:{canAccess:!1,denyReason:"User ID not found"}:{canAccess:!1,denyReason:"Authentication required"}}function ye({userId:a,visitGuestId:r}){return!a||!r?!1:a===r}function ke({userId:a,visitGuestId:r,hasReviewed:n}){return!(!ye({userId:a,visitGuestId:r})||n)}const q=()=>({reviewText:"",overallRating:null,cleanlinessRating:null,accuracyRating:null,communicationRating:null,locationRating:null,valueRating:null,checkInRating:null});function Ne({visitId:a,accessToken:r=null,onAccessDenied:n=null,onReviewSubmitted:t=null}){const[s,l]=i.useState(null),[c,u]=i.useState(null),[m,f]=i.useState(!0),[k,d]=i.useState(null),[v,y]=i.useState(null),[_,N]=i.useState(!1),[p,Y]=i.useState(null),[w,R]=i.useState(q),[F,$]=i.useState(!1),[T,V]=i.useState(!1),[I,j]=i.useState(null),[M,U]=i.useState(!1),[L,S]=i.useState({}),[B,H]=i.useState(!1),[C,G]=i.useState(!1);i.useEffect(()=>{(async()=>{const h=await de();if(N(h),h){const g=he();Y(g)}})()},[]),i.useEffect(()=>{a&&P()},[a,_,p]),i.useEffect(()=>{c!=null&&c.id&&!C&&!c.linkSaw&&te()},[c==null?void 0:c.id,C,c==null?void 0:c.linkSaw]),i.useEffect(()=>{if(I||M){const o=setTimeout(()=>{j(null),U(!1)},5e3);return()=>clearTimeout(o)}},[I,M]);const P=i.useCallback(async()=>{var o;f(!0),d(null),y(null);try{const h=await b.fetchVisitManual({visitId:a,accessToken:r});if(h.status!=="success")throw new Error(h.message||"Failed to load house manual");const g=_e({response:h.data}),x=je({currentUserId:p,visitGuestId:g.visit.guestId,isAuthenticated:_});if(!x.canAccess){y(x.denyReason),n&&n(x.denyReason),f(!1);return}if(l(g.houseManual),u(g.visit),V(g.visit.hasReviewed),((o=g.houseManual.sections)==null?void 0:o.length)>0){const le={[g.houseManual.sections[0].id]:!0};S(le)}}catch(h){d(h instanceof Error?h.message:"Failed to load house manual")}finally{f(!1)}},[a,r,_,p,n]),O=i.useMemo(()=>s!=null&&s.sections?pe({sections:s.sections}):{essentials:[],living:[],local:[],other:[]},[s==null?void 0:s.sections]),W=i.useMemo(()=>ke({userId:p,visitGuestId:c==null?void 0:c.guestId,hasReviewed:T}),[p,c==null?void 0:c.guestId,T]),D=i.useMemo(()=>w.reviewText.trim().length>=10&&w.overallRating!==null&&!F,[w.reviewText,w.overallRating,F]),K=i.useMemo(()=>{var o;return((o=s==null?void 0:s.sections)==null?void 0:o.length)||0},[s==null?void 0:s.sections]),z=i.useMemo(()=>!!v,[v]),J=i.useCallback(o=>{S(h=>({...h,[o]:!h[o]}))},[]),Q=i.useCallback(()=>{if(!(s!=null&&s.sections))return;const o={};s.sections.forEach(h=>{o[h.id]=!0}),S(o)},[s==null?void 0:s.sections]),X=i.useCallback(()=>{S({})},[]),Z=i.useCallback(o=>!!L[o],[L]),ee=i.useCallback(o=>{R(h=>({...h,reviewText:o.target.value})),j(null)},[]),se=i.useCallback((o,h)=>{R(g=>({...g,[o]:h})),j(null)},[]),re=i.useCallback(()=>{H(!0),j(null)},[]),ae=i.useCallback(()=>{H(!1),R(q()),j(null)},[]),ne=i.useCallback(async()=>{if(D){$(!0),j(null);try{const o={reviewText:w.reviewText.trim()};["overallRating","cleanlinessRating","accuracyRating","communicationRating","locationRating","valueRating","checkInRating"].forEach(x=>{w[x]!==null&&(o[x]=w[x])});const g=await b.submitGuestReview({visitId:a,review:o});if(g.status!=="success")throw new Error(g.message||"Failed to submit review");V(!0),U(!0),H(!1),R(q()),u(x=>({...x,hasReviewed:!0})),t&&t(g.data)}catch(o){j(o instanceof Error?o.message:"Failed to submit review")}finally{$(!1)}}},[a,w,D,t]),te=i.useCallback(async()=>{if(!(!a||C))try{await b.trackEngagement({visitId:a,eventType:"link_saw"}),G(!0)}catch(o){console.warn("Failed to track link_saw:",o)}},[a,C]),ie=i.useCallback(async()=>{if(a)try{await b.trackEngagement({visitId:a,eventType:"map_saw"})}catch(o){console.warn("Failed to track map_saw:",o)}},[a]),ce=i.useCallback(async()=>{if(a)try{await b.trackEngagement({visitId:a,eventType:"narration_heard"})}catch(o){console.warn("Failed to track narration_heard:",o)}},[a]);return{houseManual:s,visit:c,groupedSections:O,sectionCount:K,isLoading:m,error:k,hasAccessDenied:z,accessDeniedReason:v,isAuthenticated:_,currentUserId:p,expandedSections:L,toggleSection:J,expandAllSections:Q,collapseAllSections:X,isSectionExpanded:Z,showReviewForm:B,reviewFormData:w,reviewSubmitted:T,reviewSuccess:M,reviewError:I,isSubmittingReview:F,canUserSubmitReview:W,canSubmitReviewForm:D,handleReviewTextChange:ee,handleRatingChange:se,handleShowReviewForm:re,handleHideReviewForm:ae,handleSubmitReview:ne,trackMapSaw:ie,trackNarrationHeard:ce,loadManualData:P}}const be=({title:a,hostName:r=null,propertyAddress:n=null,arrivalDate:t=null,sectionCount:s=0,onExpandAll:l,onCollapseAll:c})=>{const u=t?new Date(t).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):null;return e.jsxs("header",{className:"vrhm-header",children:[e.jsxs("div",{className:"vrhm-header__top",children:[e.jsx("h1",{className:"vrhm-header__title",children:a}),e.jsxs("div",{className:"vrhm-header__actions",children:[e.jsx("button",{type:"button",className:"vrhm-header__action-btn",onClick:l,title:"Expand all sections",children:"Expand All"}),e.jsx("button",{type:"button",className:"vrhm-header__action-btn",onClick:c,title:"Collapse all sections",children:"Collapse All"})]})]}),e.jsxs("div",{className:"vrhm-header__meta",children:[r&&e.jsxs("p",{className:"vrhm-header__host",children:["Hosted by"," ",e.jsx("span",{className:"vrhm-header__host-name",children:r})]}),n&&e.jsxs("p",{className:"vrhm-header__address",children:[e.jsx("span",{"aria-hidden":"true",children:"ðŸ“"}),n]}),u&&e.jsxs("p",{className:"vrhm-header__arrival",children:[e.jsx("span",{className:"vrhm-header__arrival-label",children:"Check-in: "}),u]}),s>0&&e.jsxs("p",{className:"vrhm-header__section-count",children:[s," ",s===1?"section":"sections"," in this manual"]})]})]})},Re=({section:a,isExpanded:r,onToggle:n,onMapView:t=null,onNarrationPlay:s=null})=>{const{id:l,title:c,type:u,content:m}=a,f=Te(l,u);return e.jsxs("div",{className:`vrhm-section ${r?"vrhm-section--expanded":""}`,children:[e.jsxs("button",{type:"button",className:"vrhm-section__header",onClick:n,"aria-expanded":r,"aria-controls":`section-content-${l}`,children:[e.jsxs("div",{className:"vrhm-section__header-left",children:[e.jsx("span",{className:"vrhm-section__icon","aria-hidden":"true",children:f}),e.jsx("h4",{className:"vrhm-section__title",children:c})]}),e.jsx("span",{className:"vrhm-section__toggle","aria-hidden":"true",children:"â–¼"})]}),e.jsx("div",{id:`section-content-${l}`,className:`vrhm-section__content ${r?"":"vrhm-section__content--collapsed"}`,children:e.jsx(Se,{type:u,content:m,sectionId:l,onMapView:t,onNarrationPlay:s})})]})},Se=({type:a,content:r,sectionId:n,onMapView:t,onNarrationPlay:s})=>{if(!r)return e.jsx("p",{className:"vrhm-text-content",children:"No information available."});switch(a){case"wifi":return e.jsx(Ce,{content:r});case"rules":return e.jsx(Ee,{content:r});case"checklist":return e.jsx(Ae,{content:r});case"contacts":return e.jsx(Fe,{content:r});case"text":default:return e.jsx(A,{content:r})}},A=({content:a})=>{const r=typeof a=="string"?a:JSON.stringify(a);return e.jsx("div",{className:"vrhm-text-content",children:r})},Ce=({content:a})=>{const[r,n]=i.useState(null),t=i.useCallback(async(u,m)=>{try{await navigator.clipboard.writeText(m),n(u),setTimeout(()=>n(null),2e3)}catch(f){console.warn("Failed to copy:",f)}},[]),{networkName:s,password:l,photo:c}=a;return e.jsxs("div",{className:"vrhm-wifi",children:[s&&e.jsxs("div",{className:"vrhm-wifi__row",children:[e.jsx("span",{className:"vrhm-wifi__label",children:"Network:"}),e.jsx("span",{className:"vrhm-wifi__value",children:s}),e.jsx("button",{type:"button",className:"vrhm-wifi__copy-btn",onClick:()=>t("network",s),children:r==="network"?"Copied!":"Copy"})]}),l&&e.jsxs("div",{className:"vrhm-wifi__row",children:[e.jsx("span",{className:"vrhm-wifi__label",children:"Password:"}),e.jsx("span",{className:"vrhm-wifi__value",children:l}),e.jsx("button",{type:"button",className:"vrhm-wifi__copy-btn",onClick:()=>t("password",l),children:r==="password"?"Copied!":"Copy"})]}),c&&e.jsx("img",{src:c,alt:"WiFi instructions",className:"vrhm-wifi__photo"})]})},Ee=({content:a})=>Array.isArray(a)?e.jsx("div",{className:"vrhm-rules",children:e.jsx("ul",{className:"vrhm-rules__list",children:a.map((r,n)=>e.jsxs("li",{className:"vrhm-rules__item",children:[e.jsx("span",{className:"vrhm-rules__bullet",children:"â€¢"}),e.jsx("span",{children:r})]},n))})}):e.jsx(A,{content:a}),Ae=({content:a})=>{const[r,n]=i.useState({}),t=i.useCallback(s=>{n(l=>({...l,[s]:!l[s]}))},[]);return Array.isArray(a)?e.jsx("div",{className:"vrhm-checklist",children:e.jsx("ul",{className:"vrhm-checklist__list",children:a.map((s,l)=>{const c=r[l],u=typeof s=="string"?s:s.text||s.label;return e.jsxs("li",{className:"vrhm-checklist__item",onClick:()=>t(l),style:{cursor:"pointer"},children:[e.jsx("span",{className:`vrhm-checklist__checkbox ${c?"vrhm-checklist__checkbox--checked":""}`,children:c?"&#10003;":""}),e.jsx("span",{style:{textDecoration:c?"line-through":"none"},children:u})]},l)})})}):e.jsx(A,{content:a})},Fe=({content:a})=>Array.isArray(a)?e.jsx("div",{className:"vrhm-contacts",children:e.jsx("div",{className:"vrhm-contacts__list",children:a.map((r,n)=>e.jsxs("div",{className:"vrhm-contacts__item",children:[r.name&&e.jsx("span",{className:"vrhm-contacts__name",children:r.name}),r.role&&e.jsx("span",{className:"vrhm-contacts__role",children:r.role}),r.phone&&e.jsx("a",{href:`tel:${r.phone}`,className:"vrhm-contacts__phone",children:r.phone}),r.email&&e.jsx("a",{href:`mailto:${r.email}`,className:"vrhm-contacts__email",children:r.email})]},n))})}):e.jsx(A,{content:a});function Te(a,r){const n={wifi:"&#128246;",checkin:"&#128682;",checkout:"&#128682;",rules:"&#128220;",kitchen:"&#127869;",laundry:"&#129505;",hvac:"&#127777;",parking:"&#128664;",trash:"&#128465;",checklist:"&#9745;",emergency:"&#128286;",local:"&#127961;",notes:"&#128221;"},t=n[a]||n[r]||"&#128196;";return e.jsx("span",{dangerouslySetInnerHTML:{__html:t}})}const Ie=({formData:a,onReviewTextChange:r,onRatingChange:n,onSubmit:t,onCancel:s,canSubmit:l,isSubmitting:c,error:u})=>{const[m,f]=i.useState({}),k=i.useCallback(v=>{v.preventDefault(),l&&t()},[l,t]),d=[{field:"overallRating",label:"Overall Experience",required:!0},{field:"cleanlinessRating",label:"Cleanliness",required:!1},{field:"accuracyRating",label:"Accuracy",required:!1},{field:"communicationRating",label:"Host Communication",required:!1},{field:"locationRating",label:"Location",required:!1},{field:"valueRating",label:"Value for Money",required:!1},{field:"checkInRating",label:"Check-in Experience",required:!1}];return e.jsxs("form",{className:"vrhm-review-form",onSubmit:k,children:[e.jsx("h3",{className:"vrhm-review-form__title",children:"Write a Review"}),u&&e.jsx("div",{className:"vrhm-review-form__error",children:u}),e.jsxs("div",{className:"vrhm-review-form__field",children:[e.jsxs("label",{className:"vrhm-review-form__label",children:["Rate Your Experience",e.jsx("span",{className:"vrhm-review-form__required",children:"*"})]}),e.jsx("div",{className:"vrhm-rating",children:d.map(({field:v,label:y,required:_})=>e.jsx(Me,{field:v,label:y,required:_,value:a[v],hoveredValue:m[v],onRatingChange:n,onHover:N=>f(p=>({...p,[v]:N})),onHoverEnd:()=>f(N=>({...N,[v]:null}))},v))})]}),e.jsxs("div",{className:"vrhm-review-form__field",children:[e.jsxs("label",{htmlFor:"review-text",className:"vrhm-review-form__label",children:["Your Review",e.jsx("span",{className:"vrhm-review-form__required",children:"*"})]}),e.jsx("textarea",{id:"review-text",className:"vrhm-review-form__textarea",placeholder:"Share your experience staying at this property. What did you enjoy? Any tips for future guests?",value:a.reviewText,onChange:r,minLength:10,required:!0}),e.jsxs("span",{className:"vrhm-review-form__hint",children:["Minimum 10 characters."," ",a.reviewText.length>0&&`(${a.reviewText.length} characters)`]})]}),e.jsxs("div",{className:"vrhm-review-form__actions",children:[e.jsx("button",{type:"button",className:"vrhm-button-secondary",onClick:s,disabled:c,children:"Cancel"}),e.jsx("button",{type:"submit",className:"vrhm-button-primary",disabled:!l||c,children:c?"Submitting...":"Submit Review"})]})]})},Me=({field:a,label:r,required:n,value:t,hoveredValue:s,onRatingChange:l,onHover:c,onHoverEnd:u})=>{const m=i.useCallback(d=>{l(a,d)},[a,l]),f=i.useCallback((d,v)=>{(d.key==="Enter"||d.key===" ")&&(d.preventDefault(),m(v))},[m]),k=s||t||0;return e.jsxs("div",{className:"vrhm-rating__row",children:[e.jsxs("span",{className:"vrhm-rating__label",children:[r,n&&e.jsx("span",{className:"vrhm-review-form__required",children:"*"})]}),e.jsx("div",{className:"vrhm-rating__stars",role:"radiogroup","aria-label":`${r} rating`,onMouseLeave:u,children:[1,2,3,4,5].map(d=>{const v=d<=k,y=s&&d<=s;return e.jsx("span",{role:"radio","aria-checked":t===d,"aria-label":`${d} star${d!==1?"s":""}`,tabIndex:0,className:`vrhm-rating__star ${v?"vrhm-rating__star--filled":""} ${y?"vrhm-rating__star--hovered":""}`,onClick:()=>m(d),onKeyDown:_=>f(_,d),onMouseEnter:()=>c(d),children:"â˜…"},d)})})]})},Le=()=>e.jsxs("div",{className:"vrhm-loading",children:[e.jsx("div",{className:"vrhm-loading__spinner","aria-hidden":"true"}),e.jsx("p",{className:"vrhm-loading__text",children:"Loading house manual..."})]}),He=({reason:a,isAuthenticated:r})=>e.jsxs("div",{className:"vrhm-access-denied",children:[e.jsx("div",{className:"vrhm-access-denied__icon","aria-hidden":"true",children:"ðŸ”’"}),e.jsx("h2",{className:"vrhm-access-denied__title",children:"Access Denied"}),e.jsx("p",{className:"vrhm-access-denied__message",children:a}),!r&&e.jsxs("div",{children:[e.jsx("a",{href:"/login",className:"vrhm-button-primary",children:"Log In to Continue"}),e.jsx("p",{className:"vrhm-access-denied__login-hint",children:"You must be logged in as the guest to view this house manual."})]}),r&&e.jsx("p",{className:"vrhm-access-denied__login-hint",children:"This house manual is only accessible to the assigned guest."})]}),De=({visitId:a,accessToken:r=null,onAccessDenied:n=null,onReviewSubmitted:t=null})=>{var l;const s=Ne({visitId:a,accessToken:r,onAccessDenied:n,onReviewSubmitted:t});return s.isLoading?e.jsx("div",{className:"vrhm-container",children:e.jsx(Le,{})}):s.hasAccessDenied?e.jsx("div",{className:"vrhm-container",children:e.jsx(He,{reason:s.accessDeniedReason,isAuthenticated:s.isAuthenticated})}):s.error?e.jsx("div",{className:"vrhm-container",children:e.jsxs("div",{className:"vrhm-error",children:[e.jsx("div",{className:"vrhm-error__icon",children:"!"}),e.jsx("h2",{className:"vrhm-error__title",children:"Unable to Load House Manual"}),e.jsx("p",{className:"vrhm-error__message",children:s.error}),e.jsx("button",{type:"button",className:"vrhm-button-primary",onClick:s.loadManualData,children:"Try Again"})]})}):s.houseManual?e.jsxs("div",{className:"vrhm-container",children:[e.jsx(be,{title:s.houseManual.title,hostName:s.houseManual.hostName,propertyAddress:s.houseManual.propertyAddress,arrivalDate:(l=s.visit)==null?void 0:l.arrivalDate,sectionCount:s.sectionCount,onExpandAll:s.expandAllSections,onCollapseAll:s.collapseAllSections}),s.reviewSuccess&&e.jsx("div",{className:"vrhm-message vrhm-message--success",children:"Thank you for your review! Your feedback helps future guests."}),e.jsxs("div",{className:"vrhm-content",children:[Object.entries(s.groupedSections).map(([c,u])=>u.length===0?null:e.jsxs("div",{className:"vrhm-category",children:[e.jsx("h3",{className:"vrhm-category__title",children:qe(c)}),e.jsx("div",{className:"vrhm-category__sections",children:u.map(m=>e.jsx(Re,{section:m,isExpanded:s.isSectionExpanded(m.id),onToggle:()=>s.toggleSection(m.id),onMapView:s.trackMapSaw,onNarrationPlay:s.trackNarrationHeard},m.id))})]},c)),e.jsx("div",{className:"vrhm-review-section",children:s.reviewSubmitted?e.jsxs("div",{className:"vrhm-review-submitted",children:[e.jsx("div",{className:"vrhm-review-submitted__icon",children:"âœ“"}),e.jsx("h3",{className:"vrhm-review-submitted__title",children:"Thank You for Your Review"}),e.jsx("p",{className:"vrhm-review-submitted__text",children:"Your feedback helps other guests make informed decisions."})]}):s.canUserSubmitReview?s.showReviewForm?e.jsx(Ie,{formData:s.reviewFormData,onReviewTextChange:s.handleReviewTextChange,onRatingChange:s.handleRatingChange,onSubmit:s.handleSubmitReview,onCancel:s.handleHideReviewForm,canSubmit:s.canSubmitReviewForm,isSubmitting:s.isSubmittingReview,error:s.reviewError}):e.jsxs("div",{className:"vrhm-review-cta",children:[e.jsx("h3",{className:"vrhm-review-cta__title",children:"How was your stay?"}),e.jsx("p",{className:"vrhm-review-cta__text",children:"Share your experience to help future guests."}),e.jsx("button",{type:"button",className:"vrhm-button-primary",onClick:s.handleShowReviewForm,children:"Write a Review"})]}):null})]}),e.jsx("div",{className:"vrhm-footer",children:e.jsxs("p",{className:"vrhm-footer__text",children:["Powered by ",e.jsx("strong",{children:"Split Lease"})]})})]}):e.jsx("div",{className:"vrhm-container",children:e.jsx("div",{className:"vrhm-empty",children:e.jsx("p",{children:"No house manual found."})})})};function qe(a){return{essentials:"Essentials",living:"Living in the Space",local:"Local Area",other:"Additional Information"}[a]||a}function $e(){const a=new URLSearchParams(window.location.search);return{visitId:a.get("visitId"),token:a.get("token")}}function Ve(a){console.warn("Access denied to house manual:",a)}function Ue(a){console.log("Review submitted successfully:",a)}function Pe(){const{visitId:a,token:r}=$e();return a?e.jsx(De,{visitId:a,accessToken:r,onAccessDenied:Ve,onReviewSubmitted:Ue}):e.jsx("div",{className:"vrhm-container",children:e.jsxs("div",{className:"vrhm-error",children:[e.jsx("div",{className:"vrhm-error__icon",children:"!"}),e.jsx("h2",{className:"vrhm-error__title",children:"Invalid Link"}),e.jsx("p",{className:"vrhm-error__message",children:"This house manual link is invalid or incomplete. Please check the link you received and try again."}),e.jsx("a",{href:"/",className:"vrhm-button-primary",children:"Go to Homepage"})]})})}oe(document.getElementById("root")).render(e.jsx(ue.StrictMode,{children:e.jsx(me,{children:e.jsx(Pe,{})})}));
