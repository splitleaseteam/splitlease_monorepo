import{r as o,j as e,c as De,R as we}from"./client-BJVKzfAi.js";import{u as Se,a as Be}from"./Toast-BQk6Nzgd.js";import{s as Fe}from"./supabase-BoCLEw6R.js";import{t as R,c as z,m as H,a as V,s as Ae,f as P}from"./format-AibE8BX3.js";import{A as L}from"./AdminHeader-tCInZd3n.js";import{E as Ue}from"./ErrorBoundary-9_HbXv1y.js";/* empty css             */import"./config-QPKPRtag.js";import"./auth-QZ4BJadW.js";import"./star-OtPMgcH9.js";import"./createLucideIcon-CgZZH2OU.js";import"./file-text-Bqp_Hw0X.js";import"./triangle-alert-Bp6DQQmR.js";import"./users-d0RSvnp4.js";import"./pen-line-Duo49k9O.js";import"./calendar-CDI4qHEX.js";import"./mail-CRbL90NL.js";import"./user-check-CoCGzn5Y.js";import"./dollar-sign-Dn2-KjNW.js";import"./send-C4mziT0-.js";import"./x-CrJVeoCh.js";function Y(a,s,t){const n=R(a,t==null?void 0:t.in);return isNaN(s)?z(a,NaN):(s&&n.setDate(n.getDate()+s),n)}function We(a,s,t){return Y(a,s*7,t)}function G(a,s){const t=()=>z(s==null?void 0:s.in,NaN),l=Re(a);let i;if(l.date){const u=$e(l.date,2);i=Ee(u.restDateString,u.year)}if(!i||isNaN(+i))return t();const c=+i;let d=0,x;if(l.time&&(d=qe(l.time),isNaN(d)))return t();if(l.timezone){if(x=Te(l.timezone),isNaN(x))return t()}else{const u=new Date(c+d),g=R(0,s==null?void 0:s.in);return g.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),g.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),g}return R(c+d+x,s==null?void 0:s.in)}const W={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Ie=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Le=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Oe=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Re(a){const s={},t=a.split(W.dateTimeDelimiter);let n;if(t.length>2)return s;if(/:/.test(t[0])?n=t[0]:(s.date=t[0],n=t[1],W.timeZoneDelimiter.test(s.date)&&(s.date=a.split(W.timeZoneDelimiter)[0],n=a.substr(s.date.length,a.length))),n){const l=W.timezone.exec(n);l?(s.time=n.replace(l[1],""),s.timezone=l[1]):s.time=n}return s}function $e(a,s){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+s)+"})|(\\d{2}|[+-]\\d{"+(2+s)+"})$)"),n=a.match(t);if(!n)return{year:NaN,restDateString:""};const l=n[1]?parseInt(n[1]):null,i=n[2]?parseInt(n[2]):null;return{year:i===null?l:i*100,restDateString:a.slice((n[1]||n[2]).length)}}function Ee(a,s){if(s===null)return new Date(NaN);const t=a.match(Ie);if(!t)return new Date(NaN);const n=!!t[4],l=B(t[1]),i=B(t[2])-1,c=B(t[3]),d=B(t[4]),x=B(t[5])-1;if(n)return Ye(s,d,x)?ze(s,d,x):new Date(NaN);{const u=new Date(0);return!Ve(s,i,c)||!Pe(s,l)?new Date(NaN):(u.setUTCFullYear(s,i,Math.max(l,c)),u)}}function B(a){return a?parseInt(a):1}function qe(a){const s=a.match(Le);if(!s)return NaN;const t=O(s[1]),n=O(s[2]),l=O(s[3]);return Ge(t,n,l)?t*H+n*V+l*1e3:NaN}function O(a){return a&&parseFloat(a.replace(",","."))||0}function Te(a){if(a==="Z")return 0;const s=a.match(Oe);if(!s)return 0;const t=s[1]==="+"?-1:1,n=parseInt(s[2]),l=s[3]&&parseInt(s[3])||0;return Ze(n,l)?t*(n*H+l*V):NaN}function ze(a,s,t){const n=new Date(0);n.setUTCFullYear(a,0,4);const l=n.getUTCDay()||7,i=(s-1)*7+t+1-l;return n.setUTCDate(n.getUTCDate()+i),n}const He=[31,null,31,30,31,30,31,31,30,31,30,31];function Z(a){return a%400===0||a%4===0&&a%100!==0}function Ve(a,s,t){return s>=0&&s<=11&&t>=1&&t<=(He[s]||(Z(a)?29:28))}function Pe(a,s){return s>=1&&s<=(Z(a)?366:365)}function Ye(a,s,t){return s>=1&&s<=53&&t>=0&&t<=6}function Ge(a,s,t){return a===24?s===0&&t===0:t>=0&&t<60&&s>=0&&s<60&&a>=0&&a<25}function Ze(a,s){return s>=0&&s<=59}function Je(a){return a?a.status==="new_request"&&!a.booked_date&&Array.isArray(a.suggested_dates_and_times)&&a.suggested_dates_and_times.length>0:!1}function Ke(a){return a?a.status!=="confirmed"&&a.status!=="completed":!1}function Qe(a){return a?!a.booked_date&&a.status==="new_request":!1}function Xe(a){return a!=null&&a.booked_date?new Date(a.booked_date)<new Date:!1}function ea(a){const s={new_request:{label:"Pending",color:"warning",icon:"clock"},confirmed:{label:"Confirmed",color:"success",icon:"check-circle"},cancelled:{label:"Cancelled",color:"error",icon:"x-circle"},completed:{label:"Completed",color:"info",icon:"check-double"},rescheduled:{label:"Rescheduled",color:"warning",icon:"calendar-refresh"}},t=(a==null?void 0:a.status)||"unknown";return s[t]||{label:"Unknown",color:"default",icon:"question"}}function aa(a){if(!(a!=null&&a.created_at))return"normal";const s=new Date(a.created_at),n=(new Date-s)/(1e3*60*60);return n>48?"urgent":n>24?"elevated":"normal"}function T(a,s={}){if(!Array.isArray(a))return[];const{guestSearch:t="",hostId:n="",proposalId:l="",dateRange:i=null}=s;return a.filter(c=>{var d,x,u;if(t){const g=t.toLowerCase(),j=I(c.guest).toLowerCase(),_=(((d=c.guest)==null?void 0:d.email)||"").toLowerCase();if(!(j.includes(g)||_.includes(g)))return!1}if(n&&(((x=c.host)==null?void 0:x.id)||((u=c.host)==null?void 0:u._id))!==n||l&&!(c.proposal_unique_id||"").toLowerCase().includes(l.toLowerCase()))return!1;if(i!=null&&i.start&&(i!=null&&i.end)){const g=c.booked_date||c.created_at;if(g){const j=new Date(g);if(j<i.start||j>i.end)return!1}}return!0})}function sa(a){if(!Array.isArray(a))return[];const s=new Map;return a.forEach(t=>{if(!t.host)return;const n=t.host.id||t.host._id;!n||s.has(n)||s.set(n,{id:n,name:I(t.host),email:t.host.email||"",avatarUrl:t.host.avatar_url||t.host.profile_photo_url})}),Array.from(s.values()).sort((t,n)=>t.name.localeCompare(n.name))}function I(a){if(!a)return"Unknown";const s=a.name_first||a.first_name||"",t=a.name_last||a.last_name||"";return`${s} ${t}`.trim()||a.email||"Unknown"}function F(a){var s,t,n,l,i;return a?{id:a._id||a.id,status:a.status||"unknown",guestName:I(a.guest),guestEmail:((s=a.guest)==null?void 0:s.email)||"",guestPhone:((t=a.guest)==null?void 0:t.phone_number)||"",guestTimezone:((n=a.guest)==null?void 0:n.timezone)||"America/New_York",hostName:I(a.host),hostEmail:((l=a.host)==null?void 0:l.email)||"",hostTimezone:((i=a.host)==null?void 0:i.timezone)||"America/New_York",proposalId:a.proposal_unique_id||"",listingAddress:ta(a.listing),suggestedDates:na(a.suggested_dates_and_times),bookedDate:a.booked_date?la(a.booked_date):null,meetingLink:a.meeting_link||null,createdAt:a.created_at,formattedCreatedAt:K(a.created_at)}:null}function ta(a){return a&&([a.street_address,a.unit_apt,a.neighborhood_1].filter(Boolean).join(", ")||a.title)||"Unknown Listing"}function na(a){return Array.isArray(a)?a.map(s=>({raw:s,formatted:J(s)})):[]}function la(a){return a?{raw:a,formatted:J(a),relative:K(a)}:null}function J(a){if(!a)return"";try{return new Date(a).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{return a}}function K(a){if(!a)return"";try{const s=new Date,t=new Date(a),n=s-t,l=Math.floor(n/(1e3*60)),i=Math.floor(n/(1e3*60*60)),c=Math.floor(n/(1e3*60*60*24));return l<1?"just now":l<60?`${l}m ago`:i<24?`${i}h ago`:c<7?`${c}d ago`:t.toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}function ia(a){return Ae(a,{weekStartsOn:0})}function ra(a,s){return We(a,s)}function ca(a=8,s=18){const t=[];for(let n=a;n<s;n++)t.push({hour:n,label:oa(n),startTime:`${String(n).padStart(2,"0")}:00:00`,endTime:`${String(n+1).padStart(2,"0")}:00:00`});return t}function oa(a){const s=a>=12?"PM":"AM";return`${a%12||12}:00 ${s}`}function da(a,s="MMM d"){const t=typeof a=="string"?G(a):a;return P(t,s)}function Q(a){return P(a,"yyyy-MM-dd")}function ma(a,s,t){return t.some(n=>n.date!==a?!1:n.is_full_day_blocked?!0:n.start_time<=s&&n.end_time>s)}function X(a,s){return s.some(t=>t.date===a&&t.is_full_day_blocked)}function ua(a,s=[],t=8,n=18){const l=typeof a=="string"?G(a):a,i=Q(l),c=ca(t,n);return X(i,s)?c.map(d=>({...d,available:!1,isFullDayBlocked:!0})):c.map(d=>({...d,available:!ma(i,d.startTime,s),isFullDayBlocked:!1}))}function _a(a,s=[],t=8,n=18){const l=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],i=[];for(let c=0;c<7;c++){const d=Y(a,c),x=Q(d),u=ua(d,s,t,n);i.push({date:d,dateStr:x,dayName:l[c],displayDate:da(d),isFullDayBlocked:X(x,s),slots:u,availableCount:u.filter(g=>g.available).length,totalSlots:u.length})}return i}function ha(a){const s=a.reduce((i,c)=>i+c.totalSlots,0),t=a.reduce((i,c)=>i+c.availableCount,0),n=s-t,l=s>0?Math.round(t/s*100):100;return{totalSlots:s,availableSlots:t,blockedSlots:n,percentageAvailable:l}}const ga="https://qcfifybkaddcoimjroca.supabase.co";function xa({showToast:a}){const[s,t]=o.useState([]),[n,l]=o.useState([]),[i,c]=o.useState([]),[d,x]=o.useState(!0),[u,g]=o.useState(!1),[j,_]=o.useState(!1),[f,C]=o.useState(null),[b,h]=o.useState(null),[v,A]=o.useState({guestSearch:"",hostId:"",proposalId:"",dateRange:null}),[k,ee]=o.useState(null),[ae,se]=o.useState(()=>ia(new Date)),[te,M]=o.useState({confirm:{isOpen:!1,meeting:null},edit:{isOpen:!1,meeting:null},delete:{isOpen:!1,meeting:null},reschedule:{isOpen:!1,meeting:null}}),ne=o.useMemo(()=>{const r=[...s,...n];return sa(r)},[s,n]),le=o.useMemo(()=>T(s,v),[s,v]),ie=o.useMemo(()=>T(n,v),[n,v]),re=o.useMemo(()=>({totalRequests:s.length+n.length,pendingRequests:s.length,confirmedMeetings:n.filter(r=>r.status==="confirmed").length,completedMeetings:n.filter(r=>r.status==="completed").length}),[s,n]);o.useEffect(()=>{(async()=>{try{const{data:{session:m}}=await Fe.auth.getSession();if(m!=null&&m.access_token)h(m.access_token);else{const p=localStorage.getItem("sl_auth_token")||sessionStorage.getItem("sl_auth_token");p&&h(p)}}catch(m){console.error("[ManageVirtualMeetings] Auth check failed:",m)}})()},[]);const N=o.useCallback(async(r,m)=>{const p=await fetch(`${ga}/functions/v1/virtual-meeting`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${b}`},body:JSON.stringify({action:r,payload:m})}),y=await p.json();if(!p.ok||!y.success)throw new Error(y.error||`Action ${r} failed`);return y.data},[b]),U=o.useCallback(async()=>{if(b){x(!0),C(null);try{const[r,m]=await Promise.all([N("admin_fetch_new_requests",{}),N("admin_fetch_confirmed",{})]);t(r||[]),l(m||[])}catch(r){console.error("[ManageVirtualMeetings] Fetch error:",r),C(r.message),a({title:"Failed to load meetings",content:r.message,type:"error"})}finally{x(!1)}}},[b,N,a]),D=o.useCallback(async r=>{if(!(!b||!r)){g(!0);try{const m=await N("admin_fetch_blocked_slots",{hostId:r});c(m||[])}catch(m){console.error("[ManageVirtualMeetings] Fetch blocked slots error:",m),a({title:"Failed to load availability",content:m.message,type:"error"})}finally{g(!1)}}},[b,N,a]);o.useEffect(()=>{b&&U()},[b,U]),o.useEffect(()=>{k?D(k.id):c([])},[k,D]);const ce=o.useCallback(async(r,m,p)=>{const y=s.find(w=>w._id===r);if(!Je(y)){a({title:"Cannot confirm this meeting",type:"error"});return}_(!0);try{const w=await N("admin_confirm_meeting",{meetingId:r,bookedDate:m,meetingLink:p});t(S=>S.filter(Me=>Me._id!==r)),l(S=>[...S,w]),a({title:"Meeting confirmed successfully",type:"success"}),$()}catch(w){console.error("[ManageVirtualMeetings] Confirm error:",w),a({title:"Failed to confirm meeting",content:w.message,type:"error"})}finally{_(!1)}},[s,N,a]),oe=o.useCallback(async(r,m)=>{const p=s.find(y=>y._id===r);if(!Qe(p)){a({title:"Cannot edit dates for this meeting",type:"error"});return}_(!0);try{const y=await N("admin_update_meeting_dates",{meetingId:r,suggestedDates:m});t(w=>w.map(S=>S._id===r?y:S)),a({title:"Meeting dates updated",type:"success"}),E()}catch(y){console.error("[ManageVirtualMeetings] Update dates error:",y),a({title:"Failed to update dates",content:y.message,type:"error"})}finally{_(!1)}},[s,N,a]),de=o.useCallback(async r=>{const m=s.find(p=>p._id===r)||n.find(p=>p._id===r);if(!Ke(m)){a({title:"Cannot delete this meeting",type:"error"});return}_(!0);try{await N("admin_delete_meeting",{meetingId:r}),t(p=>p.filter(y=>y._id!==r)),l(p=>p.filter(y=>y._id!==r)),a({title:"Meeting deleted",type:"success"}),q()}catch(p){console.error("[ManageVirtualMeetings] Delete error:",p),a({title:"Failed to delete meeting",content:p.message,type:"error"})}finally{_(!1)}},[s,n,N,a]),me=o.useCallback(async(r,m,p)=>{if(!k){a({title:"Select a host first",type:"warning"});return}try{await N("admin_block_time_slot",{hostId:k.id,date:r,startTime:m,endTime:p}),await D(k.id),a({title:"Time slot blocked",type:"success"})}catch(y){console.error("[ManageVirtualMeetings] Block slot error:",y),a({title:"Failed to block slot",content:y.message,type:"error"})}},[k,N,D,a]),ue=o.useCallback(async r=>{try{await N("admin_unblock_time_slot",{slotId:r}),c(m=>m.filter(p=>p.id!==r)),a({title:"Time slot unblocked",type:"success"})}catch(m){console.error("[ManageVirtualMeetings] Unblock slot error:",m),a({title:"Failed to unblock slot",content:m.message,type:"error"})}},[N,a]),_e=o.useCallback(async r=>{if(!k){a({title:"Select a host first",type:"warning"});return}try{await N("admin_block_full_day",{hostId:k.id,date:r}),await D(k.id),a({title:"Full day blocked",type:"success"})}catch(m){console.error("[ManageVirtualMeetings] Block full day error:",m),a({title:"Failed to block day",content:m.message,type:"error"})}},[k,N,D,a]),he=o.useCallback(async r=>{if(k)try{await N("admin_unblock_full_day",{hostId:k.id,date:r}),await D(k.id),a({title:"Day unblocked",type:"success"})}catch(m){console.error("[ManageVirtualMeetings] Unblock full day error:",m),a({title:"Failed to unblock day",content:m.message,type:"error"})}},[k,N,D,a]),ge=o.useCallback((r,m)=>{A(p=>({...p,[r]:m}))},[]),xe=o.useCallback(()=>{A({guestSearch:"",hostId:"",proposalId:"",dateRange:null})},[]),pe=o.useCallback(r=>{ee(r)},[]),fe=o.useCallback(r=>{se(m=>ra(m,r==="next"?1:-1))},[]),ve=o.useCallback(r=>{M(m=>({...m,confirm:{isOpen:!0,meeting:r}}))},[]),$=o.useCallback(()=>{M(r=>({...r,confirm:{isOpen:!1,meeting:null}}))},[]),je=o.useCallback(r=>{M(m=>({...m,edit:{isOpen:!0,meeting:r}}))},[]),E=o.useCallback(()=>{M(r=>({...r,edit:{isOpen:!1,meeting:null}}))},[]),Ne=o.useCallback(r=>{M(m=>({...m,delete:{isOpen:!0,meeting:r}}))},[]),q=o.useCallback(()=>{M(r=>({...r,delete:{isOpen:!1,meeting:null}}))},[]),ye=o.useCallback(r=>{M(m=>({...m,reschedule:{isOpen:!0,meeting:r}}))},[]),be=o.useCallback(()=>{M(r=>({...r,reschedule:{isOpen:!1,meeting:null}}))},[]),ke=o.useCallback(()=>{U()},[U]),Ce=o.useCallback(()=>{C(null)},[]);return{newRequests:s,confirmedMeetings:n,blockedSlots:i,stats:re,hostOptions:ne,filteredNewRequests:le,filteredConfirmedMeetings:ie,isLoading:d,isLoadingBlockedSlots:u,isSubmitting:j,error:f,filters:v,handleFilterChange:ge,handleClearFilters:xe,selectedHost:k,handleSelectHost:pe,calendarWeekStart:ae,handleNavigateWeek:fe,handleConfirmMeeting:ce,handleUpdateMeetingDates:oe,handleDeleteMeeting:de,handleBlockSlot:me,handleUnblockSlot:ue,handleBlockFullDay:_e,handleUnblockFullDay:he,modals:te,handleOpenConfirmModal:ve,handleCloseConfirmModal:$,handleOpenEditModal:je,handleCloseEditModal:E,handleOpenDeleteModal:Ne,handleCloseDeleteModal:q,handleOpenRescheduleModal:ye,handleCloseRescheduleModal:be,handleRetry:ke,handleDismissError:Ce}}function pa({filters:a,onFilterChange:s,onClearFilters:t,hostOptions:n=[]}){const[l,i]=o.useState(!1),c=a.guestSearch||a.hostId||a.proposalId;return e.jsxs("div",{className:"manage-vm__filters",children:[e.jsxs("div",{className:"manage-vm__filters-row",children:[e.jsxs("div",{className:"manage-vm__search-input",children:[e.jsxs("svg",{className:"manage-vm__search-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("path",{d:"M21 21l-4.35-4.35"})]}),e.jsx("input",{type:"text",placeholder:"Search by guest name or email...",value:a.guestSearch,onChange:d=>s("guestSearch",d.target.value),className:"manage-vm__search-field"}),a.guestSearch&&e.jsx("button",{className:"manage-vm__clear-field",onClick:()=>s("guestSearch",""),"aria-label":"Clear search",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),e.jsxs("button",{className:`manage-vm__filter-toggle ${l?"manage-vm__filter-toggle--active":""}`,onClick:()=>i(!l),"aria-expanded":l,children:[e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M22 3H2l8 9.46V19l4 2v-8.54L22 3z"})}),"Filters",c&&e.jsx("span",{className:"manage-vm__filter-badge",children:[a.guestSearch,a.hostId,a.proposalId].filter(Boolean).length})]}),c&&e.jsx("button",{className:"manage-vm__clear-all",onClick:t,children:"Clear all"})]}),l&&e.jsxs("div",{className:"manage-vm__filters-expanded",children:[e.jsxs("div",{className:"manage-vm__filter-group",children:[e.jsx("label",{className:"manage-vm__filter-label",children:"Host"}),e.jsxs("select",{value:a.hostId,onChange:d=>s("hostId",d.target.value),className:"manage-vm__filter-select",children:[e.jsx("option",{value:"",children:"All Hosts"}),n.map(d=>e.jsx("option",{value:d.id,children:d.name},d.id))]})]}),e.jsxs("div",{className:"manage-vm__filter-group",children:[e.jsx("label",{className:"manage-vm__filter-label",children:"Proposal ID"}),e.jsx("input",{type:"text",placeholder:"Enter proposal ID...",value:a.proposalId,onChange:d=>s("proposalId",d.target.value),className:"manage-vm__filter-input"})]})]})]})}function fa({meeting:a,type:s="request",onConfirm:t,onEdit:n,onDelete:l,isLoading:i}){const c=o.useMemo(()=>F(a),[a]),d=o.useMemo(()=>aa(a),[a]),x=o.useMemo(()=>ea(a),[a]);return c?e.jsxs("article",{className:`meeting-card meeting-card--${s} meeting-card--urgency-${d}`,children:[e.jsxs("header",{className:"meeting-card__header",children:[e.jsxs("div",{className:"meeting-card__status",children:[e.jsx("span",{className:`meeting-card__status-badge meeting-card__status-badge--${x.color}`,children:x.label}),d!=="normal"&&e.jsx("span",{className:`meeting-card__urgency-badge meeting-card__urgency-badge--${d}`,children:d==="urgent"?"Urgent":"Waiting"})]}),e.jsx("time",{className:"meeting-card__time",dateTime:a.created_at,children:c.formattedCreatedAt})]}),e.jsxs("div",{className:"meeting-card__participant",children:[e.jsx("div",{className:"meeting-card__avatar meeting-card__avatar--guest",children:c.guestName.charAt(0).toUpperCase()}),e.jsxs("div",{className:"meeting-card__participant-info",children:[e.jsx("span",{className:"meeting-card__participant-label",children:"Guest"}),e.jsx("span",{className:"meeting-card__participant-name",children:c.guestName}),e.jsx("span",{className:"meeting-card__participant-email",children:c.guestEmail})]})]}),e.jsxs("div",{className:"meeting-card__participant",children:[e.jsx("div",{className:"meeting-card__avatar meeting-card__avatar--host",children:c.hostName.charAt(0).toUpperCase()}),e.jsxs("div",{className:"meeting-card__participant-info",children:[e.jsx("span",{className:"meeting-card__participant-label",children:"Host"}),e.jsx("span",{className:"meeting-card__participant-name",children:c.hostName}),e.jsx("span",{className:"meeting-card__participant-email",children:c.hostEmail})]})]}),e.jsxs("div",{className:"meeting-card__listing",children:[e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}),e.jsx("circle",{cx:"12",cy:"10",r:"3"})]}),e.jsx("span",{children:c.listingAddress})]}),c.proposalId&&e.jsxs("div",{className:"meeting-card__proposal",children:[e.jsx("span",{className:"meeting-card__proposal-label",children:"Proposal:"}),e.jsx("code",{className:"meeting-card__proposal-id",children:c.proposalId})]}),c.suggestedDates.length>0&&e.jsxs("div",{className:"meeting-card__dates",children:[e.jsx("h4",{className:"meeting-card__dates-title",children:"Suggested Times"}),e.jsxs("ul",{className:"meeting-card__dates-list",children:[c.suggestedDates.slice(0,3).map((u,g)=>e.jsxs("li",{className:"meeting-card__date-item",children:[e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),e.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),e.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),e.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),u.formatted]},g)),c.suggestedDates.length>3&&e.jsxs("li",{className:"meeting-card__date-more",children:["+",c.suggestedDates.length-3," more"]})]})]}),e.jsxs("footer",{className:"meeting-card__actions",children:[e.jsxs("button",{className:"meeting-card__action meeting-card__action--primary",onClick:t,disabled:i,children:[e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("polyline",{points:"20 6 9 17 4 12"})}),"Confirm"]}),e.jsxs("button",{className:"meeting-card__action meeting-card__action--secondary",onClick:n,disabled:i,children:[e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),"Edit"]}),e.jsxs("button",{className:"meeting-card__action meeting-card__action--danger",onClick:l,disabled:i,children:[e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("polyline",{points:"3 6 5 6 21 6"}),e.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]}),"Delete"]})]})]}):null}function va({meetings:a=[],onConfirm:s,onEdit:t,onDelete:n,isLoading:l}){return e.jsxs("section",{className:"manage-vm__section",children:[e.jsx("header",{className:"manage-vm__section-header",children:e.jsxs("h2",{className:"manage-vm__section-title",children:[e.jsxs("svg",{className:"manage-vm__section-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12 6 12 12 16 14"})]}),"New Requests",e.jsx("span",{className:"manage-vm__section-count",children:a.length})]})}),e.jsx("div",{className:"manage-vm__section-content",children:a.length===0?e.jsxs("div",{className:"manage-vm__empty-state",children:[e.jsxs("svg",{className:"manage-vm__empty-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[e.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),e.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),e.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),e.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),e.jsx("p",{children:"No pending meeting requests"})]}):e.jsx("div",{className:"manage-vm__cards-grid",children:a.map(i=>e.jsx(fa,{meeting:i,type:"request",onConfirm:()=>s(i),onEdit:()=>t(i),onDelete:()=>n(i),isLoading:l},i._id||i.id))})})]})}function ja({meeting:a,onEdit:s,onReschedule:t,isLoading:n}){const l=o.useMemo(()=>F(a),[a]),i=o.useMemo(()=>Xe(a),[a]);return l?e.jsxs("article",{className:`meeting-card meeting-card--confirmed ${i?"meeting-card--past":""}`,children:[e.jsxs("header",{className:"meeting-card__header",children:[e.jsxs("div",{className:"meeting-card__status",children:[e.jsx("span",{className:"meeting-card__status-badge meeting-card__status-badge--success",children:"Confirmed"}),i&&e.jsx("span",{className:"meeting-card__status-badge meeting-card__status-badge--info",children:"Completed"})]}),l.bookedDate&&e.jsx("time",{className:"meeting-card__booked-date",dateTime:l.bookedDate.raw,children:l.bookedDate.formatted})]}),e.jsxs("div",{className:"meeting-card__participants-row",children:[e.jsxs("div",{className:"meeting-card__participant meeting-card__participant--compact",children:[e.jsx("div",{className:"meeting-card__avatar meeting-card__avatar--guest meeting-card__avatar--small",children:l.guestName.charAt(0).toUpperCase()}),e.jsxs("div",{className:"meeting-card__participant-info",children:[e.jsx("span",{className:"meeting-card__participant-name",children:l.guestName}),e.jsx("span",{className:"meeting-card__participant-timezone",children:l.guestTimezone})]})]}),e.jsx("div",{className:"meeting-card__connector",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M5 12h14M12 5l7 7-7 7"})})}),e.jsxs("div",{className:"meeting-card__participant meeting-card__participant--compact",children:[e.jsx("div",{className:"meeting-card__avatar meeting-card__avatar--host meeting-card__avatar--small",children:l.hostName.charAt(0).toUpperCase()}),e.jsxs("div",{className:"meeting-card__participant-info",children:[e.jsx("span",{className:"meeting-card__participant-name",children:l.hostName}),e.jsx("span",{className:"meeting-card__participant-timezone",children:l.hostTimezone})]})]})]}),l.meetingLink&&e.jsxs("div",{className:"meeting-card__meeting-link",children:[e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M15 10l5 5-5 5"}),e.jsx("path",{d:"M4 4v7a4 4 0 0 0 4 4h12"})]}),e.jsx("a",{href:l.meetingLink,target:"_blank",rel:"noopener noreferrer",className:"meeting-card__link",children:l.meetingLink.includes("zoom")?"Zoom Meeting":l.meetingLink.includes("meet.google")?"Google Meet":"Join Meeting"}),e.jsx("button",{className:"meeting-card__copy-link",onClick:()=>navigator.clipboard.writeText(l.meetingLink),title:"Copy link",children:e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),e.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})})]}),e.jsxs("div",{className:"meeting-card__listing meeting-card__listing--compact",children:[e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}),e.jsx("circle",{cx:"12",cy:"10",r:"3"})]}),e.jsx("span",{children:l.listingAddress})]}),l.proposalId&&e.jsx("div",{className:"meeting-card__proposal meeting-card__proposal--compact",children:e.jsx("code",{children:l.proposalId})}),!i&&e.jsxs("footer",{className:"meeting-card__actions meeting-card__actions--compact",children:[e.jsxs("button",{className:"meeting-card__action meeting-card__action--secondary",onClick:t,disabled:n,children:[e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),e.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),e.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),e.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),"Reschedule"]}),e.jsxs("button",{className:"meeting-card__action meeting-card__action--secondary",onClick:s,disabled:n,children:[e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),"Edit"]})]})]}):null}function Na({meetings:a=[],onEdit:s,onReschedule:t,isLoading:n}){return e.jsxs("section",{className:"manage-vm__section",children:[e.jsx("header",{className:"manage-vm__section-header",children:e.jsxs("h2",{className:"manage-vm__section-title",children:[e.jsxs("svg",{className:"manage-vm__section-icon manage-vm__section-icon--success",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),"Confirmed Meetings",e.jsx("span",{className:"manage-vm__section-count manage-vm__section-count--success",children:a.length})]})}),e.jsx("div",{className:"manage-vm__section-content",children:a.length===0?e.jsxs("div",{className:"manage-vm__empty-state",children:[e.jsxs("svg",{className:"manage-vm__empty-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[e.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"}),e.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),e.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),e.jsx("p",{children:"No confirmed meetings yet"})]}):e.jsx("div",{className:"manage-vm__cards-grid",children:a.map(l=>e.jsx(ja,{meeting:l,onEdit:()=>s(l),onReschedule:()=>t(l),isLoading:n},l._id||l.id))})})]})}function ya({blockedSlots:a=[],selectedHost:s,hosts:t=[],onSelectHost:n,onBlockSlot:l,onUnblockSlot:i,onBlockFullDay:c,onUnblockFullDay:d,weekStart:x,onNavigateWeek:u,isLoading:g}){const j=o.useMemo(()=>_a(x,a),[x,a]),_=o.useMemo(()=>ha(j),[j]),f=o.useMemo(()=>{if(j.length===0)return"";const h=j[0].displayDate,v=j[6].displayDate;return`${h} - ${v}`},[j]),C=(h,v)=>{s&&(v.available?l(h.dateStr,v.startTime,v.endTime):v.isFullDayBlocked||i(v.id||`${h.dateStr}-${v.startTime}`))},b=h=>{s&&(h.isFullDayBlocked?d(h.dateStr):c(h.dateStr))};return e.jsxs("div",{className:"availability-calendar",children:[e.jsxs("header",{className:"availability-calendar__header",children:[e.jsx("h3",{className:"availability-calendar__title",children:"Host Availability"}),e.jsxs("div",{className:"availability-calendar__host-select",children:[e.jsx("label",{className:"availability-calendar__label",htmlFor:"host-select",children:"Select Host:"}),e.jsxs("select",{id:"host-select",value:(s==null?void 0:s.id)||"",onChange:h=>{const v=t.find(A=>A.id===h.target.value);n(v||null)},className:"availability-calendar__select",children:[e.jsx("option",{value:"",children:"Choose a host..."}),t.map(h=>e.jsx("option",{value:h.id,children:h.name},h.id))]})]})]}),s?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"availability-calendar__nav",children:[e.jsx("button",{className:"availability-calendar__nav-btn",onClick:()=>u("prev"),disabled:g,"aria-label":"Previous week",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("polyline",{points:"15 18 9 12 15 6"})})}),e.jsx("span",{className:"availability-calendar__week-display",children:f}),e.jsx("button",{className:"availability-calendar__nav-btn",onClick:()=>u("next"),disabled:g,"aria-label":"Next week",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),e.jsxs("div",{className:"availability-calendar__summary",children:[e.jsxs("div",{className:"availability-calendar__summary-item",children:[e.jsx("span",{className:"availability-calendar__summary-value availability-calendar__summary-value--available",children:_.availableSlots}),e.jsx("span",{className:"availability-calendar__summary-label",children:"Available"})]}),e.jsxs("div",{className:"availability-calendar__summary-item",children:[e.jsx("span",{className:"availability-calendar__summary-value availability-calendar__summary-value--blocked",children:_.blockedSlots}),e.jsx("span",{className:"availability-calendar__summary-label",children:"Blocked"})]}),e.jsxs("div",{className:"availability-calendar__summary-item",children:[e.jsxs("span",{className:"availability-calendar__summary-value",children:[_.percentageAvailable,"%"]}),e.jsx("span",{className:"availability-calendar__summary-label",children:"Open"})]})]}),e.jsxs("div",{className:"availability-calendar__grid",children:[j.map(h=>e.jsxs("div",{className:`availability-calendar__day-header ${h.isFullDayBlocked?"availability-calendar__day-header--blocked":""}`,onClick:()=>b(h),role:"button",tabIndex:0,title:h.isFullDayBlocked?"Click to unblock full day":"Click to block full day",children:[e.jsx("span",{className:"availability-calendar__day-name",children:h.dayName}),e.jsx("span",{className:"availability-calendar__day-date",children:h.displayDate}),h.isFullDayBlocked&&e.jsx("span",{className:"availability-calendar__blocked-badge",children:"Blocked"})]},h.dateStr)),j.map(h=>e.jsx("div",{className:"availability-calendar__day-slots",children:h.slots.map(v=>e.jsx("button",{className:`availability-calendar__slot ${v.available?"availability-calendar__slot--available":"availability-calendar__slot--blocked"}`,onClick:()=>C(h,v),disabled:g||v.isFullDayBlocked,title:v.available?`Block ${v.label}`:`Unblock ${v.label}`,children:v.label},`${h.dateStr}-${v.hour}`))},`slots-${h.dateStr}`))]}),e.jsxs("div",{className:"availability-calendar__legend",children:[e.jsxs("div",{className:"availability-calendar__legend-item",children:[e.jsx("span",{className:"availability-calendar__legend-color availability-calendar__legend-color--available"}),e.jsx("span",{children:"Available"})]}),e.jsxs("div",{className:"availability-calendar__legend-item",children:[e.jsx("span",{className:"availability-calendar__legend-color availability-calendar__legend-color--blocked"}),e.jsx("span",{children:"Blocked"})]})]})]}):e.jsxs("div",{className:"availability-calendar__placeholder",children:[e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[e.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),e.jsx("p",{children:"Select a host to view and manage their availability"})]}),g&&e.jsx("div",{className:"availability-calendar__loading",children:e.jsx("div",{className:"availability-calendar__spinner"})})]})}function ba({message:a="Loading..."}){return e.jsxs("div",{className:"manage-vm__loading-state",children:[e.jsx("div",{className:"manage-vm__loading-spinner"}),e.jsx("p",{className:"manage-vm__loading-message",children:a})]})}function ka({message:a,onRetry:s}){return e.jsxs("div",{className:"manage-vm__error-state",children:[e.jsxs("svg",{className:"manage-vm__error-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),e.jsx("h3",{className:"manage-vm__error-title",children:"Unable to load meetings"}),e.jsx("p",{className:"manage-vm__error-message",children:a}),s&&e.jsxs("button",{className:"manage-vm__error-retry",onClick:s,children:[e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("polyline",{points:"23 4 23 10 17 10"}),e.jsx("path",{d:"M20.49 15a9 9 0 1 1-2.12-9.36L23 10"})]}),"Try Again"]})]})}function Ca({totalRequests:a,pendingRequests:s,confirmedMeetings:t,completedMeetings:n}){return e.jsxs("div",{className:"manage-vm__stats",children:[e.jsxs("div",{className:"manage-vm__stat",children:[e.jsx("span",{className:"manage-vm__stat-value",children:a}),e.jsx("span",{className:"manage-vm__stat-label",children:"Total"})]}),e.jsxs("div",{className:"manage-vm__stat manage-vm__stat--warning",children:[e.jsx("span",{className:"manage-vm__stat-value",children:s}),e.jsx("span",{className:"manage-vm__stat-label",children:"Pending"})]}),e.jsxs("div",{className:"manage-vm__stat manage-vm__stat--success",children:[e.jsx("span",{className:"manage-vm__stat-value",children:t}),e.jsx("span",{className:"manage-vm__stat-label",children:"Confirmed"})]}),e.jsxs("div",{className:"manage-vm__stat manage-vm__stat--info",children:[e.jsx("span",{className:"manage-vm__stat-value",children:n}),e.jsx("span",{className:"manage-vm__stat-label",children:"Completed"})]})]})}function Ma({meeting:a,onConfirm:s,onClose:t,isSubmitting:n}){const l=o.useMemo(()=>F(a),[a]),[i,c]=o.useState(""),[d,x]=o.useState(""),[u,g]=o.useState("zoom"),j=(l==null?void 0:l.suggestedDates)||[],_=f=>{if(f.preventDefault(),!i)return;const C=d||Da(u);s(a._id||a.id,i,C)};return e.jsx("div",{className:"modal-overlay",onClick:t,children:e.jsxs("div",{className:"modal modal--confirm-meeting",onClick:f=>f.stopPropagation(),children:[e.jsxs("header",{className:"modal__header",children:[e.jsx("h2",{className:"modal__title",children:"Confirm Meeting"}),e.jsx("button",{className:"modal__close",onClick:t,"aria-label":"Close modal",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),e.jsxs("form",{className:"modal__content",onSubmit:_,children:[e.jsxs("div",{className:"modal__info-card",children:[e.jsxs("div",{className:"modal__info-row",children:[e.jsx("span",{className:"modal__info-label",children:"Guest:"}),e.jsx("span",{className:"modal__info-value",children:l==null?void 0:l.guestName})]}),e.jsxs("div",{className:"modal__info-row",children:[e.jsx("span",{className:"modal__info-label",children:"Host:"}),e.jsx("span",{className:"modal__info-value",children:l==null?void 0:l.hostName})]}),e.jsxs("div",{className:"modal__info-row",children:[e.jsx("span",{className:"modal__info-label",children:"Listing:"}),e.jsx("span",{className:"modal__info-value",children:l==null?void 0:l.listingAddress})]})]}),e.jsxs("div",{className:"modal__field",children:[e.jsx("label",{className:"modal__label",children:"Select Meeting Date *"}),e.jsx("div",{className:"modal__date-options",children:j.map((f,C)=>e.jsxs("label",{className:`modal__date-option ${i===f.raw?"modal__date-option--selected":""}`,children:[e.jsx("input",{type:"radio",name:"meetingDate",value:f.raw,checked:i===f.raw,onChange:b=>c(b.target.value),className:"modal__date-radio"}),e.jsx("span",{className:"modal__date-display",children:f.formatted})]},C))}),j.length===0&&e.jsx("p",{className:"modal__error",children:"No suggested dates available"})]}),e.jsxs("div",{className:"modal__field",children:[e.jsx("label",{className:"modal__label",children:"Meeting Link"}),e.jsxs("div",{className:"modal__link-type-row",children:[e.jsxs("select",{value:u,onChange:f=>g(f.target.value),className:"modal__select modal__select--small",children:[e.jsx("option",{value:"zoom",children:"Zoom"}),e.jsx("option",{value:"google_meet",children:"Google Meet"}),e.jsx("option",{value:"custom",children:"Custom URL"})]}),u==="custom"?e.jsx("input",{type:"url",value:d,onChange:f=>x(f.target.value),placeholder:"https://...",className:"modal__input"}):e.jsx("span",{className:"modal__auto-generate",children:"Link will be auto-generated"})]})]}),e.jsxs("footer",{className:"modal__actions",children:[e.jsx("button",{type:"button",className:"modal__btn modal__btn--secondary",onClick:t,disabled:n,children:"Cancel"}),e.jsx("button",{type:"submit",className:"modal__btn modal__btn--primary",disabled:!i||n,children:n?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"modal__spinner"}),"Confirming..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("polyline",{points:"20 6 9 17 4 12"})}),"Confirm Meeting"]})})]})]})]})})}function Da(a){const s=crypto.randomUUID().replace(/-/g,"").substring(0,11);switch(a){case"zoom":return`https://zoom.us/j/${s}`;case"google_meet":return`https://meet.google.com/${s.substring(0,3)}-${s.substring(3,7)}-${s.substring(7,10)}`;default:return""}}function wa({meeting:a,onSave:s,onClose:t,isSubmitting:n}){const l=o.useMemo(()=>F(a),[a]),[i,c]=o.useState(()=>((a==null?void 0:a.suggested_dates_and_times)||[]).map(f=>({id:crypto.randomUUID(),value:Sa(f)}))),[d,x]=o.useState(""),u=()=>{d&&(c(_=>[..._,{id:crypto.randomUUID(),value:d}]),x(""))},g=_=>{c(f=>f.filter(C=>C.id!==_))},j=_=>{if(_.preventDefault(),i.length===0)return;const f=i.map(C=>new Date(C.value).toISOString());s(a._id||a.id,f)};return e.jsx("div",{className:"modal-overlay",onClick:t,children:e.jsxs("div",{className:"modal modal--edit-dates",onClick:_=>_.stopPropagation(),children:[e.jsxs("header",{className:"modal__header",children:[e.jsx("h2",{className:"modal__title",children:"Edit Suggested Dates"}),e.jsx("button",{className:"modal__close",onClick:t,"aria-label":"Close modal",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),e.jsxs("form",{className:"modal__content",onSubmit:j,children:[e.jsxs("div",{className:"modal__info-card modal__info-card--compact",children:[e.jsx("span",{className:"modal__info-label",children:"Guest:"}),e.jsx("span",{className:"modal__info-value",children:l==null?void 0:l.guestName})]}),e.jsxs("div",{className:"modal__field",children:[e.jsx("label",{className:"modal__label",children:"Suggested Date/Times"}),e.jsxs("div",{className:"modal__dates-list",children:[i.map(_=>e.jsxs("div",{className:"modal__date-item",children:[e.jsx("input",{type:"datetime-local",value:_.value,onChange:f=>{c(C=>C.map(b=>b.id===_.id?{...b,value:f.target.value}:b))},className:"modal__input modal__input--datetime"}),e.jsx("button",{type:"button",className:"modal__date-remove",onClick:()=>g(_.id),"aria-label":"Remove date",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]},_.id)),i.length===0&&e.jsx("p",{className:"modal__empty-dates",children:"No dates added. Add at least one date."})]})]}),e.jsxs("div",{className:"modal__field",children:[e.jsx("label",{className:"modal__label",children:"Add New Date/Time"}),e.jsxs("div",{className:"modal__add-date-row",children:[e.jsx("input",{type:"datetime-local",value:d,onChange:_=>x(_.target.value),className:"modal__input modal__input--datetime",min:Ba()}),e.jsxs("button",{type:"button",className:"modal__btn modal__btn--add",onClick:u,disabled:!d,children:[e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),e.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add"]})]})]}),e.jsxs("footer",{className:"modal__actions",children:[e.jsx("button",{type:"button",className:"modal__btn modal__btn--secondary",onClick:t,disabled:n,children:"Cancel"}),e.jsx("button",{type:"submit",className:"modal__btn modal__btn--primary",disabled:i.length===0||n,children:n?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"modal__spinner"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),e.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),e.jsx("polyline",{points:"7 3 7 8 15 8"})]}),"Save Changes"]})})]})]})]})})}function Sa(a){if(!a)return"";try{return new Date(a).toISOString().slice(0,16)}catch{return""}}function Ba(){return new Date().toISOString().slice(0,16)}function Fa({meeting:a,onConfirm:s,onClose:t,isSubmitting:n}){const l=o.useMemo(()=>F(a),[a]),i=()=>{s(a._id||a.id)};return e.jsx("div",{className:"modal-overlay",onClick:t,children:e.jsxs("div",{className:"modal modal--delete-confirm",onClick:c=>c.stopPropagation(),children:[e.jsxs("header",{className:"modal__header modal__header--warning",children:[e.jsx("div",{className:"modal__warning-icon",children:e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"}),e.jsx("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),e.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]})}),e.jsx("h2",{className:"modal__title",children:"Delete Meeting Request"})]}),e.jsxs("div",{className:"modal__content",children:[e.jsx("p",{className:"modal__message",children:"Are you sure you want to delete this meeting request? This action cannot be undone."}),e.jsxs("div",{className:"modal__info-card modal__info-card--danger",children:[e.jsxs("div",{className:"modal__info-row",children:[e.jsx("span",{className:"modal__info-label",children:"Guest:"}),e.jsx("span",{className:"modal__info-value",children:l==null?void 0:l.guestName})]}),e.jsxs("div",{className:"modal__info-row",children:[e.jsx("span",{className:"modal__info-label",children:"Host:"}),e.jsx("span",{className:"modal__info-value",children:l==null?void 0:l.hostName})]}),e.jsxs("div",{className:"modal__info-row",children:[e.jsx("span",{className:"modal__info-label",children:"Listing:"}),e.jsx("span",{className:"modal__info-value",children:l==null?void 0:l.listingAddress})]}),e.jsxs("div",{className:"modal__info-row",children:[e.jsx("span",{className:"modal__info-label",children:"Requested:"}),e.jsx("span",{className:"modal__info-value",children:l==null?void 0:l.formattedCreatedAt})]})]}),e.jsxs("p",{className:"modal__warning-text",children:[e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),"The guest will not be notified about this deletion."]})]}),e.jsxs("footer",{className:"modal__actions",children:[e.jsx("button",{type:"button",className:"modal__btn modal__btn--secondary",onClick:t,disabled:n,children:"Cancel"}),e.jsx("button",{type:"button",className:"modal__btn modal__btn--danger",onClick:i,disabled:n,children:n?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"modal__spinner"}),"Deleting..."]}):e.jsxs(e.Fragment,{children:[e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("polyline",{points:"3 6 5 6 21 6"}),e.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]}),"Delete Meeting"]})})]})]})})}function Aa(){const{showToast:a}=Se(),s=xa({showToast:a});return s.isLoading&&s.newRequests.length===0&&s.confirmedMeetings.length===0?e.jsxs("div",{className:"manage-vm",children:[e.jsx(L,{}),e.jsx(ba,{message:"Loading virtual meetings..."})]}):s.error&&s.newRequests.length===0&&s.confirmedMeetings.length===0?e.jsxs("div",{className:"manage-vm",children:[e.jsx(L,{}),e.jsx(ka,{message:s.error,onRetry:s.handleRetry})]}):e.jsxs("div",{className:"manage-vm",children:[e.jsx(L,{}),e.jsxs("header",{className:"manage-vm__header",children:[e.jsxs("div",{className:"manage-vm__header-content",children:[e.jsx("h1",{className:"manage-vm__title",children:"Virtual Meeting Management"}),e.jsx("p",{className:"manage-vm__subtitle",children:"Manage meeting requests and host availability"})]}),e.jsx(Ca,{totalRequests:s.stats.totalRequests,pendingRequests:s.stats.pendingRequests,confirmedMeetings:s.stats.confirmedMeetings,completedMeetings:s.stats.completedMeetings})]}),s.error&&e.jsxs("div",{className:"manage-vm__error-banner",children:[e.jsx("span",{children:s.error}),e.jsx("button",{onClick:s.handleDismissError,children:"Dismiss"})]}),e.jsx(pa,{filters:s.filters,onFilterChange:s.handleFilterChange,onClearFilters:s.handleClearFilters,hostOptions:s.hostOptions}),e.jsxs("div",{className:"manage-vm__content",children:[e.jsxs("div",{className:"manage-vm__meetings",children:[e.jsx(va,{meetings:s.filteredNewRequests,onConfirm:s.handleOpenConfirmModal,onEdit:s.handleOpenEditModal,onDelete:s.handleOpenDeleteModal,isLoading:s.isLoading}),e.jsx(Na,{meetings:s.filteredConfirmedMeetings,onEdit:s.handleOpenEditModal,onReschedule:s.handleOpenRescheduleModal,isLoading:s.isLoading})]}),e.jsx("aside",{className:"manage-vm__sidebar",children:e.jsx(ya,{blockedSlots:s.blockedSlots,selectedHost:s.selectedHost,hosts:s.hostOptions,onSelectHost:s.handleSelectHost,onBlockSlot:s.handleBlockSlot,onUnblockSlot:s.handleUnblockSlot,onBlockFullDay:s.handleBlockFullDay,onUnblockFullDay:s.handleUnblockFullDay,weekStart:s.calendarWeekStart,onNavigateWeek:s.handleNavigateWeek,isLoading:s.isLoadingBlockedSlots})})]}),s.modals.confirm.isOpen&&e.jsx(Ma,{meeting:s.modals.confirm.meeting,onConfirm:s.handleConfirmMeeting,onClose:s.handleCloseConfirmModal,isSubmitting:s.isSubmitting}),s.modals.edit.isOpen&&e.jsx(wa,{meeting:s.modals.edit.meeting,onSave:s.handleUpdateMeetingDates,onClose:s.handleCloseEditModal,isSubmitting:s.isSubmitting}),s.modals.delete.isOpen&&e.jsx(Fa,{meeting:s.modals.delete.meeting,onConfirm:s.handleDeleteMeeting,onClose:s.handleCloseDeleteModal,isSubmitting:s.isSubmitting}),s.isLoading&&(s.newRequests.length>0||s.confirmedMeetings.length>0)&&e.jsx("div",{className:"manage-vm__loading-overlay",children:e.jsx("div",{className:"manage-vm__loading-spinner"})})]})}De(document.getElementById("root")).render(e.jsx(we.StrictMode,{children:e.jsx(Ue,{children:e.jsx(Be,{children:e.jsx(Aa,{})})})}));
