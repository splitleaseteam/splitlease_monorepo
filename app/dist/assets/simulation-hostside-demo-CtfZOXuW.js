import{r,j as t,c as z,R as $}from"./client-BJVKzfAi.js";/* empty css             */import{H as T}from"./Header-BJKWma2V.js";import{F as M}from"./Footer-Bzf1rLKh.js";import{c as W,v as Y}from"./auth-QZ4BJadW.js";import{C as K}from"./circle-check-big-42edTrxg.js";import{L as X}from"./loader-circle-BXPWbeXx.js";import{C as B}from"./check-B34HRHn5.js";import{C as Q}from"./chevron-right-DMpFmStq.js";import{B as Z}from"./book-open-C2XUWVN0.js";import{C as ee}from"./calendar-CDI4qHEX.js";import{D as te}from"./dollar-sign-Dn2-KjNW.js";import{U as se}from"./user-C2rhnql4.js";import{F as ae}from"./file-text-Bqp_Hw0X.js";import{M as ie}from"./mail-CRbL90NL.js";import"./constants-CPVJY5eo.js";import"./supabase-BoCLEw6R.js";import"./Toast-BQk6Nzgd.js";import"./proposalDataFetcher-CipdyWU2.js";import"./proposalStatuses-1Bj0NYR4.js";import"./createLucideIcon-CgZZH2OU.js";function R(){return[{id:"sim-guest-jacques",firstName:"Jacques",lastName:"Silva",fullName:"Jacques Silva",email:"jacques.silva@simulation.splitlease.local",phone:"555-001-0001",avatar:null,occupation:"Marketing Manager",isSimulated:!0,createdAt:new Date().toISOString()},{id:"sim-guest-mariska",firstName:"Mariska",lastName:"Van Der Berg",fullName:"Mariska Van Der Berg",email:"mariska.vdb@simulation.splitlease.local",phone:"555-002-0002",avatar:null,occupation:"UX Designer",isSimulated:!0,createdAt:new Date().toISOString()},{id:"sim-guest-lukas",firstName:"Lukas",lastName:"MÃ¼ller",fullName:"Lukas MÃ¼ller",email:"lukas.muller@simulation.splitlease.local",phone:"555-003-0003",avatar:null,occupation:"Software Developer",isSimulated:!0,createdAt:new Date().toISOString()}]}function P(e,a){const s=new Date(e);return s.setDate(s.getDate()+a),s}function _(e){return e.toISOString().split("T")[0]}function oe(){return{id:"sim-listing-default",_id:"sim-listing-default",name:"Simulated Brooklyn Apartment",neighborhood:"Williamsburg",address:"123 Bedford Ave, Brooklyn, NY 11249",monthlyRate:2800,nightlyRate:140,bedrooms:2,bathrooms:1,coverPhoto:null,isSimulated:!0}}function ne({listing:e,hostId:a}){const s=R(),c=new Date,i=oe();return s.map((o,g)=>{const d=[{nightsPerWeek:4,checkInDay:0,checkOutDay:4,selectedDays:[0,1,2,3],nightlyPrice:135,moveInOffset:14,moveOutOffset:120},{nightsPerWeek:3,checkInDay:1,checkOutDay:4,selectedDays:[1,2,3],nightlyPrice:145,moveInOffset:21,moveOutOffset:150},{nightsPerWeek:3,checkInDay:4,checkOutDay:0,selectedDays:[4,5,6],nightlyPrice:155,moveInOffset:7,moveOutOffset:90}][g],u=P(c,d.moveInOffset),j=P(c,d.moveOutOffset);return{id:`sim-proposal-${g+1}`,_id:`sim-proposal-${g+1}`,proposalNumber:g+1,guest:o,guestId:o.id,guestName:o.fullName,guestEmail:o.email,hostId:a,listing:i,listingId:i.id||i._id,listingName:i.name||i.Name,moveInDate:_(u),moveOutDate:_(j),moveInStart:_(u),moveInEnd:_(P(u,7)),nightsPerWeek:d.nightsPerWeek,checkInDay:d.checkInDay,checkOutDay:d.checkOutDay,selectedDays:d.selectedDays,nightlyPrice:d.nightlyPrice,monthlyEstimate:Math.round(d.nightlyPrice*d.nightsPerWeek*4.33),status:"pending",vmStatus:null,vmInviteSentAt:null,vmAcceptedAt:null,leaseStatus:null,leaseDraftedAt:null,hasIncomingVmInvite:!1,vmInviteReceivedAt:null,createdAt:new Date().toISOString(),isSimulated:!0}})}function A(e,a,s){return e.map(c=>c.guest.firstName.toLowerCase()===a.toLowerCase()?{...c,...s}:c)}const E={A:{id:"A",number:1,label:"Mark yourself as a Usability Tester",shortLabel:"Usability Tester",description:"Mark your account as a usability tester to enable simulation features",betweenText:null,order:1},B:{id:"B",number:2,label:"Receive 3 Proposals",shortLabel:"3 Proposals",description:"Receive simulated proposals from three test guests: Jacques, Mariska, and Lukas",betweenText:"Return to the Google Doc Instructions and follow it until you are instructed to return to the simulation page",order:2},C:{id:"C",number:3,label:"Mariska Accepts VM Invite",shortLabel:"VM Accepted",description:"Simulate Mariska accepting your virtual meeting invitation",betweenText:"Return to the Google Doc Instructions and follow it until you are instructed to return to the simulation page",order:3},D:{id:"D",number:4,label:"Draft Lease Docs for Proposal #2",shortLabel:"Draft Lease",description:"Generate lease documents for the second proposal (Mariska)",betweenText:"Return to the Google Doc Instructions and follow it until you are instructed to return to the simulation page",order:4},E:{id:"E",number:5,label:"VM invite from Guest Jacques",shortLabel:"Jacques VM",description:"Receive a virtual meeting invite from Jacques (guest-initiated)",betweenText:"Return to the Google Doc Instructions and follow it until you are instructed to return to the simulation page",order:5}},x=["A","B","C","D","E"],le=5,w="splitlease_hostside_simulation_progress";function re(e){if(e<=0)return[];const a=[];for(let s=0;s<e&&s<x.length;s++)a.push(x[s]);return a}function ce(e,a){const s=x.indexOf(e);return s===-1?!1:s===a}function de(e,a){const s=x.indexOf(e);return s===-1?!1:s<a}function ue(e){var a;return((a=E[e])==null?void 0:a.betweenText)||null}function me(e){try{const a=localStorage.getItem(w);if(!a)return null;const s=JSON.parse(a);return s.userId!==e?null:s}catch(a){return console.warn("[SimulationHostsideDemo] Failed to load saved progress:",a),null}}function pe(e){try{localStorage.setItem(w,JSON.stringify({...e,savedAt:new Date().toISOString()}))}catch(a){console.warn("[SimulationHostsideDemo] Failed to save progress:",a)}}function he(){try{localStorage.removeItem(w)}catch(e){console.warn("[SimulationHostsideDemo] Failed to clear progress:",e)}}function ge(){const[e,a]=r.useState({isChecking:!0,isAuthenticated:!1}),[s,c]=r.useState(null),[i,o]=r.useState({currentStep:0,stepClicked:{A:!1,B:!1,C:!1,D:!1,E:!1},simulatedGuests:[],simulatedProposals:[],isLoading:!1,loadingStep:null,error:null,toast:null}),g=e.isAuthenticated,p=i.currentStep,d=i.stepClicked,u=i.simulatedProposals,j=i.isLoading,V=i.loadingStep,G=r.useMemo(()=>re(p),[p]),q=r.useMemo(()=>new Date().toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),[]);r.useEffect(()=>{async function n(){try{if(!await W()){a({isChecking:!1,isAuthenticated:!1});return}const S=await Y({clearOnFailure:!1});if(S){c(S),a({isChecking:!1,isAuthenticated:!0});const h=S.userId||S._id,C=me(h);C&&(console.log("[SimulationHostsideDemo] Restoring saved progress:",C),o(L=>({...L,currentStep:C.currentStep||0,stepClicked:C.stepClicked||L.stepClicked,simulatedGuests:C.simulatedGuests||[],simulatedProposals:C.simulatedProposals||[]})))}else a({isChecking:!1,isAuthenticated:!1})}catch(l){console.error("[SimulationHostsideDemo] Auth check failed:",l),a({isChecking:!1,isAuthenticated:!1})}}n()},[]);const m=r.useCallback(n=>{o(l=>({...l,toast:n})),setTimeout(()=>{o(l=>({...l,toast:null}))},5e3)},[]),U=r.useCallback(()=>{o(n=>({...n,toast:null}))},[]),f=r.useCallback(n=>{if(!s)return;const l=s.userId||s._id;o(S=>{const h={...S,...n};return pe({userId:l,currentStep:h.currentStep,stepClicked:h.stepClicked,simulatedGuests:h.simulatedGuests,simulatedProposals:h.simulatedProposals}),h})},[s]),b=r.useCallback(async()=>{if(!s){m({title:"Not Authenticated",message:"Please log in first",type:"error"});return}o(n=>({...n,isLoading:!0,loadingStep:"A"})),await new Promise(n=>setTimeout(n,500)),f({currentStep:1,stepClicked:{...i.stepClicked,A:!0},isLoading:!1,loadingStep:null}),m({title:"Step A Complete",message:"You are now marked as a usability tester",type:"success"})},[s,i.stepClicked,m,f]),D=r.useCallback(async()=>{if(!s)return;const n=s.userId||s._id;o(h=>({...h,isLoading:!0,loadingStep:"B"})),await new Promise(h=>setTimeout(h,800));const l=R(),S=ne({listing:null,hostId:n});f({currentStep:2,stepClicked:{...i.stepClicked,B:!0},simulatedGuests:l,simulatedProposals:S,isLoading:!1,loadingStep:null}),m({title:"Step B Complete",message:"You have received 3 proposals from simulated guests",type:"success"})},[s,i.stepClicked,m,f]),N=r.useCallback(async()=>{if(!s)return;o(l=>({...l,isLoading:!0,loadingStep:"C"})),await new Promise(l=>setTimeout(l,600));const n=A(i.simulatedProposals,"Mariska",{vmStatus:"accepted",vmAcceptedAt:new Date().toISOString(),status:"vm_scheduled"});f({currentStep:3,stepClicked:{...i.stepClicked,C:!0},simulatedProposals:n,isLoading:!1,loadingStep:null}),m({title:"Step C Complete",message:"Mariska has accepted your virtual meeting invitation",type:"success"})},[s,i.stepClicked,i.simulatedProposals,m,f]),y=r.useCallback(async()=>{if(!s)return;o(l=>({...l,isLoading:!0,loadingStep:"D"})),await new Promise(l=>setTimeout(l,700));const n=A(i.simulatedProposals,"Mariska",{leaseStatus:"draft",leaseDraftedAt:new Date().toISOString(),status:"lease_docs_sent"});f({currentStep:4,stepClicked:{...i.stepClicked,D:!0},simulatedProposals:n,isLoading:!1,loadingStep:null}),m({title:"Step D Complete",message:"Lease documents have been drafted for Proposal #2 (Mariska)",type:"success"})},[s,i.stepClicked,i.simulatedProposals,m,f]),I=r.useCallback(async()=>{if(!s)return;o(l=>({...l,isLoading:!0,loadingStep:"E"})),await new Promise(l=>setTimeout(l,600));const n=A(i.simulatedProposals,"Jacques",{hasIncomingVmInvite:!0,vmInviteReceivedAt:new Date().toISOString(),status:"vm_invite_received"});f({currentStep:5,stepClicked:{...i.stepClicked,E:!0},simulatedProposals:n,isLoading:!1,loadingStep:null}),m({title:"Simulation Complete!",message:"Congratulations! You have completed the host-side simulation.",type:"success"})},[s,i.stepClicked,i.simulatedProposals,m,f]),F=r.useCallback(()=>{he(),o({currentStep:0,stepClicked:{A:!1,B:!1,C:!1,D:!1,E:!1},simulatedGuests:[],simulatedProposals:[],isLoading:!1,loadingStep:null,error:null,toast:null}),m({title:"Simulation Reset",message:"You can start the simulation again from the beginning",type:"info"})},[m]),H=r.useCallback(()=>{sessionStorage.setItem("returnTo",window.location.href),window.location.href=`/login?redirect=${encodeURIComponent(window.location.pathname)}`},[]),J=r.useCallback(n=>{switch(n){case"A":return b;case"B":return D;case"C":return N;case"D":return y;case"E":return I;default:return()=>{}}},[b,D,N,y,I]);return{authState:e,isAuthenticated:g,currentUser:s,currentDateTime:q,currentStep:p,totalSteps:le,completedSteps:G,stepClicked:d,simulatedProposals:u,isLoading:j,loadingStep:V,toast:i.toast,handleStepAClick:b,handleStepBClick:D,handleStepCClick:N,handleStepDClick:y,handleStepEClick:I,handleResetSimulation:F,handleLogin:H,getStepHandler:J,showToast:m,dismissToast:U,canClickStep:n=>ce(n,p),isStepCompleted:n=>de(n,p),getBetweenStepText:ue,SIMULATION_STEPS:E,STEP_ORDER:x}}function k({stepId:e,stepNumber:a,label:s,isActive:c=!1,isCompleted:i=!1,isLoading:o=!1,onClick:g,disabled:p=!1}){const d=p||o||i;let u="";return i?u="host-step-button--completed":o?u="host-step-button--loading":c?u="host-step-button--active":p&&(u="host-step-button--disabled"),t.jsxs("div",{className:`host-step-button-container ${u}`,children:[t.jsx("span",{className:"host-step-button__number",children:i?t.jsx(K,{size:20,className:"host-step-button__check-icon"}):a}),t.jsx("button",{className:"host-step-button",onClick:g,disabled:d,"aria-busy":o,"aria-label":`Step ${e}: ${s}`,children:t.jsxs("span",{className:"host-step-button__content",children:[o&&t.jsx(X,{className:"host-step-button__spinner",size:18}),t.jsxs("span",{className:"host-step-button__label",children:["Step ",e," â€” ",s]})]})})]})}function fe({currentStep:e,totalSteps:a=5}){const s=["A","B","C","D","E"],c=["Tester","Proposals","VM Accept","Lease","Jacques VM"];return t.jsxs("div",{className:"host-step-indicator",children:[t.jsx("div",{className:"host-step-indicator__track",children:s.map((i,o)=>{const g=o+1,p=e>=g,d=e===o;let u="host-step-indicator__step--pending";return p?u="host-step-indicator__step--completed":d&&(u="host-step-indicator__step--current"),t.jsxs("div",{className:"host-step-indicator__step-wrapper",children:[t.jsxs("div",{className:`host-step-indicator__step ${u}`,children:[t.jsx("div",{className:"host-step-indicator__icon",children:p?t.jsx(B,{size:14}):t.jsx("span",{className:"host-step-indicator__number",children:i})}),t.jsx("span",{className:"host-step-indicator__label",children:c[o]})]}),o<s.length-1&&t.jsx("div",{className:`host-step-indicator__connector ${p?"host-step-indicator__connector--complete":""}`,children:t.jsx(Q,{size:16})})]},i)})}),t.jsx("div",{className:"host-step-indicator__progress-text",children:e===0?t.jsx("span",{children:"Not started"}):e>=a?t.jsx("span",{className:"host-step-indicator__complete-text",children:"All steps completed!"}):t.jsxs("span",{children:["Step ",e," of ",a," completed"]})})]})}function v({text:e,visible:a}){return!a||!e?null:t.jsxs("div",{className:"host-step-instructions",children:[t.jsx(Z,{className:"host-step-instructions__icon",size:16}),t.jsx("p",{className:"host-step-instructions__text",children:e})]})}function O(e){return e?new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"N/A"}function Se({proposal:e,index:a}){const s=a+1,c=e.vmStatus==="accepted",i=e.leaseStatus==="draft",o=e.hasIncomingVmInvite;return t.jsxs("div",{className:"simulated-proposal-card",children:[t.jsxs("div",{className:"simulated-proposal-card__header",children:[t.jsxs("span",{className:"simulated-proposal-card__number",children:["#",s]}),t.jsx("h3",{className:"simulated-proposal-card__guest-name",children:e.guest.fullName})]}),t.jsxs("div",{className:"simulated-proposal-card__details",children:[t.jsxs("div",{className:"simulated-proposal-card__detail",children:[t.jsx(ee,{size:14}),t.jsxs("span",{children:[O(e.moveInDate)," â†’ ",O(e.moveOutDate)]})]}),t.jsxs("div",{className:"simulated-proposal-card__detail",children:[t.jsx(te,{size:14}),t.jsxs("span",{children:["$",e.nightlyPrice,"/night Â· ",e.nightsPerWeek," nights/week"]})]}),t.jsxs("div",{className:"simulated-proposal-card__detail",children:[t.jsx(se,{size:14}),t.jsx("span",{children:e.guest.occupation})]})]}),t.jsxs("div",{className:"simulated-proposal-card__status-badges",children:[c&&t.jsxs("span",{className:"simulated-proposal-card__badge simulated-proposal-card__badge--success",children:[t.jsx(B,{size:12}),"VM Accepted"]}),i&&t.jsxs("span",{className:"simulated-proposal-card__badge simulated-proposal-card__badge--info",children:[t.jsx(ae,{size:12}),"Lease Drafted"]}),o&&t.jsxs("span",{className:"simulated-proposal-card__badge simulated-proposal-card__badge--warning",children:[t.jsx(ie,{size:12}),"VM Invite Received"]}),!c&&!i&&!o&&t.jsx("span",{className:"simulated-proposal-card__badge simulated-proposal-card__badge--neutral",children:"Pending"})]})]})}function Ce({message:e="Loading..."}){return t.jsxs("div",{className:"host-simulation-loading",children:[t.jsx("div",{className:"host-simulation-loading__spinner"}),t.jsx("p",{className:"host-simulation-loading__message",children:e})]})}function ke({onLogin:e}){return t.jsxs("div",{className:"host-simulation-login-prompt",children:[t.jsx("h2",{children:"Authentication Required"}),t.jsx("p",{children:"Please log in to start the host usability simulation."}),t.jsx("button",{className:"host-simulation-login-button",onClick:e,children:"Log In to Continue"})]})}function xe({toast:e,onDismiss:a}){if(!e)return null;const s=`host-simulation-toast--${e.type||"info"}`;return t.jsxs("div",{className:`host-simulation-toast ${s}`,onClick:a,children:[t.jsx("strong",{className:"host-simulation-toast__title",children:e.title}),e.message&&t.jsx("p",{className:"host-simulation-toast__message",children:e.message})]})}function _e({onReset:e}){return t.jsxs("div",{className:"host-simulation-complete",children:[t.jsx("div",{className:"host-simulation-complete__icon",children:"ðŸŽ‰"}),t.jsx("h2",{className:"host-simulation-complete__title",children:"Simulation Complete!"}),t.jsx("p",{className:"host-simulation-complete__message",children:"Congratulations! You have successfully completed all steps of the host-side simulation."}),t.jsxs("div",{className:"host-simulation-complete__summary",children:[t.jsx("h3",{children:"What you simulated:"}),t.jsxs("ul",{children:[t.jsx("li",{children:"âœ“ Marked yourself as a usability tester"}),t.jsx("li",{children:"âœ“ Received 3 proposals from simulated guests"}),t.jsx("li",{children:"âœ“ Mariska accepted your VM invitation"}),t.jsx("li",{children:"âœ“ Drafted lease documents for Mariska's proposal"}),t.jsx("li",{children:"âœ“ Received a VM invite from Jacques"})]})]}),t.jsx("button",{className:"host-simulation-complete__reset-button",onClick:e,children:"Reset & Start Over"}),t.jsx("p",{className:"host-simulation-complete__note",children:"This simulation used mock data and did not affect your real account."})]})}function ve({currentUser:e,currentDateTime:a}){return t.jsxs("header",{className:"host-simulation-header",children:[t.jsx("h1",{className:"host-simulation-header__title",children:"Host Simulation Demo"}),t.jsx("p",{className:"host-simulation-header__subtitle",children:"Test the host workflow without affecting real data"}),t.jsxs("div",{className:"host-simulation-header__info",children:[e&&t.jsxs("span",{className:"host-simulation-header__user",children:["Logged in as: ",t.jsx("strong",{children:e.email||e.firstName})]}),t.jsx("span",{className:"host-simulation-header__datetime",children:a})]})]})}function je(){const e=ge();return e.authState.isChecking?t.jsxs(t.Fragment,{children:[t.jsx(T,{}),t.jsx("main",{className:"main-content",children:t.jsx("div",{className:"host-simulation-page",children:t.jsx(Ce,{message:"Checking authentication..."})})}),t.jsx(M,{})]}):t.jsxs(t.Fragment,{children:[t.jsx(T,{}),t.jsx("main",{className:"main-content",children:t.jsxs("div",{className:"host-simulation-page",children:[t.jsxs("div",{className:"host-simulation-warning",children:[t.jsx("span",{className:"host-simulation-warning__icon",children:"âš ï¸"}),t.jsx("span",{children:"This is a simulation using mock data. Your progress is saved in your browser."})]}),t.jsx(ve,{currentUser:e.currentUser,currentDateTime:e.currentDateTime}),e.isAuthenticated?t.jsxs(t.Fragment,{children:[t.jsx(fe,{currentStep:e.currentStep,totalSteps:e.totalSteps}),e.currentStep>=e.totalSteps?t.jsx(_e,{onReset:e.handleResetSimulation}):t.jsxs("div",{className:"host-simulation-steps",children:[t.jsx(k,{stepId:"A",stepNumber:1,label:"Mark yourself as a Usability Tester",isActive:e.canClickStep("A"),isCompleted:e.isStepCompleted("A"),isLoading:e.loadingStep==="A",onClick:e.handleStepAClick,disabled:!e.canClickStep("A")}),t.jsx(v,{text:e.getBetweenStepText("A"),visible:e.stepClicked.A&&!e.isStepCompleted("B")}),t.jsx(k,{stepId:"B",stepNumber:2,label:"Receive 3 Proposals",isActive:e.canClickStep("B"),isCompleted:e.isStepCompleted("B"),isLoading:e.loadingStep==="B",onClick:e.handleStepBClick,disabled:!e.canClickStep("B")}),t.jsx(v,{text:e.getBetweenStepText("B"),visible:e.stepClicked.B&&!e.isStepCompleted("C")}),e.currentStep>=2&&e.simulatedProposals.length>0&&t.jsxs("section",{className:"host-simulation-proposals",children:[t.jsx("h2",{className:"host-simulation-proposals__title",children:"Simulated Proposals"}),t.jsx("div",{className:"host-simulation-proposals__grid",children:e.simulatedProposals.map((a,s)=>t.jsx(Se,{proposal:a,index:s},a.id))})]}),t.jsx(k,{stepId:"C",stepNumber:3,label:"Mariska Accepts VM Invite",isActive:e.canClickStep("C"),isCompleted:e.isStepCompleted("C"),isLoading:e.loadingStep==="C",onClick:e.handleStepCClick,disabled:!e.canClickStep("C")}),t.jsx(v,{text:e.getBetweenStepText("C"),visible:e.stepClicked.C&&!e.isStepCompleted("D")}),t.jsx(k,{stepId:"D",stepNumber:4,label:"Draft Lease Docs for Proposal #2",isActive:e.canClickStep("D"),isCompleted:e.isStepCompleted("D"),isLoading:e.loadingStep==="D",onClick:e.handleStepDClick,disabled:!e.canClickStep("D")}),t.jsx(v,{text:e.getBetweenStepText("D"),visible:e.stepClicked.D&&!e.isStepCompleted("E")}),t.jsx(k,{stepId:"E",stepNumber:5,label:"VM invite from Guest Jacques",isActive:e.canClickStep("E"),isCompleted:e.isStepCompleted("E"),isLoading:e.loadingStep==="E",onClick:e.handleStepEClick,disabled:!e.canClickStep("E")})]})]}):t.jsx(ke,{onLogin:e.handleLogin}),t.jsx(xe,{toast:e.toast,onDismiss:e.dismissToast})]})}),t.jsx(M,{})]})}const be=document.getElementById("root"),De=z(be);De.render(t.jsx($.StrictMode,{children:t.jsx(je,{})}));
