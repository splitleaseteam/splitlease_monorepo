import{s as o}from"./supabase-BoCLEw6R.js";async function t(e,r={}){console.log(`[emergencyService] Calling action: ${e}`);const{data:n,error:s}=await o.functions.invoke("emergency",{body:{action:e,payload:r}});if(s)throw console.error(`[emergencyService] Error in ${e}:`,s),new Error(s.message||`Failed to execute ${e}`);if(!n.success)throw new Error(n.error||`Failed to execute ${e}`);return n.data}async function y({status:e,assignedTo:r,includeHidden:n,limit:s,offset:a}={}){return t("getAll",{status:e,assignedTo:r,includeHidden:n,limit:s,offset:a})}async function g(e){return t("getById",{id:e})}async function m(e){return t("create",e)}async function f(e,r,n){return t("assignEmergency",{emergencyId:e,assignedToUserId:r,guidanceInstructions:n})}async function d(e,r){return t("updateStatus",{emergencyId:e,status:r})}async function p(e,r){return t("updateVisibility",{emergencyId:e,isHidden:r})}async function E(e,r,n){return t("sendSMS",{emergencyId:e,recipientPhone:r,messageBody:n})}async function h(e,r){return t("sendEmail",{emergencyId:e,...r})}async function b(e){return t("getPresetMessages",{category:e,activeOnly:!0})}async function w(e){return t("getPresetEmails",{category:e,activeOnly:!0})}async function S(){return t("getTeamMembers",{})}async function $(e,r){const n=e.name.split(".").pop(),a=`emergency-photos/${`${r}/${Date.now()}.${n}`}`,{data:u,error:c}=await o.storage.from("emergency-photos").upload(a,e,{cacheControl:"3600",upsert:!1});if(c)throw console.error("[emergencyService] Photo upload error:",c),new Error(`Failed to upload photo: ${c.message}`);const{data:{publicUrl:i}}=o.storage.from("emergency-photos").getPublicUrl(a);return i}export{S as a,b,w as c,g as d,f as e,y as f,p as g,h,$ as i,m as j,E as s,d as u};
