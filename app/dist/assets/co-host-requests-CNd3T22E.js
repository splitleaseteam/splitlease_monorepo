import{r as t,j as s,c as Cs}from"./client-BJVKzfAi.js";import{s as Ls}from"./supabase-BoCLEw6R.js";import{u as Ss,a as Ms}from"./Toast-BQk6Nzgd.js";import{A as ws}from"./AdminHeader-tCInZd3n.js";import"./auth-QZ4BJadW.js";import"./star-OtPMgcH9.js";import"./createLucideIcon-CgZZH2OU.js";import"./file-text-Bqp_Hw0X.js";import"./triangle-alert-Bp6DQQmR.js";import"./users-d0RSvnp4.js";import"./pen-line-Duo49k9O.js";import"./calendar-CDI4qHEX.js";import"./mail-CRbL90NL.js";import"./user-check-CoCGzn5Y.js";import"./dollar-sign-Dn2-KjNW.js";import"./send-C4mziT0-.js";import"./x-CrJVeoCh.js";const ys="https://qcfifybkaddcoimjroca.supabase.co",ss=25;function As(){const{showToast:e}=Ss(),[i,r]=t.useState([]),[d,c]=t.useState(0),[m,n]=t.useState(1),[N,h]=t.useState(!0),[l,x]=t.useState(""),[u,p]=t.useState(""),[b,j]=t.useState("createdDate"),[L,R]=t.useState("desc"),[y,F]=t.useState(null),[C,B]=t.useState({}),[g,w]=t.useState(null),[G,z]=t.useState(!1),[J,A]=t.useState(!1),[Y,I]=t.useState(null),[T,O]=t.useState([]),[V,U]=t.useState(!1),[P,D]=t.useState(!1),[Z,E]=t.useState(null),[_,S]=t.useState(!1),[q,$]=t.useState(null);t.useEffect(()=>{K(),H()},[]),t.useEffect(()=>{K()},[l,u,b,L,m]);async function k(a,o={}){const{data:{session:f}}=await Ls.auth.getSession();if(!f)throw new Error("You must be logged in to perform this action");const v=await fetch(`${ys}/functions/v1/co-host-requests`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${f.access_token}`},body:JSON.stringify({action:a,payload:o})}),M=await v.json();if(!v.ok||!M.success)throw new Error(M.error||"Request failed");return M.data}const K=t.useCallback(async()=>{try{h(!0),$(null);const a=await k("list",{limit:ss,offset:(m-1)*ss,filters:{status:l||void 0,searchText:u||void 0},sortField:b,sortOrder:L});r(a.requests||[]),c(a.total||0),a.statusConfig&&B(a.statusConfig)}catch(a){console.error("[useCoHostRequestsPageLogic] Fetch error:",a),$(a.message),e(a.message||"Failed to fetch requests","error")}finally{h(!1)}},[m,l,u,b,L,e]),H=t.useCallback(async()=>{try{const a=await k("getStatistics");F(a),a.statusConfig&&B(a.statusConfig)}catch(a){console.error("[useCoHostRequestsPageLogic] Stats error:",a)}},[]),es=t.useCallback(async a=>{try{return S(!0),(await k("getById",{requestId:a})).request}catch(o){return console.error("[useCoHostRequestsPageLogic] Fetch details error:",o),e(o.message||"Failed to fetch request details","error"),null}finally{S(!1)}},[e]),Q=t.useCallback(async(a="")=>{try{U(!0);const o=await k("getAvailableCoHosts",{searchText:a});O(o.cohosts||[])}catch(o){console.error("[useCoHostRequestsPageLogic] Fetch co-hosts error:",o),e(o.message||"Failed to fetch co-hosts","error")}finally{U(!1)}},[e]),X=t.useCallback(async(a,o,f)=>{try{S(!0);const v=await k("updateStatus",{requestId:a,newStatus:o,adminNotes:f});return r(M=>M.map(W=>W.id===a?v.request:W)),(g==null?void 0:g.id)===a&&w(v.request),H(),e("Status updated successfully","success"),v.request}catch(v){return console.error("[useCoHostRequestsPageLogic] Update status error:",v),e(v.message||"Failed to update status","error"),null}finally{S(!1)}},[g,H,e]),ts=t.useCallback(async(a,o)=>{try{S(!0);const f=await k("assignCoHost",{requestId:a,cohostUserId:o});return r(v=>v.map(M=>M.id===a?f.request:M)),(g==null?void 0:g.id)===a&&w(f.request),A(!1),I(null),H(),e("Co-host assigned successfully","success"),f.request}catch(f){return console.error("[useCoHostRequestsPageLogic] Assign co-host error:",f),e(f.message||"Failed to assign co-host","error"),null}finally{S(!1)}},[g,H,e]),ns=t.useCallback(async(a,o,f)=>{try{S(!0);const v=await k("addNotes",{requestId:a,adminNotes:o,requestNotes:f});return r(M=>M.map(W=>W.id===a?v.request:W)),(g==null?void 0:g.id)===a&&w(v.request),D(!1),E(null),e("Notes saved successfully","success"),v.request}catch(v){return console.error("[useCoHostRequestsPageLogic] Add notes error:",v),e(v.message||"Failed to save notes","error"),null}finally{S(!1)}},[g,e]),os=t.useCallback(async(a,o)=>X(a,"Request closed",o),[X]),is=t.useCallback(async a=>{const o=await es(a.id);o&&(w(o),z(!0))},[es]),ls=t.useCallback(()=>{z(!1),w(null)},[]),cs=t.useCallback(a=>{I(a),A(!0),Q()},[Q]),rs=t.useCallback(()=>{A(!1),I(null),O([])},[]),ds=t.useCallback(a=>{E(a),D(!0)},[]),hs=t.useCallback(()=>{D(!1),E(null)},[]),us=t.useCallback(a=>{x(a),n(1)},[]),ms=t.useCallback(a=>{p(a),n(1)},[]),xs=t.useCallback(a=>{a===b?R(o=>o==="asc"?"desc":"asc"):(j(a),R("desc")),n(1)},[b]),js=t.useCallback(a=>{n(a)},[]),Ns=t.useCallback(()=>{x(""),p(""),j("createdDate"),R("desc"),n(1)},[]),ps=t.useMemo(()=>Math.ceil(d/ss),[d]),vs=t.useMemo(()=>Object.entries(C).map(([a,o])=>({value:a,label:o.label,color:o.color})),[C]),gs=t.useMemo(()=>y?Object.entries(y.counts||{}).map(([a,o])=>{const f=C[a]||{label:a,color:"gray"};return{status:a,label:f.label,color:f.color,count:o}}):[],[y,C]),fs=t.useCallback(a=>{const o=C[a];return(o==null?void 0:o.color)||"gray"},[C]),ks=t.useCallback(a=>{const o=C[a];return(o==null?void 0:o.label)||a},[C]),bs=t.useCallback(a=>a?new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",[]);return{requests:i,totalCount:d,currentPage:m,totalPages:ps,isLoading:N,statusFilter:l,searchText:u,sortField:b,sortOrder:L,statusOptions:vs,statistics:y,formattedStats:gs,selectedRequest:g,isDetailModalOpen:G,isAssignModalOpen:J,assigningRequestId:Y,availableCoHosts:T,isLoadingCoHosts:V,isNotesModalOpen:P,editingNotesRequest:Z,isProcessing:_,error:q,fetchRequests:K,fetchStatistics:H,fetchAvailableCoHosts:Q,updateStatus:X,assignCoHost:ts,addNotes:ns,closeRequest:os,openDetailModal:is,closeDetailModal:ls,openAssignModal:cs,closeAssignModal:rs,openNotesModal:ds,closeNotesModal:hs,handleStatusFilterChange:us,handleSearchChange:ms,handleSortChange:xs,handlePageChange:js,clearFilters:Ns,getStatusColor:fs,getStatusLabel:ks,formatDate:bs}}function Hs({stats:e,totalCount:i,onStatusClick:r,activeStatus:d}){return!e||e.length===0?null:s.jsxs("div",{className:"statistics-bar",children:[s.jsxs("div",{className:"statistics-header",children:[s.jsx("h2",{className:"statistics-title",children:"Overview"}),s.jsxs("span",{className:"statistics-total",children:[i," total requests"]})]}),s.jsxs("div",{className:"statistics-chips",children:[s.jsxs("button",{onClick:()=>r(""),className:`stat-chip ${d===""?"stat-chip-active":""}`,children:[s.jsx("span",{className:"stat-chip-label",children:"All"}),s.jsx("span",{className:"stat-chip-count",children:i})]}),e.map(c=>s.jsxs("button",{onClick:()=>r(c.status),className:`stat-chip stat-chip-${c.color} ${d===c.status?"stat-chip-active":""}`,children:[s.jsx(Rs,{color:c.color}),s.jsx("span",{className:"stat-chip-label",children:c.label}),s.jsx("span",{className:"stat-chip-count",children:c.count})]},c.status))]})]})}function Rs({color:e}){return s.jsx("span",{className:`status-dot status-dot-${e}`})}function Bs({statusFilter:e,searchText:i,sortField:r,sortOrder:d,statusOptions:c,onStatusChange:m,onSearchChange:n,onSortChange:N,onClearFilters:h}){const[l,x]=t.useState(i);t.useEffect(()=>{const p=setTimeout(()=>{l!==i&&n(l)},300);return()=>clearTimeout(p)},[l,i,n]),t.useEffect(()=>{x(i)},[i]);const u=e||i;return s.jsx("div",{className:"filter-section",children:s.jsxs("div",{className:"filter-row",children:[s.jsxs("div",{className:"search-container",children:[s.jsx(Is,{}),s.jsx("input",{type:"text",placeholder:"Search by host name, email, or listing...",value:l,onChange:p=>x(p.target.value),className:"search-input"}),l&&s.jsx("button",{onClick:()=>{x(""),n("")},className:"search-clear",title:"Clear search",children:s.jsx(Ds,{})})]}),s.jsxs("div",{className:"filter-dropdown-container",children:[s.jsx("label",{className:"filter-label",children:"Status"}),s.jsxs("select",{value:e,onChange:p=>m(p.target.value),className:"filter-dropdown",children:[s.jsx("option",{value:"",children:"All Statuses"}),c.map(p=>s.jsx("option",{value:p.value,children:p.label},p.value))]})]}),s.jsxs("div",{className:"sort-container",children:[s.jsx("label",{className:"filter-label",children:"Sort by"}),s.jsxs("div",{className:"sort-buttons",children:[s.jsxs("button",{onClick:()=>N("createdDate"),className:`sort-button ${r==="createdDate"?"sort-button-active":""}`,children:["Date",r==="createdDate"&&s.jsx(as,{ascending:d==="asc"})]}),s.jsxs("button",{onClick:()=>N("status"),className:`sort-button ${r==="status"?"sort-button-active":""}`,children:["Status",r==="status"&&s.jsx(as,{ascending:d==="asc"})]})]})]}),u&&s.jsx("button",{onClick:h,className:"clear-filters-button",children:"Clear Filters"})]})})}function Is(){return s.jsx("svg",{className:"search-icon",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}function Ds(){return s.jsx("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}function as({ascending:e}){return s.jsx("svg",{className:`sort-icon ${e?"sort-icon-asc":""}`,width:"12",height:"12",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})}function Es({request:e,onViewDetails:i,onAssignCoHost:r,onAddNotes:d,onCloseRequest:c,getStatusColor:m,getStatusLabel:n,formatDate:N,isProcessing:h}){const l=m(e.status),x=n(e.status);return s.jsxs("div",{className:"request-card",children:[s.jsxs("div",{className:"card-header",children:[s.jsx("span",{className:`status-badge status-badge-${l}`,children:x}),s.jsx("span",{className:"card-date",children:N(e.createdDate)})]}),s.jsxs("div",{className:"card-section",children:[s.jsxs("div",{className:"card-section-header",children:[s.jsx($s,{}),s.jsx("span",{className:"card-section-title",children:"Host"})]}),s.jsxs("div",{className:"card-section-content",children:[s.jsx("p",{className:"host-name",children:e.hostName}),e.hostEmail&&s.jsx("p",{className:"host-email",children:e.hostEmail})]})]}),e.listingName&&s.jsxs("div",{className:"card-section",children:[s.jsxs("div",{className:"card-section-header",children:[s.jsx(Ws,{}),s.jsx("span",{className:"card-section-title",children:"Listing"})]}),s.jsxs("div",{className:"card-section-content",children:[s.jsx("p",{className:"listing-name",children:e.listingName}),e.listingBorough&&s.jsx("p",{className:"listing-borough",children:e.listingBorough})]})]}),s.jsxs("div",{className:"card-section",children:[s.jsxs("div",{className:"card-section-header",children:[s.jsx(Fs,{}),s.jsx("span",{className:"card-section-title",children:"Request"})]}),s.jsxs("div",{className:"card-section-content",children:[s.jsx("p",{className:"request-subject",children:e.subject||"No subject"}),e.details&&s.jsx("p",{className:"request-details-preview",children:e.details.length>100?`${e.details.substring(0,100)}...`:e.details})]})]}),e.cohostName&&s.jsxs("div",{className:"card-section",children:[s.jsxs("div",{className:"card-section-header",children:[s.jsx(zs,{}),s.jsx("span",{className:"card-section-title",children:"Assigned Co-Host"})]}),s.jsx("div",{className:"card-section-content",children:s.jsx("p",{className:"cohost-name",children:e.cohostName})})]}),(e.adminNotes||e.requestNotes)&&s.jsxs("div",{className:"card-notes-indicator",children:[s.jsx(Ts,{}),s.jsx("span",{children:"Has notes"})]}),s.jsxs("div",{className:"card-actions",children:[s.jsx("button",{onClick:i,className:"card-action-button card-action-primary",children:"View Details"}),e.canAssign&&s.jsx("button",{onClick:r,className:"card-action-button card-action-secondary",disabled:h,children:"Assign Co-Host"}),s.jsx("button",{onClick:d,className:"card-action-button card-action-tertiary",children:"Notes"}),e.canClose&&s.jsx("button",{onClick:c,className:"card-action-button card-action-close",disabled:h,children:"Close"})]})]})}function $s(){return s.jsx("svg",{className:"section-icon",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}function Ws(){return s.jsx("svg",{className:"section-icon",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})}function Fs(){return s.jsx("svg",{className:"section-icon",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})}function zs(){return s.jsx("svg",{className:"section-icon",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}function Ts(){return s.jsx("svg",{className:"notes-icon",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}function Os({request:e,onClose:i,onAssignCoHost:r,onAddNotes:d,onCloseRequest:c,onUpdateStatus:m,getStatusColor:n,getStatusLabel:N,formatDate:h,isProcessing:l}){const x=n(e.status),u=N(e.status),p=b=>{b.target===b.currentTarget&&i()};return s.jsx("div",{className:"modal-overlay",onClick:p,children:s.jsxs("div",{className:"modal-content modal-large",children:[s.jsxs("div",{className:"modal-header",children:[s.jsxs("div",{className:"modal-header-left",children:[s.jsx("h2",{className:"modal-title",children:"Request Details"}),s.jsx("span",{className:`status-badge status-badge-${x}`,children:u})]}),s.jsx("button",{onClick:i,className:"modal-close-button",title:"Close",children:s.jsx(Vs,{})})]}),s.jsx("div",{className:"modal-body",children:s.jsxs("div",{className:"details-grid",children:[s.jsxs("div",{className:"details-column",children:[s.jsxs("section",{className:"details-section",children:[s.jsxs("h3",{className:"details-section-title",children:[s.jsx(Us,{}),"Host Information"]}),s.jsxs("div",{className:"details-content",children:[s.jsxs("div",{className:"detail-row",children:[s.jsx("span",{className:"detail-label",children:"Name"}),s.jsx("span",{className:"detail-value",children:e.hostName})]}),e.hostEmail&&s.jsxs("div",{className:"detail-row",children:[s.jsx("span",{className:"detail-label",children:"Email"}),s.jsx("a",{href:`mailto:${e.hostEmail}`,className:"detail-value detail-link",children:e.hostEmail})]}),e.hostPhone&&s.jsxs("div",{className:"detail-row",children:[s.jsx("span",{className:"detail-label",children:"Phone"}),s.jsx("a",{href:`tel:${e.hostPhone}`,className:"detail-value detail-link",children:e.hostPhone})]})]})]}),e.listingName&&s.jsxs("section",{className:"details-section",children:[s.jsxs("h3",{className:"details-section-title",children:[s.jsx(Ps,{}),"Listing Information"]}),s.jsxs("div",{className:"details-content",children:[s.jsxs("div",{className:"detail-row",children:[s.jsx("span",{className:"detail-label",children:"Name"}),s.jsx("span",{className:"detail-value",children:e.listingName})]}),e.listingBorough&&s.jsxs("div",{className:"detail-row",children:[s.jsx("span",{className:"detail-label",children:"Borough"}),s.jsx("span",{className:"detail-value",children:e.listingBorough})]})]})]}),s.jsxs("section",{className:"details-section",children:[s.jsxs("h3",{className:"details-section-title",children:[s.jsx(_s,{}),"Assigned Co-Host"]}),s.jsx("div",{className:"details-content",children:e.cohostName?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"detail-row",children:[s.jsx("span",{className:"detail-label",children:"Name"}),s.jsx("span",{className:"detail-value",children:e.cohostName})]}),e.cohostEmail&&s.jsxs("div",{className:"detail-row",children:[s.jsx("span",{className:"detail-label",children:"Email"}),s.jsx("a",{href:`mailto:${e.cohostEmail}`,className:"detail-value detail-link",children:e.cohostEmail})]})]}):s.jsx("p",{className:"detail-empty",children:"No co-host assigned yet"})})]})]}),s.jsxs("div",{className:"details-column",children:[s.jsxs("section",{className:"details-section",children:[s.jsxs("h3",{className:"details-section-title",children:[s.jsx(qs,{}),"Request Details"]}),s.jsxs("div",{className:"details-content",children:[s.jsxs("div",{className:"detail-row",children:[s.jsx("span",{className:"detail-label",children:"Subject"}),s.jsx("span",{className:"detail-value",children:e.subject||"No subject"})]}),e.details&&s.jsxs("div",{className:"detail-row detail-row-full",children:[s.jsx("span",{className:"detail-label",children:"Message"}),s.jsx("p",{className:"detail-value detail-message",children:e.details})]})]})]}),(e.meetingLink||e.meetingDateTime)&&s.jsxs("section",{className:"details-section",children:[s.jsxs("h3",{className:"details-section-title",children:[s.jsx(Gs,{}),"Meeting Information"]}),s.jsxs("div",{className:"details-content",children:[e.meetingDateTime&&s.jsxs("div",{className:"detail-row",children:[s.jsx("span",{className:"detail-label",children:"Scheduled"}),s.jsx("span",{className:"detail-value",children:h(e.meetingDateTime)})]}),e.meetingLink&&s.jsxs("div",{className:"detail-row",children:[s.jsx("span",{className:"detail-label",children:"Link"}),s.jsx("a",{href:e.meetingLink.startsWith("http")?e.meetingLink:`https://${e.meetingLink}`,target:"_blank",rel:"noopener noreferrer",className:"detail-value detail-link",children:e.meetingLink})]})]})]}),s.jsxs("section",{className:"details-section",children:[s.jsxs("h3",{className:"details-section-title",children:[s.jsx(Js,{}),"Notes"]}),s.jsxs("div",{className:"details-content",children:[e.adminNotes?s.jsxs("div",{className:"detail-row detail-row-full",children:[s.jsx("span",{className:"detail-label",children:"Admin Notes"}),s.jsx("p",{className:"detail-value detail-notes",children:e.adminNotes})]}):s.jsx("p",{className:"detail-empty",children:"No admin notes"}),e.requestNotes&&s.jsxs("div",{className:"detail-row detail-row-full",children:[s.jsx("span",{className:"detail-label",children:"Request Notes"}),s.jsx("p",{className:"detail-value detail-notes",children:e.requestNotes})]})]})]}),s.jsxs("section",{className:"details-section",children:[s.jsxs("h3",{className:"details-section-title",children:[s.jsx(Ys,{}),"Timeline"]}),s.jsxs("div",{className:"details-content",children:[s.jsxs("div",{className:"detail-row",children:[s.jsx("span",{className:"detail-label",children:"Created"}),s.jsx("span",{className:"detail-value",children:h(e.createdDate)})]}),s.jsxs("div",{className:"detail-row",children:[s.jsx("span",{className:"detail-label",children:"Last Updated"}),s.jsx("span",{className:"detail-value",children:h(e.modifiedDate)})]})]})]})]})]})}),s.jsxs("div",{className:"modal-footer",children:[s.jsxs("div",{className:"modal-actions-left",children:[e.canAssign&&s.jsx("button",{onClick:r,className:"modal-action-button modal-action-primary",disabled:l,children:"Assign Co-Host"}),s.jsx("button",{onClick:d,className:"modal-action-button modal-action-secondary",children:"Edit Notes"})]}),s.jsxs("div",{className:"modal-actions-right",children:[e.canClose&&s.jsx("button",{onClick:c,className:"modal-action-button modal-action-danger",disabled:l,children:"Close Request"}),s.jsx("button",{onClick:i,className:"modal-action-button modal-action-cancel",children:"Done"})]})]})]})})}function Vs(){return s.jsx("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}function Us(){return s.jsx("svg",{className:"section-title-icon",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}function Ps(){return s.jsx("svg",{className:"section-title-icon",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})}function _s(){return s.jsx("svg",{className:"section-title-icon",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}function qs(){return s.jsx("svg",{className:"section-title-icon",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})}function Gs(){return s.jsx("svg",{className:"section-title-icon",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})}function Js(){return s.jsx("svg",{className:"section-title-icon",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}function Ys(){return s.jsx("svg",{className:"section-title-icon",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}function Zs({requestId:e,cohosts:i,isLoading:r,onAssign:d,onClose:c,onSearch:m,isProcessing:n}){const[N,h]=t.useState(""),[l,x]=t.useState(null),u=j=>{j.target===j.currentTarget&&c()},p=j=>{const L=j.target.value;h(L),m(L)},b=()=>{l&&d(e,l.id)};return s.jsx("div",{className:"modal-overlay",onClick:u,children:s.jsxs("div",{className:"modal-content modal-medium",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{className:"modal-title",children:"Assign Co-Host"}),s.jsx("button",{onClick:c,className:"modal-close-button",title:"Close",children:s.jsx(Ks,{})})]}),s.jsxs("div",{className:"modal-body",children:[s.jsxs("div",{className:"assign-search-container",children:[s.jsx(Qs,{}),s.jsx("input",{type:"text",placeholder:"Search co-hosts by name or email...",value:N,onChange:p,className:"assign-search-input"})]}),s.jsx("div",{className:"cohost-list",children:r?s.jsxs("div",{className:"cohost-list-loading",children:[s.jsx("div",{className:"loading-spinner-small"}),s.jsx("span",{children:"Loading co-hosts..."})]}):i.length===0?s.jsxs("div",{className:"cohost-list-empty",children:[s.jsx("p",{children:"No co-hosts found"}),N&&s.jsx("p",{className:"cohost-list-hint",children:"Try a different search term"})]}):i.map(j=>{var L;return s.jsxs("div",{onClick:()=>x(j),className:`cohost-list-item ${(l==null?void 0:l.id)===j.id?"cohost-list-item-selected":""}`,children:[j.photo?s.jsx("img",{src:j.photo,alt:j.name,className:"cohost-avatar"}):s.jsx("div",{className:"cohost-avatar-placeholder",children:s.jsx("span",{children:((L=j.name)==null?void 0:L.charAt(0))||"?"})}),s.jsxs("div",{className:"cohost-info",children:[s.jsx("p",{className:"cohost-name",children:j.name}),s.jsx("p",{className:"cohost-email",children:j.email})]}),(l==null?void 0:l.id)===j.id&&s.jsx(Xs,{})]},j.id)})})]}),s.jsxs("div",{className:"modal-footer",children:[s.jsx("button",{onClick:c,className:"modal-action-button modal-action-cancel",children:"Cancel"}),s.jsx("button",{onClick:b,className:"modal-action-button modal-action-primary",disabled:!l||n,children:n?"Assigning...":"Assign Co-Host"})]})]})})}function Ks(){return s.jsx("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}function Qs(){return s.jsx("svg",{className:"assign-search-icon",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}function Xs(){return s.jsx("svg",{className:"cohost-check-icon",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}function se({request:e,onSave:i,onClose:r,isProcessing:d}){const[c,m]=t.useState(""),[n,N]=t.useState("");t.useEffect(()=>{m(e.adminNotes||""),N(e.requestNotes||"")},[e]);const h=u=>{u.target===u.currentTarget&&r()},l=()=>{i(e.id,c,n)},x=c!==(e.adminNotes||"")||n!==(e.requestNotes||"");return s.jsx("div",{className:"modal-overlay",onClick:h,children:s.jsxs("div",{className:"modal-content modal-medium",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{className:"modal-title",children:"Edit Notes"}),s.jsx("button",{onClick:r,className:"modal-close-button",title:"Close",children:s.jsx(ee,{})})]}),s.jsxs("div",{className:"modal-body",children:[s.jsxs("div",{className:"notes-field",children:[s.jsxs("label",{className:"notes-label",children:[s.jsx(ae,{}),"Admin Notes",s.jsx("span",{className:"notes-hint",children:"(Internal - not visible to users)"})]}),s.jsx("textarea",{value:c,onChange:u=>m(u.target.value),placeholder:"Add internal notes about this request...",className:"notes-textarea",rows:4})]}),s.jsxs("div",{className:"notes-field",children:[s.jsxs("label",{className:"notes-label",children:[s.jsx(te,{}),"Request Notes"]}),s.jsx("textarea",{value:n,onChange:u=>N(u.target.value),placeholder:"Add notes about the request...",className:"notes-textarea",rows:4})]})]}),s.jsxs("div",{className:"modal-footer",children:[s.jsx("button",{onClick:r,className:"modal-action-button modal-action-cancel",children:"Cancel"}),s.jsx("button",{onClick:l,className:"modal-action-button modal-action-primary",disabled:!x||d,children:d?"Saving...":"Save Notes"})]})]})})}function ee(){return s.jsx("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}function ae(){return s.jsx("svg",{className:"notes-label-icon",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})}function te(){return s.jsx("svg",{className:"notes-label-icon",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}function ne({currentPage:e,totalPages:i,totalCount:r,onPageChange:d}){const m=(()=>{const n=[];if(i<=5)for(let h=1;h<=i;h++)n.push(h);else{n.push(1);let h=Math.max(2,e-1),l=Math.min(i-1,e+1);e<=3&&(l=4),e>=i-2&&(h=i-3),h>2&&n.push("...");for(let x=h;x<=l;x++)n.push(x);l<i-1&&n.push("..."),n.push(i)}return n})();return s.jsxs("div",{className:"pagination",children:[s.jsxs("div",{className:"pagination-info",children:["Showing page ",e," of ",i," (",r," total)"]}),s.jsxs("div",{className:"pagination-controls",children:[s.jsx("button",{onClick:()=>d(e-1),disabled:e===1,className:"pagination-button pagination-arrow",title:"Previous page",children:s.jsx(oe,{})}),m.map((n,N)=>n==="..."?s.jsx("span",{className:"pagination-ellipsis",children:"..."},`ellipsis-${N}`):s.jsx("button",{onClick:()=>d(n),className:`pagination-button pagination-number ${n===e?"pagination-active":""}`,children:n},n)),s.jsx("button",{onClick:()=>d(e+1),disabled:e===i,className:"pagination-button pagination-arrow",title:"Next page",children:s.jsx(ie,{})})]})]})}function oe(){return s.jsx("svg",{width:"20",height:"20",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}function ie(){return s.jsx("svg",{width:"20",height:"20",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}function le(){const{requests:e,totalCount:i,currentPage:r,totalPages:d,isLoading:c,statusFilter:m,searchText:n,sortField:N,sortOrder:h,statusOptions:l,formattedStats:x,selectedRequest:u,isDetailModalOpen:p,isAssignModalOpen:b,assigningRequestId:j,availableCoHosts:L,isLoadingCoHosts:R,isNotesModalOpen:y,editingNotesRequest:F,isProcessing:C,error:B,fetchRequests:g,fetchAvailableCoHosts:w,updateStatus:G,assignCoHost:z,addNotes:J,closeRequest:A,openDetailModal:Y,closeDetailModal:I,openAssignModal:T,closeAssignModal:O,openNotesModal:V,closeNotesModal:U,handleStatusFilterChange:P,handleSearchChange:D,handleSortChange:Z,handlePageChange:E,clearFilters:_,getStatusColor:S,getStatusLabel:q,formatDate:$}=As();return s.jsxs("div",{className:"cohost-requests-page",children:[s.jsx(ws,{}),s.jsxs("header",{className:"cohost-requests-header",children:[s.jsxs("div",{className:"header-content",children:[s.jsx("h1",{className:"header-title",children:"Co-Host Requests"}),s.jsx("p",{className:"header-subtitle",children:"Manage host assistance requests and assign co-hosts"})]}),s.jsx("button",{onClick:g,className:"refresh-button",disabled:c,children:c?"Refreshing...":"Refresh"})]}),s.jsxs("main",{className:"cohost-requests-main",children:[s.jsx(Hs,{stats:x,totalCount:i,onStatusClick:P,activeStatus:m}),s.jsx(Bs,{statusFilter:m,searchText:n,sortField:N,sortOrder:h,statusOptions:l,onStatusChange:P,onSearchChange:D,onSortChange:Z,onClearFilters:_}),B&&s.jsxs("div",{className:"error-banner",children:[s.jsx("span",{children:B}),s.jsx("button",{onClick:g,className:"retry-button",children:"Retry"})]}),c?s.jsxs("div",{className:"loading-container",children:[s.jsx("div",{className:"loading-spinner"}),s.jsx("span",{children:"Loading requests..."})]}):e.length===0?s.jsxs("div",{className:"empty-container",children:[s.jsx(ce,{}),s.jsx("h3",{className:"empty-title",children:"No Requests Found"}),s.jsx("p",{className:"empty-text",children:m||n?"No requests match your current filters. Try adjusting your search criteria.":"There are no co-host requests in the system yet."}),(m||n)&&s.jsx("button",{onClick:_,className:"clear-filters-button",children:"Clear Filters"})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"requests-grid",children:e.map(k=>s.jsx(Es,{request:k,onViewDetails:()=>Y(k),onAssignCoHost:()=>T(k.id),onAddNotes:()=>V(k),onCloseRequest:()=>A(k.id),getStatusColor:S,getStatusLabel:q,formatDate:$,isProcessing:C},k.id))}),d>1&&s.jsx(ne,{currentPage:r,totalPages:d,totalCount:i,onPageChange:E})]})]}),s.jsx("footer",{className:"cohost-requests-footer",children:s.jsx("p",{className:"footer-text",children:"Split Lease Admin Dashboard - Internal Use Only"})}),p&&u&&s.jsx(Os,{request:u,onClose:I,onAssignCoHost:()=>T(u.id),onAddNotes:()=>V(u),onCloseRequest:()=>A(u.id),onUpdateStatus:G,getStatusColor:S,getStatusLabel:q,formatDate:$,isProcessing:C}),b&&s.jsx(Zs,{requestId:j,cohosts:L,isLoading:R,onAssign:z,onClose:O,onSearch:w,isProcessing:C}),y&&F&&s.jsx(se,{request:F,onSave:J,onClose:U,isProcessing:C})]})}function ce(){return s.jsx("svg",{className:"empty-icon",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}const re=document.getElementById("root"),de=Cs(re);de.render(s.jsx(Ms,{children:s.jsx(le,{})}));
