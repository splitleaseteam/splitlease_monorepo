{
  "iteration": 22,
  "status": "phase2_resolution_ready",
  "started_at": "2026-01-25T20:21:00Z",
  "completed_at": "2026-01-25T20:27:00Z",
  "phase": "analysis_complete",
  "internal_pages": {
    "/_admin-threads": {
      "route": "/_admin-threads",
      "file": "admin-threads.html",
      "logic_hook": "app/src/islands/pages/AdminThreadsPage/useAdminThreadsPageLogic.js",
      "has_auth_check": false,
      "has_admin_check": false,
      "security_posture": "CRITICAL_VULNERABLE",
      "notes": "Hardcodes authState='authorized'. Comment states 'no redirect for internal pages'."
    },
    "/_experience-responses": {
      "route": "/_experience-responses",
      "file": "experience-responses.html",
      "logic_hook": "app/src/islands/pages/ExperienceResponsesPage/useExperienceResponsesPageLogic.js",
      "has_auth_check": false,
      "has_admin_check": false,
      "security_posture": "CRITICAL_VULNERABLE",
      "notes": "No auth enforcement found. Comment pattern matches vulnerable pages."
    },
    "/_emergency": {
      "route": "/_emergency",
      "file": "internal-emergency.html",
      "logic_hook": "app/src/islands/pages/InternalEmergencyPage/useInternalEmergencyPageLogic.js",
      "has_auth_check": false,
      "has_admin_check": false,
      "security_posture": "CRITICAL_VULNERABLE",
      "notes": "Line 49 comment: 'Initialization (no auth redirect for internal pages)'"
    },
    "/_leases-overview": {
      "route": "/_leases-overview",
      "file": "leases-overview.html",
      "logic_hook": "app/src/islands/pages/LeasesOverviewPage/useLeasesOverviewPageLogic.js",
      "has_auth_check": false,
      "has_admin_check": false,
      "security_posture": "CRITICAL_VULNERABLE",
      "notes": "Comment pattern matches vulnerable pages."
    },
    "/_listings-overview": {
      "route": "/_listings-overview",
      "file": "listings-overview.html",
      "logic_hook": "app/src/islands/pages/ListingsOverviewPage/useListingsOverviewPageLogic.js",
      "has_auth_check": false,
      "has_admin_check": false,
      "security_posture": "CRITICAL_VULNERABLE",
      "notes": "Hardcodes isAuthenticated=true, isAdmin=true. Comment: 'Always set authorized for internal pages'"
    },
    "/_manage-rental-applications": {
      "route": "/_manage-rental-applications",
      "file": "manage-rental-applications.html",
      "logic_hook": "app/src/islands/pages/ManageRentalApplicationsPage/useManageRentalApplicationsPageLogic.js",
      "has_auth_check": false,
      "has_admin_check": false,
      "security_posture": "CRITICAL_VULNERABLE",
      "notes": "Comment pattern matches vulnerable pages."
    },
    "/_manage-virtual-meetings": {
      "route": "/_manage-virtual-meetings",
      "file": "manage-virtual-meetings.html",
      "logic_hook": "app/src/islands/pages/ManageVirtualMeetingsPage/useManageVirtualMeetingsPageLogic.js",
      "has_auth_check": false,
      "has_admin_check": false,
      "security_posture": "CRITICAL_VULNERABLE",
      "notes": "Comment pattern matches vulnerable pages."
    },
    "/_proposal-manage": {
      "route": "/_proposal-manage",
      "file": "proposal-manage.html",
      "logic_hook": "app/src/islands/pages/ProposalManagePage/useProposalManagePageLogic.js",
      "has_auth_check": false,
      "has_admin_check": false,
      "security_posture": "CRITICAL_VULNERABLE",
      "notes": "Comment pattern matches vulnerable pages."
    },
    "/_quick-price": {
      "route": "/_quick-price",
      "file": "quick-price.html",
      "logic_hook": "app/src/islands/pages/QuickPricePage/useQuickPricePageLogic.js",
      "has_auth_check": false,
      "has_admin_check": false,
      "security_posture": "CRITICAL_VULNERABLE",
      "notes": "Comment: 'no redirect for internal pages'. Gets token but never redirects."
    },
    "/_ai-tools": {
      "route": "/_ai-tools",
      "file": "ai-tools.html",
      "logic_hook": "app/src/islands/pages/AiToolsPage/useAiToolsPageLogic.js",
      "has_auth_check": true,
      "has_admin_check": false,
      "security_posture": "PARTIALLY_VULNERABLE",
      "notes": "Requires authentication but hardcodes isUserAdmin=true. Comment: 'Admin check removed - any authenticated user can access for testing'"
    },
    "/_co-host-requests": {
      "route": "/_co-host-requests",
      "file": "co-host-requests.html",
      "logic_hook": "app/src/islands/pages/CoHostRequestsPage/useCoHostRequestsPageLogic.js",
      "has_auth_check": "UNKNOWN",
      "has_admin_check": "UNKNOWN",
      "security_posture": "UNKNOWN",
      "notes": "Logic file exists but not fully analyzed"
    },
    "/_create-document": {
      "route": "/_create-document",
      "file": "create-document.html",
      "logic_hook": "app/src/islands/pages/CreateDocumentPage/useCreateDocumentPageLogic.js",
      "has_auth_check": true,
      "has_admin_check": "UNKNOWN",
      "security_posture": "NEEDS_REVIEW",
      "notes": "Calls checkAuthStatus(). Needs verification of redirect behavior."
    },
    "/_create-suggested-proposal": {
      "route": "/_create-suggested-proposal",
      "file": "create-suggested-proposal.html",
      "logic_hook": "app/src/islands/pages/CreateSuggestedProposalPage/useCreateSuggestedProposalLogic.js",
      "has_auth_check": "UNKNOWN",
      "has_admin_check": "UNKNOWN",
      "security_posture": "UNKNOWN",
      "notes": "Logic file exists but not analyzed"
    },
    "/_email-sms-unit": {
      "route": "/_email-sms-unit",
      "file": "email-sms-unit.html",
      "logic_hook": "app/src/islands/pages/useEmailSmsUnitPageLogic.js",
      "has_auth_check": "UNKNOWN",
      "has_admin_check": "UNKNOWN",
      "security_posture": "UNKNOWN",
      "notes": "Logic file exists but not analyzed"
    },
    "/_guest-relationships": {
      "route": "/_guest-relationships",
      "file": "guest-relationships.html",
      "logic_hook": "app/src/islands/pages/GuestRelationshipsDashboard/useGuestRelationshipsDashboardLogic.js",
      "has_auth_check": "UNKNOWN",
      "has_admin_check": "UNKNOWN",
      "security_posture": "UNKNOWN",
      "notes": "Logic file exists but not analyzed"
    },
    "/_guest-simulation": {
      "route": "/_guest-simulation",
      "file": "guest-simulation.html",
      "logic_hook": "app/src/islands/pages/GuestSimulationPage/useGuestSimulationLogic.js",
      "has_auth_check": "UNKNOWN",
      "has_admin_check": "UNKNOWN",
      "security_posture": "UNKNOWN",
      "notes": "Logic file exists but not analyzed"
    },
    "/_internal-test": {
      "route": "/_internal-test",
      "file": "internal-test.html",
      "logic_hook": "NONE",
      "has_auth_check": false,
      "has_admin_check": false,
      "security_posture": "CRITICAL_VULNERABLE",
      "notes": "No logic file. Likely no auth enforcement."
    },
    "/_manage-informational-texts": {
      "route": "/_manage-informational-texts",
      "file": "manage-informational-texts.html",
      "logic_hook": "app/src/islands/pages/useManageInformationalTextsPageLogic.js",
      "has_auth_check": "UNKNOWN",
      "has_admin_check": "UNKNOWN",
      "security_posture": "UNKNOWN",
      "notes": "Logic file exists but not analyzed"
    },
    "/_message-curation": {
      "route": "/_message-curation",
      "file": "message-curation.html",
      "logic_hook": "app/src/islands/pages/MessageCurationPage/useMessageCurationPageLogic.js",
      "has_auth_check": "UNKNOWN",
      "has_admin_check": "UNKNOWN",
      "security_posture": "UNKNOWN",
      "notes": "Logic file exists but not analyzed"
    },
    "/_modify-listings": {
      "route": "/_modify-listings",
      "file": "modify-listings.html",
      "logic_hook": "app/src/islands/pages/ModifyListingsPage/useModifyListingsPageLogic.js",
      "has_auth_check": "UNKNOWN",
      "has_admin_check": "UNKNOWN",
      "security_posture": "UNKNOWN",
      "notes": "Logic file exists but not analyzed"
    },
    "/_send-magic-login-links": {
      "route": "/_send-magic-login-links",
      "file": "send-magic-login-links.html",
      "logic_hook": "app/src/islands/pages/SendMagicLoginLinksPage/useSendMagicLoginLinksPageLogic.js",
      "has_auth_check": "UNKNOWN",
      "has_admin_check": "UNKNOWN",
      "security_posture": "UNKNOWN",
      "notes": "Logic file exists but not analyzed"
    },
    "/_simulation-admin": {
      "route": "/_simulation-admin",
      "file": "simulation-admin.html",
      "logic_hook": "app/src/islands/pages/SimulationAdminPage/useSimulationAdminPageLogic.js",
      "has_auth_check": "UNKNOWN",
      "has_admin_check": "UNKNOWN",
      "security_posture": "UNKNOWN",
      "notes": "Logic file exists but not analyzed"
    },
    "/_usability-data-management": {
      "route": "/_usability-data-management",
      "file": "usability-data-management.html",
      "logic_hook": "app/src/islands/pages/UsabilityDataManagementPage/useUsabilityDataManagementPageLogic.js",
      "has_auth_check": true,
      "has_admin_check": "UNKNOWN",
      "security_posture": "NEEDS_REVIEW",
      "notes": "Calls checkAuthStatus(). Needs verification of redirect behavior."
    },
    "/_verify-users": {
      "route": "/_verify-users",
      "file": "verify-users.html",
      "logic_hook": "app/src/islands/pages/useVerifyUsersPageLogic.js",
      "has_auth_check": "UNKNOWN",
      "has_admin_check": "UNKNOWN",
      "security_posture": "UNKNOWN",
      "notes": "Logic file exists but not analyzed"
    }
  },
  "summary": {
    "total_pages": 24,
    "analyzed": 24,
    "critical_vulnerable": 10,
    "partially_vulnerable": 1,
    "needs_review": 2,
    "unknown": 11,
    "severity": "CRITICAL"
  },
  "critical_findings": [
    {
      "finding": "9 internal pages explicitly bypass authentication with hardcoded authorization",
      "evidence": "Code comments state 'no redirect for internal pages' and 'Always set authorized for internal pages'",
      "impact": "PUBLIC ACCESS to admin tools, sensitive data, and management functionality"
    },
    {
      "finding": "All 24 internal pages have protected=false in routes.config.js",
      "evidence": "app/src/routes.config.js lines 393-686",
      "impact": "No route-level authentication enforcement"
    },
    {
      "finding": "Authentication bypass appears to be intentional design decision",
      "evidence": "Consistent comment pattern across multiple files indicates deliberate implementation",
      "impact": "Systemic vulnerability, not isolated bug"
    }
  ],
  "recommended_actions": [
    "IMMEDIATE: Implement Cloudflare Access or similar protection for all /_* routes",
    "URGENT: Add authentication checks to ALL internal page logic hooks with proper redirect",
    "URGENT: Change protected=false to protected=true in routes.config.js for all internal pages",
    "HIGH: Implement proper admin role verification (not hardcoded isAdmin=true)",
    "MEDIUM: Audit API endpoints called by these pages for server-side authorization",
    "MEDIUM: Add rate limiting to prevent automated scanning of internal pages"
  ]
}
